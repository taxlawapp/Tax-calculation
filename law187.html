    <!DOCTYPE html>
    <html lang="en">
    <head>
        <meta charset="UTF-8">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <link rel="stylesheet" type="text/css" href="login.css" >
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/all.min.css"> <!-- مكتبة الأيقونات -->
    <!-- رابط خط Cairo من Google Fonts -->
    <link href="https://fonts.googleapis.com/css2?family=Beiruti:wght@400;700&display=swap" rel="stylesheet">            
        <title>حساب الضريبة وفقا لقانون الضريبة علي الدخل رقم 187 لسنة 1993 وتعديلاته</title>
          <!-- لو الأيقونة بصيغة PNG -->
    <link rel="icon" type="image/png" href="https://www3.0zz0.com/2024/05/30/07/482205963.png">
    </head>
    <style>
         *{
        margin: 0;
        padding: 0;
        box-sizing: border-box;
        font-family: 'Beiruti' , sans-serif;
    }
  
    body{
        font-family: 'Beiruti', sans-serif;            
        display: flex;
        justify-content: center;
        align-items: center;
        min-height: 5rem;
        background: linear-gradient(to right, white, #e1f5fe);      
        user-select: none;     
    }
      
    .form{
    margin: 0px auto;          
    border-radius: 0px;
    position: relative;
    padding: 20px 20px 20px;
    background: linear-gradient(to right, white, #e1f5fe);      
    border-radius: 0px;
    text-align: center;
    box-shadow: 50%;
    animation: rotate 1.5s linear infinite;
    border-style: none;
    border: 0px solid #420c0c;
      
    }



    .form h2{
    background: linear-gradient(to right, #eaecee, #e1f5fe);/* خلفية متدرجة */
    color: #2b0876;
    font-weight: bold;
    text-transform: uppercase;
    letter-spacing: 0px;
    font-size: 25px;
    border: 2px solid #420c0c;
    border-radius: 0px; 
    margin-top: 40px; /* إضافة المسافة السفلية */      
    }
    .form .input{
        text-align: center;
        margin-top: 5px;
        font-weight: 900;

    }



    .form .input .inputbox{
        
        margin-top: 5px;
    }

    .form .input .inputbox label:not(.settings-label,.toggle-all-label){
    background: ; 
    margin-top: 0px;      
    display: block;
    color: #02076e;
    margin-bottom: 2.5px;
    font-size: 22px;
    border: 0px solid #420c0c;
    margin-top: 2px;      

    }

    .form .input .inputbox input:not(.settings-checkbox){
    text-align: center;
    font-weight: 900;
    width: 100%;
    background: #ffffff;
    outline: none;
    border-radius: 60px;
    padding: 6px 20px;
    font-size: 20px;
    color: #0e1ba0;
    height: 45px;
    border: 2px solid #420c0c;
    border-radius: 5px;            
    margin:1.5px 0; 
    margin-top: 0px;      

    }
      
.form .input .inputbox input:focus{
  outline: none;
  border-color: #007bff;
  box-shadow: 0 0 0 0.2rem rgba(0, 123, 255, 0.50);
}

    .forget{
        margin-top: 5px;
        color: #555;
    }

    .forget a{
        color: #ff0047;
    }

     
      .form-control {
    width: 100%;
    height: 45px;
    border: 2px solid #420c0c; 
    border-radius: 0px;
    padding: 0 10px;
    font-size: 18px;
    font-family: 'Beiruti', sans-serif; 
    color: #fff;
    text-align: center;
  
}
      
#textbox9 {
    background-color: #1565c0;
    color: #fff;
    font-weight: 900;
    
    text-align: center;
    width: 100%;
    outline: none;
    border-radius: 60px;
    padding: 6px 20px;
    font-size: 18px;
    height: 45px;
    border: 0px solid #420c0c;
    border-radius: 5px;            
    margin:1.5px 0; 
    margin-top: 0px;      
  
} 
      
  #textbox9:focus{
  outline: none;
  border-color: #007bff;
  box-shadow: 0 0 0 0.2rem rgba(0, 123, 255, 0.50);
}

#textbox10 {
    background-color: #1565c0;
    color: #fff;
    font-weight: 900;
    
    text-align: center;
    width: 100%;
    outline: none;
    border-radius: 60px;
    padding: 6px 20px;
    font-size: 18px;
    height: 45px;
    border: 0px solid #420c0c;
    border-radius: 5px;            
    margin:1.5px 0; 
    margin-top: 0px;      
  
} 
      
  #textbox10:focus{
  outline: none;
  border-color: #007bff;
  box-shadow: 0 0 0 0.2rem rgba(0, 123, 255, 0.50);
}      

.form-control option {
  font-size: 18px;
  font-family: sans-serif;
  color: #fff;
}

.form-control:hover {
  border: 2px solid #000;
}

  .hr{
      font-size: 20px;
      font-weight: 900;
      
    
      }

      
      input[type="date"] {
  text-align: center;
}

#textbox11 {
    background-color: #1565c0;
    color: #fff;
    font-weight: 900;
    
    text-align: center;
    width: 100%;
    outline: none;
    border-radius: 60px;
    padding: 6px 20px;
    font-size: 18px;
    height: 45px;
    border: 0px solid #420c0c;
    border-radius: 5px;            
    margin:1.5px 0;   
    margin-top: 0px;      
  
}
      
     #textbox11:focus{
  outline: none;
  border-color: #007bff;
  box-shadow: 0 0 0 0.2rem rgba(0, 123, 255, 0.50);
}

#textbox13 {
    background-color: #1565c0;
    color: #fff;
    font-weight: 900;
    
    text-align: center;
    width: 100%;
    outline: none;
    border-radius: 60px;
    padding: 6px 20px;
    font-size: 18px;
    height: 45px;
    border: 0px solid #420c0c;
    border-radius: 5px;            
    margin:1.5px 0; 
    margin-top: 0px;      
  
} 
      
  #textbox13:focus{
  outline: none;
  border-color: #007bff;
  box-shadow: 0 0 0 0.2rem rgba(0, 123, 255, 0.50);
}

#textbox14 {
    background-color: #1565c0;
    color: #fff;
    font-weight: 900;
    
    text-align: center;
    width: 100%;
    outline: none;
    border-radius: 60px;
    padding: 6px 20px;
    font-size: 18px;
    height: 45px;
    border: 0px solid #420c0c;
    border-radius: 5px;            
    margin:1.5px 0;   
    margin-top: 0px;      
  
}
      
     #textbox14:focus{
  outline: none;
  border-color: #007bff;
  box-shadow: 0 0 0 0.2rem rgba(0, 123, 255, 0.50);
}
 
      
#taxTable {
  background-color: #b3e5fc;
  color: #1a237e;
  font-weight: 400;
  margin-top: 5px;
  font-size: 16px;
  border: 2px solid #420c0c;
  box-shadow: inset -2px -2px 6px rgba(255,255,255,.05),
    }  
            

      
  #taxTable1 {
  background-color: #e1f5fe;
  color: #1a237e;
  font-weight: 400;  
  margin-top: 5px;
  font-size: 16px;
  border: 2px solid #420c0c;
  box-shadow: inset -2px -2px 6px rgba(255,255,255,.05),
    }
            
 #dete1 {
    margin-top: 0px;
  
}     
      
 #dete2 {
    margin-top: 0px;
  
}
#textbox31 {
    margin-top: 2.5px;
    font-size: 20px;
    font-weight: bold;  
    background-color: #1a237e;
    color: #FFFF00;
    border-radius: 0px;
    width: 100%;
    height: 30px;
  
} 
 
      
#hr {
    margin-top: 0px;
  
}              
      
.button {
    font-size: 17px; /* حجم الخط */
    font-weight: bold; /* وزن الخط */
    padding: 7.5px 75px; /* حجم الحشو */
    margin: 10px auto; /* تقليل هامش الزر */
    border: none; /* حذف الحدود */
    border-radius: 5px; /* تقويس الزوايا */
    background: linear-gradient(135deg, #0277bd, #1a237e); /* خلفية متدرجة */
    color: white; /* لون النص */
    cursor: pointer; /* تحويل المؤشر إلى يد عند التحويم */
    transition: background-color 0.3s, transform 0.3s; /* تأثير الانتقال */
    text-decoration: none; /* إزالة الخط تحت النص داخل الزر */
    display: block; /* عرض الزر ككتلة */
    text-align: center; /* توسيط النص داخل الزر */
}

.button:hover {
    background-color: #1a237e; /* لون خلفية الزر عند التحويم */
    color: #FFFF00; /* لون النص */  
    transform: scale(1.05); /* تحجيم الزر عند التحويم */
    border: 2px solid white; /* إضافة حد عند التحويم */
  
}

.button:active {
    transform: scale(0.95); /* تحجيم الزر عند الضغط */
}

.button a {
    text-decoration: none; /* إزالة الخط تحت النص داخل الرابط */
    color: inherit; /* الاحتفاظ بلون النص داخل الرابط */
}      

      
#button5 {
    color: white; /* لون النص */
    background: red; /* لون الخلفية */
    border: none; /* إزالة الحدود */
    border-radius: 5px; /* زوايا مستديرة */
    text-decoration: none; /* إزالة التسطير عن النص */
    display: block; /* عرض الزر ككتلة */
    font-size: 17px; /* حجم الخط */
    font-weight: bold; /* وزن الخط */
    padding: 7.5px 75px; /* حجم الحشو */
    margin: 5px auto; /* هامش الزر */
    margin-bottom: 60px;
    cursor: pointer; /* تحويل المؤشر إلى يد عند التحويم */
    transition: background-color 0.3s, transform 0.3s; /* تأثير الانتقال */
    text-align: center; /* توسيط النص داخل الزر */
}
  
#button5:hover {
    background-color: darkred; /* تغيير لون الخلفية عند التحويم */
    transform: scale(1.05); /* تحجيم الزر عند التحويم */
  
      } 
          

        /* استايل النص العائم */
        .floating-text {
            font-size: 18px;
            font-weight: bold;
            position: fixed;
            bottom: 27.5px;
            right: 60px; /* تعديل المسافة بين النص والأيقونة */
            background-color: #ffffff;
            color: red;
            padding: 10px;
            border-radius: 5px;
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.2);
            z-index: 1000;
            display: none; /* الإخفاء الافتراضي للنص */
            margin-bottom: 50px; /* مسافة سفلية */          
        }
      
      
        /* أنماط القائمة السفلية */
        .navbar {
            position: fixed;
            bottom: 3px;
            left: 50%; /* توسيط العنصر أفقيًا */
            transform: translateX(-50%); /* توسيط العنصر بدقة */
            width: 92.5%; /* عرض العنصر */
            background: linear-gradient(135deg, #0277bd, #1a237e); /* خلفية متدرجة */
            display: flex;
            justify-content: space-around; /* توزيع العناصر */
            padding: 5px 15px; /* حشو داخلي */
            box-shadow: 2px 2px 2px 2px rgba(0, 0, 0, 0.1); /* ظل خفيف */
            border-radius: 22.5px; /* زوايا مستديرة */
            border-bottom: 3px solid white; /* حدود */
            z-Index:1;
        }

        .navbar .nav-item {
            flex: 1;
            text-align: center;
            color: white; /* لون النص */
            font-size: 14px; /* حجم النص */
            cursor: pointer; /* تغيير شكل المؤشر */
            padding: 5px 0; /* حشو داخلي */
            transition: transform 0.3s ease, box-shadow 0.3s ease, background-color 0.3s ease; /* تأثيرات الانتقال */
            border-width: 1px; /* حدود */
            border-style: solid;
            border-color: transparent;
        }

        .icon {
            margin-bottom: 2px; /* مسافة سفلية للأيقونة */
            font-size: 20px; /* حجم الأيقونة */
        }

        .nav-item span {
            display: block;
            font-size: 15px; /* حجم النص */
            font-weight: bold; /* وزن النص */
            text-decoration: none; /* إزالة التسطير */
        }

        .nav-item span:active {
            font-size: 20px; /* حجم النص */
            font-weight: bold; /* وزن النص */ 
        }

        .nav-item:active .icon {
          font-size: 22px; /* حجم الأيقونة */
        }  
     
        /* أنماط شعار الإشعارات */
        .notification-badge {
            position: absolute;
            top: -5px; /* المسافة من الأعلى */
            right: 87.5px; /* المسافة من اليمين */
            background-color: red; /* لون الخلفية */
            color: white; /* لون النص */
            font-size: 15px; /* حجم النص */
            padding: 2.5px 5px; /* حشو داخلي */
            border-radius: 50%; /* زوايا مستديرة */
            display: flex;
            align-items: center;
            justify-content: center;
        }   
      
        /* أنماط الوضع الليلي للقائمة */
        body.dark-mode .navbar {
            background: #121212; /* لون خلفية القائمة في الوضع الليلي */
            border-top: 2px solid #fafafa; /* حدود علوية */
        }

        body.dark-mode .navbar .nav-item {
            color: #ddd; /* لون النص في الوضع الليلي */
            border-color: transparent; /* حدود شفافة */
        }

        body.dark-mode .navbar .nav-item.home {
            border-color: #ddd; /* حدود العنصر الرئيسي */
            border: none; /* إزالة الحدود */  
        }
      
        body.dark-mode .icon {
            color: #ddd; /* لون الأيقونات في الوضع الليلي */
        }

        /* إزالة الخط تحت أسماء القوائم */
        .navbar-nav .nav-link {
            text-decoration: none;
        }
        .navbar a {
            text-decoration: none;
        }
      
      
.inputbox {
    position: relative;
}      
.clear-btn {
    position: absolute;
    left: 12.5px;
    top: 67.5%;
    transform: translateY(-50%);
    background: none;
    border: none;
    font-size: 18px;
    cursor: pointer;
    color: #999;
}
.clear-btn:hover {
    color: #000;
}
      
        /* أنماط الشريط العلوي */
        .top-bar {
            position: fixed;
            top: 0px; /* المسافة من الأعلى */
            left: 50%; /* توسيط العنصر أفقيًا */
            transform: translateX(-50%); /* توسيط العنصر بدقة */
            width: 100%; /* عرض العنصر */
            height: 57.5px; /* ارتفاع العنصر */
            background: linear-gradient(135deg, #0277bd, #1a237e); /* خلفية متدرجة */
            display: flex;
            justify-content: space-between; /* توزيع العناصر */
            padding: 10px 15px; /* حشو داخلي */
            box-shadow: 2px 2px 2px 2px rgba(0, 0, 0, 0.1); /* ظل خفيف */
            border-radius: 0px 0px 22.5px 22.5px; /* زوايا مستديرة */
            border-bottom: 3px solid white; /* حدود */
            align-items: center; /* توسيط العناصر عموديًا */
            z-index: 1; /* ترتيب العنصر */
            color: white; /* لون النص */
        }


.top-bar .menu-icon {
    font-size: 27.5px;
    cursor: pointer;
}

.top-bar .title {
    font-size: 20px; /* حجم الخط لعناصر العنوان */
    margin-left: 20px; /* مسافة بين السهم والعنوان */
    flex-grow: 1; /* يسمح للعناصر الأخرى بالتقلص عندما تكون الشاشة صغيرة */
    text-align: center; /* توسيط العنوان */
    font-weight: bold;  

}

.top-bar .icon {
    display: none; /* إخفاء الأيقونات بعد التعديل */
}
      
      

      
        /* تنسيق النافذة المنبثقة */
        .popup {
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%) scale(0.8);
            background: white;
            padding: 25px 30px;
            border-radius: 16px;
            box-shadow: 0 12px 35px rgba(0, 0, 0, 0.18);
            display: flex;
            flex-direction: column;
            align-items: center;
            opacity: 0;
            transition: all 0.4s cubic-bezier(0.34, 1.56, 0.64, 1);
            z-index: 10002;
            max-width: 85%;
            width: fit-content;
            min-width: 260px;
            max-width: 320px;
            text-align: center;
            border-top: 5px solid;
        }

        .popup.show {
            opacity: 1;
            transform: translate(-50%, -50%) scale(1);
        }

        /* تنسيق الأيقونة */
        .popup-icon {
            font-size: 26px;
            margin-bottom: 2.5px;
            transition: all 0.3s;
        }

        /* تنسيق الرسالة */
        .popup-message {
            font-size: 20px;
            line-height: 1.0;
            font-weight: bold; 
            color: #333;
        }

        /* ألوان وأنواع الرسائل */
        .popup.info {
            border-color: #4285f4;
            background: linear-gradient(145deg, #f7faff, #e8f1fe);
        }
        .popup.warning {
            border-color: #fbbc05;
            background: linear-gradient(145deg, #fff9e6, #fff2cc);
        }
        .popup.error {
            border-color: #ea4335;
            background: linear-gradient(145deg, #ffefed, #ffe5e3);
        }
        .popup.success {
            border-color: #34a853;
            background: linear-gradient(145deg, #f0f9f2, #e6f5e9);
        }

        /* ألوان الأيقونات */
        .info .popup-icon { color: #4285f4; }
        .warning .popup-icon { color: #fbbc05; }
        .error .popup-icon { color: #ea4335; }
        .success .popup-icon { color: #34a853; }

        /* تأثيرات الحركة */
        @keyframes float {
            0%, 100% { transform: translateY(0); }
            50% { transform: translateY(-8px); }
        }
        .popup.show .popup-icon {
            animation: float 2s ease-in-out infinite;
        }

        /* طبقة التعتيم */
        .popup-overlay {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(0,0,0,0.45);
            z-index: 9999;
            opacity: 0;
            transition: opacity 0.3s;
            backdrop-filter: blur(3px);
            pointer-events: none;
        }
        .popup-overlay.show {
            opacity: 1;
            display: block;
            pointer-events: auto;
        }

        .settings-popup {
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            background: #fff;
            padding: 20px;
            border-radius: 15px;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.2);
            z-index: 10001;
            width: 90%;
            max-width: 400px;
            display: none;
            animation: fadeInUp 0.3s ease-out;
            border: 5px solid #ddd;
        }

        .settings-popup.show {
            display: block;
        }

        .settings-header {
            margin-bottom: 20px;
            text-align: center;
        }

        .settings-header h3 {
            margin: 0;
            font-size: 20px;
            color: #1a237e;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 8px;
            font-weight: bold;
        }

        .settings-content {
            max-height: 60vh;
            overflow-y: auto;
            padding-right: 5px;
        }

        .settings-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 10px;
            padding: 10px 12px;
            background-color: #f8f9fa;
            border-radius: 10px;
        }

        .settings-label {
            display: flex;
            align-items: center;
            gap: 8px;
            font-weight: bold;
            color: #333;
            font-size: 18px;
        }

        .settings-label i {
            font-size: 18px;
            width: 22px;
            text-align: center;
        }

        .settings-controls {
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .settings-checkbox {
            -webkit-appearance: none;
            appearance: none;
            width: 26px;
            height: 26px;
            border: 2px solid #ccc;
            border-radius: 5px;
            cursor: pointer;
            position: relative;
            transition: all 0.2s ease;
        }

        .settings-checkbox:checked {
            background-color: #0277bd;
            border-color: #0277bd;
        }

        .settings-checkbox:checked::after {
            content: '\f00c';
            font-family: 'Font Awesome 5 Free';
            font-weight: 900;
            color: white;
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            font-size: 10px;
        }

        .toggle-all {
            background: #f8f9fa;
            padding: 12px 15px;
            border-radius: 10px;
            margin: 15px 0;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .toggle-all-label {
            font-weight: bold;
            color: #1a237e;
            font-size: 18px;
            display: flex;
            align-items: center;
            gap: 6px;
        }

        .settings-footer {
            display: flex;
            gap: 10px;
            margin-top: 5px;
        }

        .settings-footer a {
            flex: 1;
            padding: 10px 20px;
            font-size: 18px;
            border-radius: 8px;
            max-width: none;
        }

        /* ألوان خاصة بكل نوع من الرسائل */
        .info { 
            color: #0277bd; 
            border-left-color: #0277bd;
            background: #e3f2fd;
        }
        .success { 
            color: #2e7d32; 
            border-left-color: #2e7d32;
            background: #e8f5e9;
        }
        .warning { 
            color: #ff8f00; 
            border-left-color: #ff8f00;
            background: #fff8e1;
        }
        .error { 
            color: #c62828; 
            border-left-color: #c62828;
            background: #ffebee;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translate(-50%, -55%); }
            to { opacity: 1; transform: translate(-50%, -50%); }
        }

        @keyframes fadeInUp {
            from { opacity: 0; transform: translate(-50%, -60%); }
            to { opacity: 1; transform: translate(-50%, -50%); }
        }

        /* تحسينات للشاشات الصغيرة */
        @media (max-width: 400px) {
            .settings-popup {
                padding: 15px;
            }
            
            .settings-item {
                flex-direction: column;
                align-items: flex-start;
                gap: 8px;
            }
            
            .settings-controls {
                width: 100%;
                justify-content: space-between;
            }
            
            .settings-select {
                width: 100%;
            }
        }

        #durationInfo {
            background-color: #1565c0;
            color: #fff;
            font-weight: 900;
            text-align: center;
            width: 100%;
            outline: none;
            border-radius: 60px;
            padding: 6px 20px;
            font-size: 18px;
            height: 45px;
            border: 0px solid #420c0c;
            border-radius: 5px;            
            margin:1.5px 0; 
            margin-top: 0px;      
        } 
              
        #durationInfo:focus{
            outline: none;
            border-color: #007bff;
            box-shadow: 0 0 0 0.2rem rgba(0, 123, 255, 0.50);
        }
              
        #durationSuccess {
            background-color: #1565c0;
            color: #fff;
            font-weight: 900;
            text-align: center;
            width: 100%;
            outline: none;
            border-radius: 60px;
            padding: 6px 20px;
            font-size: 18px;
            height: 45px;
            border: 0px solid #420c0c;
            border-radius: 5px;            
            margin:1.5px 0; 
            margin-top: 0px;      
        } 
              
        #durationSuccess:focus{
            outline: none;
            border-color: #007bff;
            box-shadow: 0 0 0 0.2rem rgba(0, 123, 255, 0.50);
        }
              
        #durationWarning {
            background-color: #1565c0;
            color: #fff;
            font-weight: 900;
            text-align: center;
            width: 100%;
            outline: none;
            border-radius: 60px;
            padding: 6px 20px;
            font-size: 18px;
            height: 45px;
            border: 0px solid #420c0c;
            border-radius: 5px;            
            margin:1.5px 0; 
            margin-top: 0px;      
        } 
              
        #durationWarning:focus{
            outline: none;
            border-color: #007bff;
            box-shadow: 0 0 0 0.2rem rgba(0, 123, 255, 0.50);
        }
              
        #durationError {
            background-color: #1565c0;
            color: #fff;
            font-weight: 900;
            text-align: center;
            width: 100%;
            outline: none;
            border-radius: 60px;
            padding: 6px 20px;
            font-size: 18px;
            height: 45px;
            border: 0px solid #420c0c;
            border-radius: 5px;            
            margin:1.5px 0; 
            margin-top: 0px;      
        } 
              
        #durationError:focus{
            outline: none;
            border-color: #007bff;
            box-shadow: 0 0 0 0.2rem rgba(0, 123, 255, 0.50);
        }
      
      
      
      
      
      
      
      
      
      
      
        :root {
            --transition: all 0.3s ease;
        }
        
        /* زر العائمة الرئيسي */
        .floating-container {
            position: fixed;
            bottom: 30px;
            right: 30px;
            z-index: 1000;
        }
        
        .floating-btn {
            bottom: 42.5px;
            right: -20px;
            width: 47.5px;
            height: 47.5px;
            background: linear-gradient(135deg, #0277bd, #1a237e); /* خلفية متدرجة */
            color: white;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
            transition: var(--transition);
            border: none;
            outline: none;
            position: relative;
            z-index: 1001;
        }
        
        .floating-btn i {
            font-size: 28px;
            transition: var(--transition);
        }
        
        .floating-btn:hover {
            transform: scale(1.1);
            box-shadow: 0 8px 15px rgba(67, 97, 238, 0.3);
        }
        
        .floating-btn.active {
            transform: rotate(135deg);
            background: linear-gradient(135deg, #f72585, #b5179e);
        }
        
        /* تأثير النبض */
        @keyframes pulse {
            0% { box-shadow: 0 0 0 0 rgba(67, 97, 238, 0.7); }
            70% { box-shadow: 0 0 0 15px rgba(67, 97, 238, 0); }
            100% { box-shadow: 0 0 0 0 rgba(67, 97, 238, 0); }
        }
        
        .pulse {
            animation: pulse 2s infinite;
        }
        
        /* القائمة المنبثقة */
        .floating-menu {
            position: absolute;
            bottom: 95px;
            right: -12.5px;
            width: 230px;
            background: linear-gradient(to right, white, #e1f5fe);
            border-radius: 15px;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
            opacity: 0;
            visibility: hidden;
            transform: translateY(20px);
            transition: var(--transition);
            padding: 15px;
            z-index: 1000;
            border: 3px solid #ddd; /* حدود */
        }
        
        .floating-menu.active {
            opacity: 1;
            visibility: visible;
            transform: translateY(0);
        }
      
        /* إضافة هذا لمنع التمرير عند ظهور القائمة */
       .body-no-scroll {
         overflow: hidden;
         position: fixed;
         width: 100%;
         height: 100%;
        }   
      
        .overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.5);
            display: none;
            z-index: 999;
        }      
        
        .menu-header {
            display: flex;
            justify-content: space-between;
            align-items: center;          
            margin-bottom: 15px;
            padding-bottom: 10px;
            border-bottom: 2.5px solid #eee;
        }
        
        .menu-header h3 {
            color: #2b2d42;
            font-size: 18px;
            font-weight: bold;
            text-align: center;
            margin: 0;
        }
        
        .close-btn {
            background: none;
            border: none;
            color: #999;
            font-size: 18px;
            font-weight: bold;
            cursor: pointer;
            transition: var(--transition);
            padding: 0;
            line-height: 1;
        }
        
        .close-btn:hover {
            color: #f72585;
            transform: rotate(90deg);
        }
        
        .menu-items {
            list-style: none;
            padding: 0;
            margin: 0;
        }
        
        .menu-item {
            padding: 10px 8px;
            margin: 2.5px 0;
            border-radius: 8px;
            transition: var(--transition);
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        .menu-item:hover {
            background-color: rgba(67, 97, 238, 0.1);
            transform: translateX(-5px);
        }
        
        .menu-item i {
            width: 25px;
            height: 25px;
            background: linear-gradient(135deg, #4895ef, #4361ee);
            color: white;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 12px;
            flex-shrink: 0;
        }
        
        .menu-item.gold i {
            background: linear-gradient(135deg, #ffb700, #ffd700);
        }
        
        .menu-item a {
            color: #2b2d42;
            text-decoration: none;
            font-weight: 500;
            flex-grow: 1;
            font-size: 16px;
            font-weight: bold;
        }
        
        .menu-item .badge {
            background-color: #f72585;
            color: white;
            border-radius: 10px;
            padding: 2px 8px;
            font-size: 12px;
            font-weight: bold;
            margin-right: 2.5px;
        }
        
        .gold-badge {
            background: gold;
            color: white;
            border-radius: 10px;
            padding: 2px 8px;
            font-size: 12px;
            margin-right: 1.5px;
            font-weight: bold;
        }
        
        /* تأثيرات دخول العناصر */
        @keyframes slideIn {
            from { opacity: 0; transform: translateX(20px); }
            to { opacity: 1; transform: translateX(0); }
        }
        
        .menu-item {
            animation: slideIn 0.3s forwards;
            opacity: 0;
        }
        
        .menu-item:nth-child(1) { animation-delay: 0.1s; }
        .menu-item:nth-child(2) { animation-delay: 0.2s; }
        .menu-item:nth-child(3) { animation-delay: 0.3s; }
        .menu-item:nth-child(4) { animation-delay: 0.4s; }
        .menu-item:nth-child(5) { animation-delay: 0.5s; }
        .menu-item:nth-child(6) { animation-delay: 0.6s; }
        .menu-item:nth-child(7) { animation-delay: 0.7s; }
        .menu-item:nth-child(8) { animation-delay: 0.8s; }      

      
      
    .color-palette {
        display: flex;
        flex-wrap: wrap;
        gap: 10px;
        padding: 12.5px;
        background: #f5f5f5;
        border-radius: 8px;
        margin-left: 0px;
        max-width: 385px;
      margin-top: 2.5px;
      margin-bottom: 2.5px;
      border: 2.5px solid #212121;
    }
    
    .color-option {
        width: 25px;
        height: 25px;
        border-radius: 50%;
        cursor: pointer;
        border: 2px solid transparent;
        transition: all 0.2s ease;
    }
    
    .color-option:hover {
        border-color: #333;
        transform: scale(1.1);
    }
    
    .color-option.selected {
        border-color: #333;
        transform: scale(1.2);
        box-shadow: 0 0 5px rgba(0,0,0,0.3);
    }
    
    #textbox8.highlighted, 
    #textbox6.highlighted, 
    #textbox4.highlighted {
        background-color: var(--tax-highlight-color, #FFFF99);
        transition: background-color 0.3s ease;
    } 
      
      
        .modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0,0,0,0.85); /* خلفية أكثر عتامة */
            z-index: 9999; /* أعلى قيمة لضمان ظهوره فوق كل شيء */
            justify-content: center;
            align-items: center;
            backdrop-filter: blur(5px); /* تأثير ضبابي للخلفية */
        }
        
        .modal-content {
            width: 90%;
            max-width: 900px;
            background-color: transparent; /* خلفية شفافة */
            border-radius: 10px;
            overflow: hidden;
            box-shadow: 0 0 30px rgba(0,0,0,0.7);
            position: relative;
        }
        
        .video-container {
            position: relative;
            padding-bottom: 56.25%; /* نسبة 16:9 */
            height: 0;
            overflow: hidden;
            border-radius: 8px;
        }
        
        .video-container iframe {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            border: none;
        }      
    </style>
    <body>
      
<div class="top-bar">
    <div class="menu-icon" id="menuIcon" onclick="toggleSidebar()">
        <i class="fas fa-arrow-right" onclick="window.location.href='go:Taxs'"></i> <!-- سهم العودة -->
    </div>
    <div class="title">
        حساب الضريبة ق 187 لسنة 1993 وتعديلاته
    </div>
</div>

<div class="navbar">
    <a href="go:Login" class="nav-item"><i class="fas fa-user icon"></i><span>حسابي</span></a>
    <a href="http://action_notifications" class="nav-item">
        <i class="fa fa-bell icon"></i>
        <span>إشعارات</span>
        <span class="notification-badge">1</span> <!-- الشعار الجديد -->
    </a>     
    <a href="go:home" class="nav-item home"><i class="fas fa-home icon"></i><span>الرئيسية</span></a>
            <a href="https://youtube.com/@MahmoudR_Saad" class="nav-item"><i class="fab fa-youtube icon"></i><span>قناتي</span></a>
    <a href="go:Settings" class="nav-item"><i class="fas fa-ellipsis-h icon"></i><span>المزيد</span></a>      
</div>       
      
        <div class="form outer">

            <h2>حساب الضريبة وفقا لقانون الضريبة علي الدخل رقم 187 لسنة 1993 وتعديلاته</h2>
          <hr>
          <hr>
          
            <div class="input">
                    <div class="row inputbox">
                    <div class="col-md-6">
                                      <label id="textbox31">١ ) البيانات الأساسية</label>       
            
                <div class="row inputbox">
                    <div class="col-md-6">
                    <label for="name">الكيـــان القانـــوني :</label> 
                        <select  class="form-control" id="textbox11" onchange="show1()" placeholder="" type="text">
                        <option>-- اختر من القائمة الكيان القانوني --</option>
                        <option>أفراد | أشخاص طبيعية</option>
                        <option>شركات | شركات الأشخاص</option>
                        </select>  

                  
                       <div class="row inputbox">
                       <div class="col-md-6" style="position: relative;">
                       <label for="name">صافي الدخل الخاضع للضريبة :</label>
                       <input class="form-control" id="textbox1" onchange="show2()" placeholder="أدخل صافي الدخل" required="" type="number" />
                       <button type="button" class="clear-btn" onclick="document.getElementById('textbox1').value=''; show2();">❌</button>
                       </div>
                       </div>                  

                      
                        <div class="col-md-6">
                        <label for="textbox10">السنة الضريبية :</label>
                          
                        <select  class="form-control" id="textbox10" onchange="show3()" placeholder="" type="text">
                        <option>-- اختر من القائمة السنة الضريبية --</option>
                        <option>2004</option>
                        <option>2003</option>
                        <option>2002</option>
                        <option>2001</option>
                        <option>2000</option>
                        <option>1999</option>
                        <option>1998</option>  
                        <option>1997</option>
                        <option>1996</option>
                        <option>1995</option>
                        <option>1994</option>  
                        </select>                                                   

                          
                <div class="row inputbox">
                    <div class="col-md-6">
                    <label for="name">الحالة الإجتماعية :</label> 
                        <select  class="form-control" id="textbox14" onchange="show4()" placeholder="" type="text">
                        <option>-- اختر من القائمة الحالة الإجتماعية --</option>
                        <option>أعزب</option>
                        <option>متزوج ولا يعول أولاد</option>
                        <option>غير متزوج ويعول ولدا أو أكثر</option>
                        <option>متزوج ويعول ولدا أو أكثر</option>                            
                        </select>                            
                          
                    <div class="row">
                        <div class="col-md-6">
                        <label for="name">الضريبة المستحقة :</label>
                        <input class="form-control" disabled="" id="textbox4" placeholder="" readonly="" type="text" />
                        </div>

                </div>

                
                <div class="col-md-6">
                    <label for="name"></label>
                
                    
                    
                <!--   <textarea class="form-contro2" disabled="" id="textbox5" readonly=""></textarea> -->
                
                
                </div>
                                                                                                 
                <div class="inputbox row1 ">
                    <div class="col-md-6">
                      
    <a onclick="calculateTaxFromInspection()" id="button2" class="button"><i class="fas fa-check-circle"></i> إحسب الضريبة المستحقة</a> <!-- زر تنفيذي مع أيقونة تحقق -->
                      
                </div>
            </div>

<table id="taxTable1" border="0" width="100%" height="40">
  <tr>
    <th>مـ</th>
    <th>الحالة الإجتماعية</th>
    <th>الأعباء العائلية</th>
    <th>الصافي</th>
  </tr>
</table>                      
                      
<table id="taxTable" border="0" width="100%" height="40">
  <tr>
    <th>مـ</th>
    <th>الشريحة</th>
    <th>النسبة</th>
    <th>الضريبة</th>
    <th>الصافي</th>
  </tr>
</table>
                                            

                    <!-- إحسب الضريبة النهائية -->
                         <label id="textbox31">٢ ) بيانات ربط الضريبة</label>     
                          

                <div class="row inputbox">
                    <div class="col-md-6">
                    <label for="name">نوع المحاسبة :</label> 
                        <select  class="form-control" id="textbox13" onchange="show5()" placeholder="" type="text">
                        <option>-- اختر من القائمة نوع المحاسبة --</option>
                        <option>تقديري غير مؤيد بمستندات</option>
                        <option>دفتري ووارد بالعينة</option>
                        </select>                           
                          
                          
                        <div class="col-md-6 inputbox" style="position: relative;">
                        <label for="textbox3">الضريبة من واقع الإقرار :</label>
                        <input class="form-control" id="textbox3" onchange="show6()" placeholder="أدخل ضريبة الإقرار" type="number" />
                        <button type="button" class="clear-btn" onclick="document.getElementById('textbox3').value=''; show6();">❌</button>
                        </div>  

                        <div class="col-md-6">
                        <label for="textbox9">أساس الربط :</label>                                                  
                        <select  class="form-control" id="textbox9" onchange="show7()" placeholder="" type="text">
                        <option>-- اختر من القائمة أساس الربط --</option>
                        <option>عدم طعن</option>
                        <option>لجنة داخلية</option>
                        <option>لجنة داخلية متخصصة</option>
                        <option>لجنة طعن</option>
                        <option>حكم محكمة</option>
                        </select> 
                          
                        <div class="col-md-6">
                        <label for="textbox8">المادة 87 مكرر :</label>
                        <input class="form-control" disabled="" id="textbox8" readonly="" type="text" />                
                        </div>
                        
                        <div class="row">
                        <div class="col-md-6">
                        <label for="textbox6">الضريبة النهائية :</label>
                        <input class="form-control" disabled="" id="textbox6" readonly="" type="text" />
                        </div>   
                          
                        <!--  <textarea class="form-contro2" disabled="" id="textbox7" readonly=""></textarea>-->
                        
                        
                        </div>
                    </div>
            
                

                    <div class="inputbox row1 ">
                        <div class="col-md-6">
                          
    <a onclick="calculateFinalTax()" id="button4" class="button"><i class="fas fa-check-circle"></i> إحسب الضريبة النهائية</a> <!-- زر تنفيذي مع أيقونة تحقق -->
                          
       <a onclick="resetButton()" id="button5" class="button"><i class="fas fa-times-circle"></i> إفراغ البيانات</a>
                          
                    </div>
                </div>

                      
                </div>
        </div>
    </div>


                  
    <!-- الخلفية المعتمة -->
    <div class="overlay" id="overlay"></div>                 
                      
    <!-- زر الفعل العائم والقائمة -->
    <div class="floating-container">
        <div class="floating-menu" id="floatingMenu">
            <div class="menu-header">
                <h3>روابط هامة للمستخدم :</h3>
                <button class="close-btn" id="closeMenu">❌</button>    
            </div>
            <ul class="menu-items">
                <li class="menu-item" onclick="openSettings()" style="cursor: pointer;">
                  <i class="fas fa-cog"></i>
                  <a>الإعدادات الخاصة بالشاشة</a>
                </li>
               <li class="menu-item" onclick="openVideoPopup()" style="cursor: pointer;">
                  <i class="fas fa-lightbulb"></i>
                  <a>فيديو إستخدام الشاشة</a>
                </li>              
               <li class="menu-item">
                  <i class="fas fa-lightbulb"></i>
                  <a href="go:Feed2">تقديم الإقتراحات للتطوير</a>
                </li>
              <li class="menu-item">
                  <i class="fas fa-exclamation-triangle"></i>
                  <a href="go:Feed1">الإبلاغ الأخطاء المكتشفة</a>
                </li>              
                <li class="menu-item">
                    <i class="fas fa-share-alt"></i>
                    <a href="go:Share-app">شارك التطبيق لأصدقائك</a>
                </li>
                <li class="menu-item">
                    <i class="fas fa-star-half-alt"></i>
                    <a href="go:Rate-app">تقييم التطبيق عـ المتجر</a>
                </li>
            </ul>
        </div>
        
        <button class="floating-btn pulse" id="mainButton">
            <i class="fas fa-plus"></i>
        </button>
    </div>
  
<!-- النص العائم -->
<div class="floating-text" id="floatingText">
    إضغط هنا لعرض المزايا والإعدادات 
</div>                       

    <!-- نافذة الفيديو المنبثقة -->
    <div id="videoModal" class="modal">
        <div class="modal-content">
            <span class="close-btn" onclick="closeVideoPopup()"></span>
            <div class="video-container">
                <iframe id="youtubeVideo" src="" frameborder="0" 
                    allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" 
                    allowfullscreen></iframe>
            </div>
        </div>
    </div>                      
                      
                      
    <!-- طبقة التعتيم -->
    <div id="popupOverlay" class="popup-overlay"></div>
    
    <!-- النافذة المنبثقة -->
    <div id="customPopup" class="popup">
        <div class="popup-icon" id="popupIcon"></div>
        <div class="popup-message" id="popupMessage"></div>
    </div>                      
                      
<!-- زر فتح الإعدادات -->
    <div id="customPopup" class="popup">
        <div class="popup-content">
            <div class="popup-icon" id="popupIcon"></div>
            <div class="popup-message" id="popupMessage"></div>
        </div>
    </div>

    <div id="popupSettings" class="settings-popup">
        <div class="settings-header">
            <h3><i class="fas fa-sliders-h"></i> إعدادات شاشة | ق 187 لسنة 1993</h3>
        </div>
        
        <div class="settings-content">
          
<div class="toggle-all">
    <input type="checkbox" class="settings-checkbox" id="defaultSettingsEnabled" onchange="handleDefaultSettingsToggle()" checked>
    <label class="toggle-all-label">
        <i class="fas fa-cog"></i>
        <span>تفعيل عدم إفراغ الحقول الأساسية</span>
    </label>
</div> 
          
<!-- زر تمييز حقول احتساب الضريبة -->
<div class="toggle-all">
    <input type="checkbox" class="settings-checkbox" id="highlightTaxFieldsEnabled" onchange="handleHighlightTaxFieldsToggle()" checked>
    <label class="toggle-all-label">
        <i class="fas fa-highlighter"></i>
        <span>تمييز لون حقول إحتساب الضريبة</span>
    </label>
</div>
          
    <!-- ألوان التمييز (مخفية بشكل افتراضي) -->
    <div class="color-palette" id="taxFieldsColorPalette" style="display: none; margin-top: 10px;">
        <div class="color-option" data-color="#FFFF99" style="background-color: #FFFF99;" onclick="selectTaxHighlightColor(this)" title="أصفر فاتح"></div>      
        <div class="color-option" data-color="#E0FFFF" style="background-color: #E0FFFF;" onclick="selectTaxHighlightColor(this)" title="سماوي فاتح"></div>
        <div class="color-option" data-color="#FFCC99" style="background-color: #FFCC99;" onclick="selectTaxHighlightColor(this)" title="برتقالي فاتح"></div>
        <div class="color-option" data-color="#99CCFF" style="background-color: #99CCFF;" onclick="selectTaxHighlightColor(this)" title="أزرق فاتح"></div>
        <div class="color-option" data-color="#99FF99" style="background-color: #99FF99;" onclick="selectTaxHighlightColor(this)" title="أخضر فاتح"></div>
        <div class="color-option" data-color="#FF99FF" style="background-color: #FF99FF;" onclick="selectTaxHighlightColor(this)" title="وردي فاتح"></div>
        <div class="color-option" data-color="#CC99FF" style="background-color: #CC99FF;" onclick="selectTaxHighlightColor(this)" title="بنفسجي فاتح"></div>
        <div class="color-option" data-color="#FF9999" style="background-color: #FF9999;" onclick="selectTaxHighlightColor(this)" title="أحمر فاتح"></div>      
    </div>          
          
            <div class="toggle-all">
                <input type="checkbox" class="settings-checkbox" id="popupEnabled" onchange="toggleAllMessages()">
                <label class="toggle-all-label">
                    <i class="fas fa-bell"></i>
                    <span>تفعيل إختفاء جميع الرسائل التنبهية</span>
                </label>
            </div>
          
            <div class="toggle-all">
            <input type="checkbox" class="settings-checkbox" id="resetAllDurations" onchange="resetAllDurations()">
                <label class="toggle-all-label">
                    <i class="fas fa-sliders-h"></i>
                    <span>ضبط إختفاء جميع الرسائل التنبهية</span>
                </label>
            </div>          
          
            

          
            <div class="settings-item">
                <label class="settings-label">
                    <i class="fas fa-info-circle info"></i>
                    <span>التحكم فـ ظهور / ومدة إختفاء رسائل المعلومات (Info) :</span>
                </label>
                <div class="settings-controls">
                    <select class="settings-select" id="durationInfo">
                        <option value="1000" selected>1 ثانية</option> <!-- ✅ الافتراضي -->
                        <option value="2500">2.5 ثانية</option>
                        <option value="5000">5 ثواني</option>
                        <option value="10000">10 ثواني</option>
                        <option value="15000">15 ثانية</option>
                        <option value="30000">30 ثانية</option>
                    </select>
                    <input type="checkbox" class="settings-checkbox" id="enableInfo" onchange="updateSettings('info')">
                </div>
            </div>

            <div class="settings-item">
                <label class="settings-label">
                    <i class="fas fa-check-circle success"></i>
                    <span>التحكم فـ ظهور / ومدة إختفاء رسائل النجاح (Success) :</span>
                </label>
                <div class="settings-controls">
                    <select class="settings-select" id="durationSuccess">
                        <option value="1000" selected>1 ثانية</option> <!-- ✅ الافتراضي -->
                        <option value="2500">2.5 ثانية</option>
                        <option value="5000">5 ثواني</option>
                        <option value="10000">10 ثواني</option>
                        <option value="15000">15 ثانية</option>
                        <option value="30000">30 ثانية</option>
                    </select>
                    <input type="checkbox" class="settings-checkbox" id="enableSuccess" onchange="updateSettings('success')">
                </div>
            </div>

            <div class="settings-item">
                <label class="settings-label">
                    <i class="fas fa-exclamation-triangle warning"></i>
                    <span>التحكم فـ ظهور / ومدة إختفاء رسائل التحذير (Warning) :</span>
                </label>
                <div class="settings-controls">
                    <select class="settings-select" id="durationWarning">
                        <option value="1000" selected>1 ثانية</option> <!-- ✅ الافتراضي -->           
                        <option value="2500">2.5 ثانية</option>
                        <option value="5000">5 ثواني</option>
                        <option value="10000">10 ثواني</option>
                        <option value="15000">15 ثانية</option>
                        <option value="30000">30 ثانية</option>
                    </select>
                    <input type="checkbox" class="settings-checkbox" id="enableWarning" onchange="updateSettings('warning')">
                </div>
            </div>

            <div class="settings-item">
                <label class="settings-label">
                    <i class="fas fa-times-circle error"></i>
                    <span>التحكم فـ ظهور / ومدة إختفاء رسائل الخطأ (Error) :</span>
                </label>
                <div class="settings-controls">
                    <select class="settings-select" id="durationError">
                        <option value="1000" selected>1 ثانية</option> <!-- ✅ الافتراضي -->
                        <option value="2500">2.5 ثانية</option>
                        <option value="5000">5 ثواني</option>
                        <option value="10000">10 ثواني</option>
                        <option value="15000">15 ثانية</option>
                        <option value="30000">30 ثانية</option>
                    </select>
                    <input type="checkbox" class="settings-checkbox" id="enableError" onchange="updateSettings('error')">
                </div>
            </div>


  
        </div>

        <div class="settings-footer">
            <a onclick="saveSettings()" class="button"><i class="fas fa-save"></i> حفظ</a>
            <a onclick="closeSettings()" class="button" style="background: linear-gradient(135deg, #e53935, #c62828);"><i class="fas fa-times"></i> إغلاق</a>
        </div>
    </div>


    <script>  
function setDefaultFormValues() {
    // الكيان القانوني: أفراد | أشخاص طبيعية
    const legalEntitySelect = document.getElementById('textbox11');
    if (legalEntitySelect) {
        for (let i = 0; i < legalEntitySelect.options.length; i++) {
            if (legalEntitySelect.options[i].text.includes('أفراد | أشخاص طبيعية')) {
                legalEntitySelect.selectedIndex = i;
                break;
            }
        }
    }

    // معالجة السنة الضريبية
    const yearSelect = document.getElementById('textbox10');
    if (yearSelect) {
        const currentYear = new Date().getFullYear();
        const previousYear = currentYear - 1;
        let foundYear = null;
        
        // البحث عن السنوات الممكنة
        const availableYears = [];
        for (let i = 0; i < yearSelect.options.length; i++) {
            const optionYear = parseInt(yearSelect.options[i].value || yearSelect.options[i].text);
            if (!isNaN(optionYear)) {
                availableYears.push(optionYear);
                
                // تحديد السنة الحالية إذا وجدت
                if (optionYear === currentYear) {
                    yearSelect.selectedIndex = i;
                    foundYear = currentYear;
                    break;
                }
            }
        }
        
        // إذا لم توجد السنة الحالية، نبحث عن السنة السابقة
        if (!foundYear && availableYears.length > 0) {
            // البحث عن السنة السابقة
            for (let i = 0; i < yearSelect.options.length; i++) {
                const optionYear = parseInt(yearSelect.options[i].value || yearSelect.options[i].text);
                if (optionYear === previousYear) {
                    yearSelect.selectedIndex = i;
                    foundYear = previousYear;
                    break;
                }
            }
            
            // إذا لم توجد السنة السابقة، نحدد آخر سنة متاحة
            if (!foundYear) {
                const lastAvailableYear = Math.max(...availableYears);
                for (let i = 0; i < yearSelect.options.length; i++) {
                    const optionYear = parseInt(yearSelect.options[i].value || yearSelect.options[i].text);
                    if (optionYear === lastAvailableYear) {
                        yearSelect.selectedIndex = i;
                        break;
                    }
                }
            }
        }
    }
  
  
    // الحالة الإجتماعية: أعزب
    const socialStatusSelect = document.getElementById('textbox14');
    if (socialStatusSelect) {
        for (let i = 0; i < socialStatusSelect.options.length; i++) {
            if (socialStatusSelect.options[i].text.includes('أعزب')) {
                socialStatusSelect.selectedIndex = i;
                break;
            }
        }
    }  

    // نوع المحاسبة: تقديري غير مؤيد بمستندات
    const accountingTypeSelect = document.getElementById('textbox13');
    if (accountingTypeSelect) {
        for (let i = 0; i < accountingTypeSelect.options.length; i++) {
            if (accountingTypeSelect.options[i].text.includes('تقديري غير مؤيد بمستندات')) {
                accountingTypeSelect.selectedIndex = i;
                break;
            }
        }
    }

    // أساس الربط: لجنة داخلية
    const bindingBasisSelect = document.getElementById('textbox9');
    if (bindingBasisSelect) {
        for (let i = 0; i < bindingBasisSelect.options.length; i++) {
            if (bindingBasisSelect.options[i].text.includes('لجنة داخلية')) {
                bindingBasisSelect.selectedIndex = i;
                break;
            }
        }
    }
}

// استدعاء الدالة عند تحميل الصفحة
document.addEventListener('DOMContentLoaded', setDefaultFormValues);
    
   
 
// دالة للتحكم في تفعيل وإلغاء افراغ الحقول الاساسية
function handleDefaultSettingsToggle() {
    // الحصول على عنصر خانة الاختيار
    const defaultSettingsCheckbox = document.getElementById('defaultSettingsEnabled');
    const isChecked = defaultSettingsCheckbox.checked;
    
    // حفظ الحالة في التخزين المحلي عند التفعيل أو إزالتها عند الإلغاء
    if (isChecked) {
        localStorage.setItem('defaultSettingsEnabled', 'true');
    } else {
        localStorage.removeItem('defaultSettingsEnabled');
    }
    
    // تحضير الرسالة المناسبة حسب الحالة
    const message = isChecked 
        ? "تم تفعيل عدم إفراغ حقول الإدخال الأساسية" 
        : "تم إلغاء تفعيل إفراغ حقول الإدخال الأساسية";
    
    // نوع الرسالة (نجاح للمسح، معلومة للتأكيد)
    const messageType = isChecked ? 'info' : 'success';
    
    // عرض الرسالة المنبثقة
    showPopup(message, messageType, 1000, true);

    // تأخير تنفيذ العمليات لضمان ظهور الرسالة
    setTimeout(() => {
        if (isChecked) {
            setDefaultFormValues(); // تعيين القيم الافتراضية
        } else {
            resetAllSelectsToFirstOption(); // إعادة تعيين الحقول
        }
    }, 300);
}

// دالة لعرض الرسائل المنبثقة
function showPopup(message, type = 'info', duration = 1000, closable = true) {
    // التحقق من وجود عناصر النافذة المنبثقة أو إنشائها
    let popup = document.getElementById('custom-popup');
    let overlay = document.getElementById('custom-overlay');
    
    if (!popup) {
        createPopupElements(); // إنشاء العناصر إذا لم تكن موجودة
        popup = document.getElementById('custom-popup');
        overlay = document.getElementById('custom-overlay');
    }
    
    // تعيين محتوى الرسالة ونوعها
    popup.querySelector('.popup-message').textContent = message;
    popup.className = `popup show popup-${type}`;
    overlay.className = 'overlay show';
    
    // إغلاق تلقائي بعد المدة المحددة
    if (duration > 0) {
        setTimeout(hidePopup, duration);
    }
}

// دالة لإنشاء عناصر النافذة المنبثقة في واجهة المستخدم
function createPopupElements() {
    // إنشاء طبقة التغطية الخلفية
    const overlay = document.createElement('div');
    overlay.id = 'custom-overlay';
    overlay.className = 'overlay';
    
    // إنشاء النافذة المنبثقة الرئيسية
    const popup = document.createElement('div');
    popup.id = 'custom-popup';
    popup.className = 'popup';
    
    // بناء الهيكل الداخلي للنافذة
    popup.innerHTML = `
        <div class="popup-content">
            <span class="popup-message"></span>
            <button class="popup-close">×</button>
        </div>
    `;
    
    // إضافة العناصر إلى الجسم الرئيسي للصفحة
    document.body.appendChild(overlay);
    document.body.appendChild(popup);
    
    // إضافة معالجات أحداث للإغلاق
    popup.querySelector('.popup-close').addEventListener('click', hidePopup);
    overlay.addEventListener('click', hidePopup);
}

// دالة لإخفاء النافذة المنبثقة
function hidePopup() {
    const popup = document.getElementById('custom-popup');
    const overlay = document.getElementById('custom-overlay');
    
    if (popup) popup.classList.remove('show');
    if (overlay) overlay.classList.remove('show');
}

// دالة لتعيين القيم الافتراضية للنموذج
function setDefaultFormValues() {
    // تعيين الكيان القانوني: أفراد | أشخاص طبيعية
    setSelectValue('textbox11', 'أفراد | أشخاص طبيعية');
    
    // تعيين السنة الضريبية (الحالية أو السابقة)
    setTaxYearValue();

    // تعيين الإجتماعية: أعزب
    setSelectValue('textbox14', 'أعزب');  
  
    // تعيين نوع المحاسبة: تقديري غير مؤيد بمستندات
    setSelectValue('textbox13', 'تقديري غير مؤيد بمستندات');
    
    // تعيين أساس الربط: لجنة داخلية
    setSelectValue('textbox9', 'لجنة داخلية');
}

// العناصر
function setSelectValue(id, searchText) {
    const selectElement = document.getElementById(id);
    if (selectElement) {
        for (let i = 0; i < selectElement.options.length; i++) {
            if (selectElement.options[i].text.includes(searchText)) {
                selectElement.selectedIndex = i;
                break;
            }
        }
    }
}

// دالة خاصة لتعيين السنة الضريبية
function setTaxYearValue() {
    const yearSelect = document.getElementById('textbox10');
    if (!yearSelect) return;
    
    const currentYear = new Date().getFullYear();
    const previousYear = currentYear - 1;
    
    // البحث عن السنة الحالية أولاً
    if (!setYearIfFound(yearSelect, currentYear)) {
        // إذا لم توجد السنة الحالية، البحث عن السنة السابقة
        if (!setYearIfFound(yearSelect, previousYear)) {
            // إذا لم توجد، اختيار آخر سنة متاحة
            setLastAvailableYear(yearSelect);
        }
    }
}

// دالة مساعدة للبحث عن سنة محددة وتعيينها
function setYearIfFound(selectElement, year) {
    for (let i = 0; i < selectElement.options.length; i++) {
        const optionYear = parseInt(selectElement.options[i].value || selectElement.options[i].text);
        if (!isNaN(optionYear) && optionYear === year) {
            selectElement.selectedIndex = i;
            return true;
        }
    }
    return false;
}

// دالة مساعدة لتعيين آخر سنة متاحة
function setLastAvailableYear(selectElement) {
    let maxYear = 0;
    let maxIndex = 0;
    
    for (let i = 0; i < selectElement.options.length; i++) {
        const optionYear = parseInt(selectElement.options[i].value || selectElement.options[i].text);
        if (!isNaN(optionYear) && optionYear > maxYear) {
            maxYear = optionYear;
            maxIndex = i;
        }
    }
    
    if (maxYear > 0) {
        selectElement.selectedIndex = maxIndex;
    }
}

// دالة لإعادة تعيين جميع حقول select إلى الخيار الأول
function resetAllSelectsToFirstOption() {
    const selectIds = ['textbox11', 'textbox10', 'textbox13', 'textbox9', 'textbox14'];
    
    selectIds.forEach(id => {
        const selectElement = document.getElementById(id);
        if (selectElement && selectElement.options.length > 0) {
            selectElement.selectedIndex = 0;
        }
    });
}

// تهيئة الصفحة عند التحميل
document.addEventListener('DOMContentLoaded', function() {
    const checkbox = document.getElementById('defaultSettingsEnabled');
    
    if (checkbox) {
        // التحقق من وجود إعدادات محفوظة مسبقاً
        const isDefaultEnabled = localStorage.getItem('defaultSettingsEnabled') === 'true';
        
        // تعيين حالة الخانة حسب التخزين المحلي
        checkbox.checked = isDefaultEnabled;
        
        if (isDefaultEnabled) {
            // إذا كانت مفعلة مسبقاً، تعيين القيم بدون عرض الرسالة
            setDefaultFormValues();
        } else {
            // إذا لم تكن مفعلة، تفعيلها تلقائياً وعرض الرسالة
            checkbox.checked = true;
            localStorage.setItem('defaultSettingsEnabled', 'true');
            showPopup("تم تفعيل عدم إفراغ حقول الإدخال الأساسية", 'info', 1000, true);
            setDefaultFormValues();
        }
    }
});
      
      
// اعدادات الاختفاء الاساسية 
function resetAllDurations(suppressMessage = false) {
    const resetCheckbox = document.getElementById('resetAllDurations');
    const durationSelects = [
        document.getElementById('durationInfo'),
        document.getElementById('durationSuccess'),
        document.getElementById('durationWarning'),
        document.getElementById('durationError')
    ];

    if (resetCheckbox.checked) {
        // ضبط جميع المدد إلى 1 ثانية (الخيار الأول) وإقفالها
        durationSelects.forEach(select => {
            if (select) {
                select.selectedIndex = 0;
                select.disabled = true;
            }
        });
        
        // حفظ الحالة في التخزين المحلي
        localStorage.setItem('resetAllDurations', 'true');
        
        // عرض الرسالة فقط إذا لم يتم كتمها
        if (!suppressMessage) {
            showPopup('تم ضبط اعدادات إختفاء الرسائل بعد 1 ثانية تلقائي', 'success', 1000, true);
        }
    } else {
        // إعادة فتح جميع المدد
        durationSelects.forEach(select => {
            if (select) select.disabled = false;
        });
        
        // حذف الحالة من التخزين المحلي
        localStorage.removeItem('resetAllDurations');
        
        // عرض الرسالة فقط إذا لم يتم كتمها
        if (!suppressMessage) {
            showPopup('تم إلغاء الإختفاء الإفتراضي يمكنك ضبط كل رسالة علي حدة', 'info', 1000, true);
        }
    }
}

// تهيئة العنصر عند تحميل الصفحة (بدون عرض الرسالة)
function initializeResetCheckbox() {
    const resetCheckbox = document.getElementById('resetAllDurations');
    if (localStorage.getItem('resetAllDurations') === 'true') {
        resetCheckbox.checked = true;
        resetAllDurations(true); // نمرر true لكتم الرسالة
    }
}

// استدعاء الدالة عند تحميل الصفحة
window.addEventListener('DOMContentLoaded', initializeResetCheckbox);
      
// دالة عرض الرسائل المنبثقة
function showPopup(message, type = 'info') {
    // إنشاء العناصر إذا لم تكن موجودة
    if (!document.getElementById('popupOverlay')) {
        createPopupElements();
    }

    const popup = document.getElementById('customPopup');
    const overlay = document.getElementById('popupOverlay');
    const icon = document.getElementById('popupIcon');
    const msg = document.getElementById('popupMessage');

    // تعيين محتوى الرسالة
    msg.textContent = message;

    // تعيين النوع والمظهر
    popup.className = `popup ${type}`;

    // تعيين الأيقونة المناسبة
    const icons = {
        'info': 'fas fa-info-circle',
        'success': 'fas fa-check-circle',
        'warning': 'fas fa-exclamation-triangle',
        'error': 'fas fa-times-circle'
    };
    icon.className = `popup-icon ${icons[type] || icons['info']}`;

    // عرض الرسالة
    popup.classList.add('show');
    overlay.classList.add('show');

    // إخفاء تلقائي بعد 1 ثانية
    setTimeout(hidePopup, 1000);
}

// دالة إخفاء الرسالة المنبثقة
function hidePopup() {
    const popup = document.getElementById('customPopup');
    const overlay = document.getElementById('popupOverlay');
    
    if (popup) popup.classList.remove('show');
    if (overlay) overlay.classList.remove('show');
}      
      

      
// اعدادات تلوين حقول احتساب الضريبة      
const taxFieldsIds = ['textbox8', 'textbox6', 'textbox4', 'textbox5'];
    
    // عند تحميل الصفحة، تحميل التفضيلات من التخزين المحلي
    document.addEventListener('DOMContentLoaded', function() {
        loadTaxHighlightSettings();
    });
    
    // تبديل تمييز الحقول
    function handleHighlightTaxFieldsToggle() {
        const checkbox = document.getElementById('highlightTaxFieldsEnabled');
        const colorPalette = document.getElementById('taxFieldsColorPalette');
        
        if (checkbox.checked) {
            colorPalette.style.display = 'flex';
            
            // تطبيق اللون المحفوظ إذا كان موجوداً
            const savedColor = localStorage.getItem('taxHighlightColor');
            if (savedColor) {
                applyHighlightColor(savedColor);
                selectColorOption(savedColor);
            } else {
                // لون افتراضي إذا لم يكن هناك لون محفوظ
                applyHighlightColor('#FFFF99');
                selectColorOption('#FFFF99');
            }
        } else {
            colorPalette.style.display = 'none';
            removeHighlightFromFields();
        }
        
        // حفظ الحالة في التخزين المحلي
        localStorage.setItem('taxHighlightEnabled', checkbox.checked);
    }
    
    // اختيار لون التمييز
    function selectTaxHighlightColor(element) {
        const color = element.getAttribute('data-color');
        applyHighlightColor(color);
        selectColorOption(color);
        
        // حفظ اللون المختار في التخزين المحلي
        localStorage.setItem('taxHighlightColor', color);
    }
    
    // تطبيق لون التمييز على الحقول
    function applyHighlightColor(color) {
        taxFieldsIds.forEach(id => {
            const field = document.getElementById(id);
            if (field) {
                field.style.setProperty('--tax-highlight-color', color);
                field.classList.add('highlighted');
            }
        });
    }
    
    // إزالة التمييز من الحقول
    function removeHighlightFromFields() {
        taxFieldsIds.forEach(id => {
            const field = document.getElementById(id);
            if (field) {
                field.classList.remove('highlighted');
            }
        });
    }
    
    // تحديد خيار اللون في لوحة الألوان
    function selectColorOption(color) {
        const colorOptions = document.querySelectorAll('.color-option');
        colorOptions.forEach(option => {
            if (option.getAttribute('data-color') === color) {
                option.classList.add('selected');
            } else {
                option.classList.remove('selected');
            }
        });
    }
    
    // تحميل إعدادات التمييز من التخزين المحلي
    function loadTaxHighlightSettings() {
        const savedState = localStorage.getItem('taxHighlightEnabled');
        const checkbox = document.getElementById('highlightTaxFieldsEnabled');
        const colorPalette = document.getElementById('taxFieldsColorPalette');
        
        if (savedState !== null) {
            checkbox.checked = savedState === 'true';
            
            if (checkbox.checked) {
                colorPalette.style.display = 'flex';
                
                const savedColor = localStorage.getItem('taxHighlightColor');
                if (savedColor) {
                    applyHighlightColor(savedColor);
                    selectColorOption(savedColor);
                } else {
                    applyHighlightColor('#FFFF99');
                    selectColorOption('#FFFF99');
                }
            }
        } else {
            // الحالة الافتراضية عند عدم وجود إعدادات محفوظة
            checkbox.checked = true;
            colorPalette.style.display = 'flex';
            applyHighlightColor('#FFFF99');
            selectColorOption('#FFFF99');
        }
    }
      

      
// دالة عرض الفيديو المنبثق       
        function openVideoPopup() {
            const modal = document.getElementById('videoModal');
            const videoFrame = document.getElementById('youtubeVideo');
            
            // تعيين رابط فيديو يوتيوب
            videoFrame.src = "https://www.youtube.com/embed/cNoDjc-a1JU?autoplay=1";
            
            modal.style.display = "flex";
            setTimeout(() => {
                modal.classList.add('active');
            }, 10);
            
            // منع التمرير عند فتح النافذة
            document.body.style.overflow = 'hidden';
           closeFloatingMenu();
        }
        
        function closeVideoPopup() {
            const modal = document.getElementById('videoModal');
            const videoFrame = document.getElementById('youtubeVideo');
            
            modal.classList.remove('active');
            setTimeout(() => {
                videoFrame.src = "";
                modal.style.display = "none";
            }, 300);
            
            // إعادة التمرير عند الإغلاق
            document.body.style.overflow = 'auto';
        }
        
        // إغلاق النافذة عند النقر خارجها
        window.onclick = function(event) {
            const modal = document.getElementById('videoModal');
            if (event.target == modal) {
                closeVideoPopup();
            }
        }
        
        // إغلاق النافذة عند الضغط على زر ESC
        document.onkeydown = function(evt) {
            evt = evt || window.event;
            if (evt.keyCode == 27) {
                closeVideoPopup();
            }
        };  
      

      
        // دالة عرض الرسالة
        function showPopup(message, type = 'info') {
            const popup = document.getElementById('customPopup');
            const overlay = document.getElementById('popupOverlay');
            const icon = document.getElementById('popupIcon');
            const msg = document.getElementById('popupMessage');
            
            // تعيين الرسالة
            msg.textContent = message;
            
            // تعيين النوع والمظهر
            popup.className = 'popup ' + type;
            
            // تعيين الأيقونة المناسبة
            const icons = {
                'info': 'fas fa-info-circle',
                'warning': 'fas fa-exclamation-triangle',
                'error': 'fas fa-times-circle',
                'success': 'fas fa-check-circle'
            };
            icon.className = 'popup-icon ' + (icons[type] || icons['info']);
            
            // عرض الرسالة
            popup.classList.add('show');
            overlay.classList.add('show');
            
            // إخفاء تلقائي بعد 1 ثانية
            setTimeout(hidePopup, 1000);
        }
        
        // دالة إخفاء الرسالة
        function hidePopup() {
            document.getElementById('customPopup').classList.remove('show');
            document.getElementById('popupOverlay').classList.remove('show');
        }
        
            // مثال للاستخدام
            /*
            أنواع الرسائل المتاحة:
            showPopup("تمت العملية بنجاح", 'info');
            showPopup("تمت العملية بنجاح", 'success');
            showPopup("تحذير: هذا الحقل مطلوب", 'warning');
            showPopup("حدث خطأ غير متوقع", 'error');
            */
    </script>
                      
 
    <script>
        let popupSettings = {
            hideAll: false,
            durations: {
                info: 1000,
                success: 1000,
                warning: 1000,
                error: 1000
            },
            hiddenTypes: {
                info: false,
                success: false,
                warning: false,
                error: false
            }
        };

        // تحميل الإعدادات عند بدء التشغيل
        function loadSettings() {
            const savedSettings = localStorage.getItem('popupSettings');
            if (savedSettings) {
                try {
                    const parsedSettings = JSON.parse(savedSettings);
                    
                    popupSettings = {
                        hideAll: parsedSettings.hideAll !== undefined ? parsedSettings.hideAll : false,
                        durations: {
                            info: parsedSettings.durations?.info || 1000,
                            success: parsedSettings.durations?.success || 1000,
                            warning: parsedSettings.durations?.warning || 1000,
                            error: parsedSettings.durations?.error || 1000
                        },
                        hiddenTypes: {
                            info: parsedSettings.hiddenTypes?.info || false,
                            success: parsedSettings.hiddenTypes?.success || false,
                            warning: parsedSettings.hiddenTypes?.warning || false,
                            error: parsedSettings.hiddenTypes?.error || false
                        }
                    };
                    
                    updateUIFromSettings();
                    
                } catch (e) {
                    console.error('Failed to parse saved settings', e);
                    saveSettingsToLocalStorage();
                }
            } else {
                saveSettingsToLocalStorage();
            }
        }

        // تحديث واجهة المستخدم من الإعدادات
        function updateUIFromSettings() {
            document.getElementById('durationInfo').value = popupSettings.durations.info;
            document.getElementById('durationSuccess').value = popupSettings.durations.success;
            document.getElementById('durationWarning').value = popupSettings.durations.warning;
            document.getElementById('durationError').value = popupSettings.durations.error;
            
            document.getElementById('enableInfo').checked = popupSettings.hiddenTypes.info;
            document.getElementById('enableSuccess').checked = popupSettings.hiddenTypes.success;
            document.getElementById('enableWarning').checked = popupSettings.hiddenTypes.warning;
            document.getElementById('enableError').checked = popupSettings.hiddenTypes.error;
            
            document.getElementById('popupEnabled').checked = popupSettings.hideAll;
        }

        // حفظ الإعدادات في التخزين المحلي
        function saveSettingsToLocalStorage() {
            localStorage.setItem('popupSettings', JSON.stringify(popupSettings));
        }

        function showPopup(message, type = 'info', customDuration = null, isSystemMessage = false) {
            // إذا كانت رسالة نظامية، لا تطبق عليها قواعد الإخفاء
            if (!isSystemMessage && (popupSettings.hideAll || popupSettings.hiddenTypes[type])) {
                return;
            }

            const popup = document.getElementById('customPopup');
            const overlay = document.getElementById('popupOverlay');
            const icon = document.getElementById('popupIcon');
            const msg = document.getElementById('popupMessage');

            msg.textContent = message;
            popup.className = 'popup ' + type;

            const icons = {
                'info': 'fas fa-info-circle info',
                'warning': 'fas fa-exclamation-triangle warning',
                'error': 'fas fa-times-circle error',
                'success': 'fas fa-check-circle success'
            };
            icon.className = 'popup-icon ' + (icons[type] || icons['info']);

            popup.classList.add('show');
            overlay.classList.add('show');

            const duration = customDuration !== null ? customDuration : popupSettings.durations[type] || 1000;
setTimeout(() => {
    // إخفاء الرسالة المنبثقة
    document.getElementById('customPopup').classList.remove('show');
    
    // التحقق من حالة نافذة الإعدادات
    const settingsPopup = document.getElementById('popupSettings');
    const overlay = document.getElementById('popupOverlay');
    
    // إخفاء الخلفية فقط إذا كانت نافذة الإعدادات غير ظاهرة
    if (!settingsPopup.classList.contains('show') && settingsPopup.style.display !== 'block') {
        overlay.classList.remove('show');
    }
}, duration);
        }

        function openSettings() {
            document.getElementById('popupSettings').classList.add('show');
            document.getElementById('popupOverlay').classList.add('show');
            loadSettings();
        }

        function closeSettings() {
            document.getElementById('popupSettings').classList.remove('show');
            document.getElementById('popupOverlay').classList.remove('show');
        }

        function saveSettings() {
            popupSettings.durations.info = parseInt(document.getElementById('durationInfo').value) || 1000;
            popupSettings.durations.success = parseInt(document.getElementById('durationSuccess').value) || 1000;
            popupSettings.durations.warning = parseInt(document.getElementById('durationWarning').value) || 1000;
            popupSettings.durations.error = parseInt(document.getElementById('durationError').value) || 1000;
            
            popupSettings.hiddenTypes.info = document.getElementById('enableInfo').checked;
            popupSettings.hiddenTypes.success = document.getElementById('enableSuccess').checked;
            popupSettings.hiddenTypes.warning = document.getElementById('enableWarning').checked;
            popupSettings.hiddenTypes.error = document.getElementById('enableError').checked;
            
            popupSettings.hideAll = document.getElementById('popupEnabled').checked;

            saveSettingsToLocalStorage();
            showPopup("تم حفظ الإعدادات بنجاح", "success", 1000, true);
            
            setTimeout(closeSettings, 1000);
            closeFloatingMenu();
        }

        function updateSettings(type) {
            const checkbox = document.getElementById('enable' + capitalize(type));
            const isChecked = checkbox.checked;
            
            popupSettings.hiddenTypes[type] = isChecked;
            
            updateHideAllCheckbox();
            
            saveSettingsToLocalStorage();
            
            const typeInArabic = getTypeInArabic(type);
            const message = isChecked ? "تم تفعيل إخفاء رسائل " + typeInArabic : "تم إلغاء إخفاء رسائل " + typeInArabic;
            showPopup(message, isChecked ? 'info' : type, 1000, true);
        }

        function toggleAllMessages() {
            const isChecked = document.getElementById('popupEnabled').checked;
            
            // عرض الرسالة أولاً قبل تطبيق الإعدادات
            const message = isChecked ? "تم تفعيل إخفاء كافة أنواع الرسائل" : "تم إلغاء إخفاء كافة أنواع الرسائل";
            showPopup(message, isChecked ? 'info' : 'success', 1000, true);
            
            // تطبيق الإعدادات بعد عرض الرسالة
            popupSettings.hideAll = isChecked;
            
            if (isChecked) {
                popupSettings.hiddenTypes.info = true;
                popupSettings.hiddenTypes.success = true;
                popupSettings.hiddenTypes.warning = true;
                popupSettings.hiddenTypes.error = true;
            } else {
                popupSettings.hiddenTypes.info = false;
                popupSettings.hiddenTypes.success = false;
                popupSettings.hiddenTypes.warning = false;
                popupSettings.hiddenTypes.error = false;
            }
            
            updateUIFromSettings();
            saveSettingsToLocalStorage();
        }

        function updateHideAllCheckbox() {
            const allChecked = popupSettings.hiddenTypes.info && 
                              popupSettings.hiddenTypes.success && 
                              popupSettings.hiddenTypes.warning && 
                              popupSettings.hiddenTypes.error;
            
            document.getElementById('popupEnabled').checked = allChecked;
            popupSettings.hideAll = allChecked;
            
            if (allChecked) {
                showPopup("تم تفعيل إخفاء كافة أنواع الرسائل تلقائياً", "info", 1000, true);
            }
        }

        function getTypeInArabic(type) {
            const types = {
                'info': 'المعلومات',
                'success': 'النجاح',
                'warning': 'التحذير',
                'error': 'الخطأ'
            };
            return types[type] || type;
        }

        function capitalize(txt) {
            return txt.charAt(0).toUpperCase() + txt.slice(1);
        }

        // تحميل الإعدادات عند بدء التشغيل
        window.addEventListener('DOMContentLoaded', loadSettings);

// إغلاق النافذة عند النقر خارجها
document.addEventListener('click', function(event) {
    const settingsPopup = document.getElementById('popupSettings');
    const overlay = document.getElementById('popupOverlay');
    
    // تحقق مما إذا كانت النافذة ظاهرة (بأي طريقة عرض)
    const isPopupVisible = settingsPopup.classList.contains('show') || 
                         settingsPopup.style.display === 'block';
    
    // تحقق من النقر خارج النافذة وخارج أي عناصر متعلقة بها
    if (isPopupVisible && 
        !event.target.closest('#popupSettings') && 
        !event.target.closest('[onclick*="openSettings"]') &&
        event.target !== settingsPopup) {
        
        closeSettings();
    }
});
   
      
      
function openSettings() {
document.getElementById("popupSettings").style.display = "block";
  
  setTimeout(function() {
    document.getElementById("popupOverlay").classList.add("show");
  }, 50);
}

function closeSettings() {
  document.getElementById("popupSettings").style.display = "none";
  document.getElementById("popupOverlay").classList.remove("show");
}      
    </script>               
                      
    <script>
        // عناصر DOM
        const mainButton = document.getElementById('mainButton');
        const floatingMenu = document.getElementById('floatingMenu');
        const closeMenu = document.getElementById('closeMenu');
        const overlay = document.getElementById('overlay');

        // تبديل القائمة المنبثقة
        mainButton.addEventListener('click', function(e) {
            e.stopPropagation();
            this.classList.toggle('active');
            floatingMenu.classList.toggle('active');
            
            if (floatingMenu.classList.contains('active')) {
                // إظهار الخلفية المعتمة ومنع التمرير
                overlay.style.display = 'block';
                document.body.classList.add('body-no-scroll');
                document.addEventListener('click', closeMenuOutside);
            } else {
                // إخفاء الخلفية المعتمة وتمكين التمرير
                overlay.style.display = 'none';
                document.body.classList.remove('body-no-scroll');
                document.removeEventListener('click', closeMenuOutside);
            }
        });
        
        // إغلاق القائمة عند النقر على الزر المغلق
        closeMenu.addEventListener('click', function() {
            closeFloatingMenu();
        });
        
function closeMenuOutside(e) {
    const settingsPopup = document.getElementById('popupSettings');
    const videoModal = document.getElementById('videoModal');
    
    const isSettingsVisible = settingsPopup.classList.contains('show') || 
                            settingsPopup.style.display === 'block';
    
    const isVideoVisible = videoModal.style.display === 'block' || 
                         getComputedStyle(videoModal).display === 'block';

    // حالة خاصة: إذا كانت نافذة الفيديو ظاهرة، أغلق القائمة فوراً
    if (isVideoVisible) {
        closeFloatingMenu();
        return; // نخرج من الدالة فوراً بعد الإغلاق
    }
    
    // الحالة العامة: لا تغلق القائمة إذا كانت نافذة الإعدادات ظاهرة
    if (!isSettingsVisible && !floatingMenu.contains(e.target) && e.target !== mainButton) {
        closeFloatingMenu();
    }
}
        
        function closeFloatingMenu() {
            mainButton.classList.remove('active');
            floatingMenu.classList.remove('active');
            overlay.style.display = 'none';
            document.body.classList.remove('body-no-scroll');
            document.removeEventListener('click', closeMenuOutside);
        }


        // إزالة تأثير النبض بعد 5 ثواني
        setTimeout(() => {
            mainButton.classList.remove('pulse');
        }, 5000);

document.addEventListener("DOMContentLoaded", function () {
    showFloatingText(); // استدعاء الدالة عند تحميل الصفحة

    // تكرار إظهار النص العائم كل 30 ثانية
    setInterval(function() {
        showFloatingText();
    }, 30000);
});

// دالة لإظهار النص العائم
function showFloatingText() {
    var floatingText = document.getElementById("floatingText");
    floatingText.style.display = "block";

    // إخفاء النص العائم بعد 5 ثواني
    setTimeout(function() {
        floatingText.style.display = "none";
    }, 5000);
}    
 </script>                 
                  

<script> 
function show1() {
    var textbox11 = document.getElementById("textbox11");
    var textbox1 = document.getElementById("textbox1");   
    const textbox4 = document.getElementById("textbox4");  
    var textbox3 = document.getElementById("textbox3");
    var textbox8 = document.getElementById("textbox8");         
    var textbox6 = document.getElementById("textbox6"); 

    let caption = "";
  
    if ( textbox11.value === "-- اختر من القائمة الكيان القانوني --" ) {
    textbox1.value="";  
    textbox4.value = "";
    textbox3.value = "";
    textbox8.value = ""; 
    textbox6.value = "";           
// Function to populate tax table
    const table = document.getElementById("taxTable");

    const table1 = document.getElementById("taxTable1");  
  
    // Clear the table data (excluding header row)
    while (table.rows.length > 1) {
        table.deleteRow(1);
    }
    while (table1.rows.length > 1) {
        table1.deleteRow(1);
    }                  
                  
    } else  if ( textbox11.value === "أفراد | أشخاص طبيعية" ) {
    textbox1.value = "";            
    textbox4.value = "";
    textbox3.value = "";
    textbox8.value = ""; 
    textbox6.value = "";           
// Function to populate tax table
    const table = document.getElementById("taxTable");

    const table1 = document.getElementById("taxTable1");  
  
    // Clear the table data (excluding header row)
    while (table.rows.length > 1) {
        table.deleteRow(1);
    }
    while (table1.rows.length > 1) {
        table1.deleteRow(1);
    }                   
                  
     } else  if ( textbox11.value === "شركات | شركات الأشخاص" ) {
    textbox1.value = "";              
    textbox4.value = "";
    textbox3.value = "";
    textbox8.value = ""; 
    textbox6.value = "";           
// Function to populate tax table
    const table = document.getElementById("taxTable");

    const table1 = document.getElementById("taxTable1");  
  
    // Clear the table data (excluding header row)
    while (table.rows.length > 1) {
        table.deleteRow(1);
    }
    while (table1.rows.length > 1) {
        table1.deleteRow(1);
    }                  
                  
                  
                  
} 
  
// ------------------------------
      
    textbox5.value = caption; 
  
       }           
        
</script>                     

                  
                  
<script> 
function show2() {
    var textbox11 = document.getElementById("textbox11");
    var textbox1 = document.getElementById("textbox1");   
    const textbox4 = document.getElementById("textbox4");  
    var textbox3 = document.getElementById("textbox3");
    var textbox8 = document.getElementById("textbox8");         
    var textbox6 = document.getElementById("textbox6"); 

    let caption = "";
  
    if ( textbox1.value === "" ) { 
    textbox4.value = "";
    textbox3.value = "";
    textbox8.value = ""; 
    textbox6.value = "";           
// Function to populate tax table
    const table = document.getElementById("taxTable");

    const table1 = document.getElementById("taxTable1");  
  
    // Clear the table data (excluding header row)
    while (table.rows.length > 1) {
        table.deleteRow(1);
    }
    while (table1.rows.length > 1) {
        table1.deleteRow(1);
    }                  
                  
    } else  if ( textbox1.value ==="0" ) {      
    textbox4.value = "";
    textbox3.value = "";
    textbox8.value = ""; 
    textbox6.value = "";           
// Function to populate tax table
    const table = document.getElementById("taxTable");

    const table1 = document.getElementById("taxTable1");  
  
    // Clear the table data (excluding header row)
    while (table.rows.length > 1) {
        table.deleteRow(1);
    }
    while (table1.rows.length > 1) {
        table1.deleteRow(1);
    }                   
                  
                  
                  
} 
  
// ------------------------------
      
    textbox5.value = caption; 
  
       }           
        
</script>                  
                  

                  
<script> 
function show3() {
    var textbox11 = document.getElementById("textbox11");
    var textbox1 = document.getElementById("textbox1");   
    var textbox10 = document.getElementById("textbox10");
    const textbox4 = document.getElementById("textbox4");    
    var textbox3 = document.getElementById("textbox3");
    var textbox8 = document.getElementById("textbox8");         
    var textbox6 = document.getElementById("textbox6");
  
    let caption = "";
  
    if ( textbox10.value === "-- اختر من القائمة السنة الضريبية --" ) {      
    textbox4.value = "";
    textbox3.value = "";
    textbox8.value = ""; 
    textbox6.value = "";           
// Function to populate tax table
    const table = document.getElementById("taxTable");

    const table1 = document.getElementById("taxTable1");  
  
    // Clear the table data (excluding header row)
    while (table.rows.length > 1) {
        table.deleteRow(1);
    }
    while (table1.rows.length > 1) {
        table1.deleteRow(1);
    }                  
                  
    } else  if ( textbox10.value >=1994 ) { 
    textbox4.value = "";
    textbox3.value = "";
    textbox8.value = ""; 
    textbox6.value = "";           
// Function to populate tax table
    const table = document.getElementById("taxTable");

    const table1 = document.getElementById("taxTable1");  
  
    // Clear the table data (excluding header row)
    while (table.rows.length > 1) {
        table.deleteRow(1);
    }
    while (table1.rows.length > 1) {
        table1.deleteRow(1);
    }                   
                                    
                  
} 
  
// ------------------------------
      
    textbox5.value = caption; 

}           
        
</script>                   
                  
                  
                  
<script> 
function show4() {
    var textbox11 = document.getElementById("textbox11");
    var textbox1 = document.getElementById("textbox1");   
    const textbox4 = document.getElementById("textbox4");    
    var textbox3 = document.getElementById("textbox3");
    var textbox8 = document.getElementById("textbox8");         
    var textbox6 = document.getElementById("textbox6");
    var textbox14 = document.getElementById("textbox14");   
    let caption = "";
  
    if ( textbox14.value === "-- اختر من القائمة الحالة الإجتماعية --" ) {      
    textbox4.value = "";
    textbox3.value = "";
    textbox8.value = ""; 
    textbox6.value = "";           
// Function to populate tax table
    const table = document.getElementById("taxTable");

    const table1 = document.getElementById("taxTable1");  
  
    // Clear the table data (excluding header row)
    while (table.rows.length > 1) {
        table.deleteRow(1);
    }
    while (table1.rows.length > 1) {
        table1.deleteRow(1);
    }                  
                  
    } else  if ( textbox14.value === "أعزب" ) {      
    textbox4.value = "";
    textbox3.value = "";
    textbox8.value = ""; 
    textbox6.value = "";           
// Function to populate tax table
    const table = document.getElementById("taxTable");

    const table1 = document.getElementById("taxTable1");  
  
    // Clear the table data (excluding header row)
    while (table.rows.length > 1) {
        table.deleteRow(1);
    }
    while (table1.rows.length > 1) {
        table1.deleteRow(1);
    }                   
 
      
    } else  if ( textbox14.value === "متزوج ولا يعول أولاد" ) {      
    textbox4.value = "";
    textbox3.value = "";
    textbox8.value = ""; 
    textbox6.value = "";           
// Function to populate tax table
    const table = document.getElementById("taxTable");

    const table1 = document.getElementById("taxTable1");  
  
    // Clear the table data (excluding header row)
    while (table.rows.length > 1) {
        table.deleteRow(1);
    }
    while (table1.rows.length > 1) {
        table1.deleteRow(1);
    }      
      

      
    } else  if ( textbox14.value === "غير متزوج ويعول ولدا أو أكثر" ) {      
    textbox4.value = "";
    textbox3.value = "";
    textbox8.value = ""; 
    textbox6.value = "";           
// Function to populate tax table
    const table = document.getElementById("taxTable");

    const table1 = document.getElementById("taxTable1");  
  
    // Clear the table data (excluding header row)
    while (table.rows.length > 1) {
        table.deleteRow(1);
    }
    while (table1.rows.length > 1) {
        table1.deleteRow(1);
    }      
      
    } else  if ( textbox14.value === "متزوج ويعول ولدا أو أكثر" ) {      
    textbox4.value = "";
    textbox3.value = "";
    textbox8.value = ""; 
    textbox6.value = "";           
// Function to populate tax table
    const table = document.getElementById("taxTable");

    const table1 = document.getElementById("taxTable1");  
  
    // Clear the table data (excluding header row)
    while (table.rows.length > 1) {
        table.deleteRow(1);
    }
    while (table1.rows.length > 1) {
        table1.deleteRow(1);
    }      
                  
} 
  
// ------------------------------
      
    textbox5.value = caption; 

}           
        
</script> 
                  
                  
                  
<script> 
function show5() {
    var textbox11 = document.getElementById("textbox11");
    var textbox1 = document.getElementById("textbox1");   
    var textbox10 = document.getElementById("textbox10");
    var textbox13 = document.getElementById("textbox13");
    var textbox3 = document.getElementById("textbox3");
    var textbox8 = document.getElementById("textbox8");         
    var textbox6 = document.getElementById("textbox6"); 

    let caption = "";
  
    if ( textbox13.value === "-- اختر من القائمة نوع المحاسبة --" ) {            
    textbox3.value = "";
    textbox8.value = ""; 
    textbox6.value = "";           
                 
                  
    } else  if ( textbox13.value === "تقديري غير مؤيد بمستندات" ) {      
    textbox3.value = "";
    textbox8.value = ""; 
    textbox6.value = "";          

      

    } else  if ( textbox13.value === "دفتري ووارد بالعينة" ) {      
    textbox3.value = "";
    textbox8.value = ""; 
    textbox6.value = "";          
       
            
                  
} 
  
// ------------------------------
      
    textbox5.value = caption; 
  
       }           
        
</script>                   
                  
                  
                  
<script> 
function show6() {
    var textbox11 = document.getElementById("textbox11");
    var textbox1 = document.getElementById("textbox1");   
    var textbox10 = document.getElementById("textbox10");
    const textbox4 = document.getElementById("textbox4");  
    var textbox13 = document.getElementById("textbox13");
    var textbox3 = document.getElementById("textbox3");
    var textbox8 = document.getElementById("textbox8");         
    var textbox6 = document.getElementById("textbox6"); 

    let caption = "";
  
    if ( textbox3.value === "" ) {
    textbox8.value = ""; 
    textbox6.value = "";           
                 
                  
    } else  if ( textbox3.value ==="0" ) {      
    textbox8.value = ""; 
    textbox6.value = "";           
                  
                  
                  
                  
} 
  
// ------------------------------
      
    textbox5.value = caption; 
  
       }           
        
</script>                   
                  
                  
<script> 
function show7() {
    var textbox11 = document.getElementById("textbox11");
    var textbox1 = document.getElementById("textbox1");   
    var textbox10 = document.getElementById("textbox10");
    const textbox4 = document.getElementById("textbox4");  
    var textbox13 = document.getElementById("textbox13");
    var textbox3 = document.getElementById("textbox3");
    var textbox9 = document.getElementById("textbox9");      
    var textbox8 = document.getElementById("textbox8");         
    var textbox6 = document.getElementById("textbox6"); 

    let caption = "";
  
    if ( textbox9.value === "-- اختر من القائمة أساس الربط --" ) {     
    textbox8.value = ""; 
    textbox6.value = "";           
                 
                  
    } else  if ( textbox9.value === "عدم طعن" ) {          
    textbox8.value = ""; 
    textbox6.value = "";           
                   
                  
    } else  if ( textbox9.value === "لجنة داخلية" ) {          
    textbox8.value = ""; 
    textbox6.value = "";           
 
      
    } else  if ( textbox9.value === "لجنة داخلية متخصصة" ) {          
    textbox8.value = ""; 
    textbox6.value = "";           
       
 
    } else  if ( textbox9.value === "لجنة طعن" ) {          
    textbox8.value = ""; 
    textbox6.value = "";           
     
      
    } else  if ( textbox9.value === "حكم محكمة" ) {          
    textbox8.value = ""; 
    textbox6.value = "";           
      
                  
} 
  
// ------------------------------
      
    textbox5.value = caption; 
  
       }           
        
</script>                 
                  


    <script>
        function calculateTaxFromInspection() {
          
    const textbox1 = document.getElementById("textbox1");
    const textbox3 = document.getElementById("textbox3");
    const textbox10 = document.getElementById("textbox10"); 
    const textbox9 = document.getElementById("textbox9");        
    const textbox8 = document.getElementById("textbox8"); 
    const textbox6 = document.getElementById("textbox6");             
    const textbox11 = document.getElementById("textbox11"); 
    const textbox12 = document.getElementById("textbox12");
    const textbox13 = document.getElementById("textbox13");            
    const textbox14 = document.getElementById("textbox14");
          
// عند الضغط علي مفتاح حساب الضريبة ينفذ الأمر التالي           
  textbox3.value = ""           
  textbox6.value = "" 
  textbox8.value = ""          
          
    let income = parseFloat(textbox1.value);
    let income1 = parseFloat(income.value);
          
    if (textbox11.value === "-- اختر من القائمة الكيان القانوني --") {
    let caption = "يرجي إختيار الكيان القانوني";
    showPopup(caption, 'error');      
    textbox11.focus();
    return;
      
    }
          
    if ( textbox11.value === "شركات | شركات الأشخاص" && textbox1.value === "" ) { 
    let caption = "يرجي إدخال صافي الدخل الخاضع للضريبة لكل شريك علي حدة ( إدخال الأرقام باللغة الإنجليزية )";
    showPopup(caption, 'error');      
    textbox1.value = "";               
    textbox1.focus();
    return;
    }          
          
    if (textbox1.value === "") {      
    let caption = "يرجي إدخال صافي الدخل الخاضع للضريبة ( إدخال الأرقام باللغة الإنجليزية )";
    showPopup(caption, 'error');      
    textbox1.value = "";               
    textbox1.focus();
    return;

    }
 
          
    if (textbox14.value === "-- اختر من القائمة الحالة الإجتماعية --") {
    let caption = "يرجي إختيار الحالة الإجتماعية";
    showPopup(caption, 'error');       
    textbox14.focus();
    return;
      
    }          
          
    if (textbox10.value === "-- اختر من القائمة السنة الضريبية --") {
    let caption = "يرجي إختيار السنة الضرييبة";
    showPopup(caption, 'error');      
    textbox10.focus();
    return;
      
    }
          
          
    let tax = 0;

    let caption = "";
          
function populateTaxTable() {
    const table = document.getElementById("taxTable");
    if (table) {
        table.parentNode.removeChild(table); // Remove the table from its parent node
    }
}
          
function populateTaxTable1() {
    const table1 = document.getElementById("taxTable1");
    if (table1) {
        table1.parentNode.removeChild(table1); // Remove the table from its parent node
    }
}
          
          
                         
    if ( textbox11.value === "أفراد | أشخاص طبيعية" && textbox10.value <=1997 && textbox14.value === "أعزب" && textbox1.value >=1440 ) {
    income1 = income - 1440
    if (income1 <= 2500) {
    tax = income1 * 20 / 100;
    } else if (income1 <= 7000) {
    tax =  2500 * 20 / 100 + (income1 - 2500) * 27 / 100;
    } else if (income1 <= 16000) {
    tax = 2500 * 20 / 100 + 4500 * 27 / 100 + (income1 - 7000) * 35 / 100;
    } else if (income1 <= 27000) {
    tax = 2500 * 20 / 100 + 4500 * 27 / 100 + 9000 * 35 / 100 + (income1 - 16000) * 40 / 100;      
    } else if (income1 <= 68000) {
    tax =  2500 * 20 / 100 + 4500 * 27 / 100 + 9000 * 35 / 100 + 11000 * 40 / 100 + (income1 - 27000) * 45 / 100; 
    } else {
    tax = 27715 + (income1 - 68000) * 48 / 100;
    }            
   let caption = "تم حساب الضريبة بنجاح ! " + "الكيان القانوني : " + ( textbox11.value ) + "  " + " صافي الدخل الخاضع للضريبة : " + ( textbox1.value ) + " جنية " + " " + "السنة الضريبية : " + ( textbox10.value ) + " " + " الضريبة المستحقة : " + ( tax ) + " جنية ";
    showPopup( caption, 'info'); 
  
// Define tax brackets
let netIncome = income1; // هذا مبلغ الدخل الصافي الذي ترغب في حساب الضريبة عليه

let taxBrackets;

if (netIncome <= 2500) {
  taxBrackets = [
    { minIncome: 1, maxIncome: income1, taxRate: 20, fixedTax: income1 * 20 / 100 }
  ];
} else if (netIncome <= 7000) {
  taxBrackets = [
    { minIncome: 1, maxIncome: 2500, taxRate: 20, fixedTax: 2500 * 20 / 100 },
    { minIncome: 2, maxIncome: income1 - 2500, taxRate: 27, fixedTax: (income1 - 2500) * 27 / 100 }
  ];
} else if (netIncome <= 16000) {
  taxBrackets = [
    { minIncome: 1, maxIncome: 2500, taxRate: 20, fixedTax: 2500 * 20 / 100 },
    { minIncome: 2, maxIncome: 4500, taxRate: 27, fixedTax: 4500 * 27 / 100 },
    { minIncome: 3, maxIncome: income1 - 7000, taxRate: 35, fixedTax: (income1 - 7000) * 35 / 100 }
  ];
} else if (netIncome <= 27000) {
  taxBrackets = [
    { minIncome: 1, maxIncome: 2500, taxRate: 20, fixedTax: 2500 * 20 / 100 },
    { minIncome: 2, maxIncome: 4500, taxRate: 27, fixedTax: 4500 * 27 / 100 },
    { minIncome: 3, maxIncome: 9000, taxRate: 35, fixedTax: 9000 * 35 / 100 },   
    { minIncome: 4, maxIncome: income1 - 16000, taxRate: 40, fixedTax: (income1 - 16000) * 40 / 100 }
  ]; 
} else if (netIncome <= 68000) {
  taxBrackets = [
    { minIncome: 1, maxIncome: 2500, taxRate: 20, fixedTax: 2500 * 20 / 100 },
    { minIncome: 2, maxIncome: 4500, taxRate: 27, fixedTax: 4500 * 27 / 100 },
    { minIncome: 3, maxIncome: 9000, taxRate: 35, fixedTax: 9000 * 35 / 100 },
    { minIncome: 4, maxIncome: 11000, taxRate: 40, fixedTax: 11000 * 40 / 100 },    
    { minIncome: 5, maxIncome: income1 - 27000, taxRate: 45, fixedTax: (income1 - 27000) * 45 / 100 }
  ];   
} else {
  taxBrackets = [
    { minIncome: 1, maxIncome: 2500, taxRate: 20, fixedTax: 2500 * 20 / 100 },
    { minIncome: 2, maxIncome: 4500, taxRate: 27, fixedTax: 4500 * 27 / 100 },
    { minIncome: 3, maxIncome: 9000, taxRate: 35, fixedTax: 9000 * 35 / 100 },
    { minIncome: 4, maxIncome: 11000, taxRate: 40, fixedTax: 11000 * 40 / 100 },
    { minIncome: 5, maxIncome: 41000, taxRate: 45, fixedTax: 41000 * 45 / 100 },     
    { minIncome: 6, maxIncome: income1 - 68000, taxRate: 48, fixedTax: (income1 - 68000) * 48 / 100 }
  ];
}
  
console.log(taxBrackets);
// Function to populate tax table
function populateTaxTable() {
    const table = document.getElementById("taxTable");

    const table1 = document.getElementById("taxTable1");  
  
    // Clear the table data (excluding header row)
    while (table.rows.length > 1) {
        table.deleteRow(1);
    }
    while (table1.rows.length > 1) {
        table1.deleteRow(1);
    }

    // Populate the table with new data
    taxBrackets.forEach(bracket => {
        const row = table.insertRow(-1);
        const minIncomeCell = row.insertCell(0);
        const maxIncomeCell = row.insertCell(1);
        const taxRateCell = row.insertCell(2);
        const taxDueCell = row.insertCell(3);
        const remainingIncomeCell = row.insertCell(4); // Added cell for remaining income
        
        minIncomeCell.textContent = bracket.minIncome.toLocaleString(); // Display minimum income
        maxIncomeCell.textContent = bracket.maxIncome === Infinity ? "Infinity" : bracket.maxIncome.toLocaleString(); // Display maximum income
        taxRateCell.textContent = bracket.taxRate + "%"; // Display tax rate
        taxDueCell.textContent = bracket.fixedTax.toLocaleString(); // Display fixed tax amount
        const remainingIncome = bracket.maxIncome === Infinity ? 0 : bracket.maxIncome - bracket.fixedTax; // Calculate remaining income
        remainingIncomeCell.textContent = remainingIncome.toLocaleString(); // Display remaining income
    });
}


// Call the function to populate the tax table
populateTaxTable();        


// جدول الأعباء العائلية  
// Define tax brackets
let netIncome1 = income1; // هذا مبلغ الدخل الصافي الذي ترغب في حساب الضريبة عليه

let taxBrackets1;

if (netIncome1 <= 2500) {
  taxBrackets1 = [
    { minIncome: 1, maxIncome: textbox14.value, taxRate: -1440, fixedTax: income1 }
  ];
} else if (netIncome1 <= 7000) {
  taxBrackets1 = [
    { minIncome: 1, maxIncome: textbox14.value, taxRate: -1440, fixedTax: income1 }
  ];
} else if (netIncome1 <= 16000) {
  taxBrackets1 = [
    { minIncome: 1, maxIncome: textbox14.value, taxRate: -1440, fixedTax: income1 }
  ];
} else if (netIncome1 <= 27000) {
  taxBrackets1 = [
    { minIncome: 1, maxIncome: textbox14.value, taxRate: -1440, fixedTax: income1 }    
  ];
} else if (netIncome1 <= 68000) {
  taxBrackets1 = [
    { minIncome: 1, maxIncome: textbox14.value, taxRate: -1440, fixedTax: income1 }    
  ];  
} else {
  taxBrackets1 = [
    { minIncome: 1, maxIncome: textbox14.value, taxRate: -1440, fixedTax: income1 }
  ];
}

console.log(taxBrackets1);
// Function to populate tax table
function populateTaxTable1() {

    const table1 = document.getElementById("taxTable1");  
  
    // Clear the table data (excluding header row)
    while (table1.rows.length > 1) {
        table1.deleteRow(1);
    }

    // Populate the table with new data
    taxBrackets1.forEach(bracket1 => {
        const row = table1.insertRow(-1);
        const minIncomeCell = row.insertCell(0);
        const maxIncomeCell = row.insertCell(1);
        const taxRateCell = row.insertCell(2);
        const taxDueCell = row.insertCell(3);
        const remainingIncomeCell = row.insertCell(4); // Added cell for remaining income
        
        minIncomeCell.textContent = bracket1.minIncome.toLocaleString(); // Display minimum income
        maxIncomeCell.textContent = bracket1.maxIncome === Infinity ? "Infinity" : bracket1.maxIncome.toLocaleString(); // Display maximum income
        taxRateCell.textContent = bracket1.taxRate + ""; // Display tax rate
        taxDueCell.textContent = bracket1.fixedTax.toLocaleString(); // Display fixed tax amount
        const remainingIncome = bracket1.maxIncome === Infinity ? 0 : bracket1.maxIncome - bracket1.fixedTax; // Calculate remaining income
    });
}


// Call the function to populate the tax table
populateTaxTable1();       
      

} else  if ( textbox11.value === "أفراد | أشخاص طبيعية" && textbox10.value <=1997 && textbox14.value === "أعزب" && textbox1.value < 1440 ) {
   let caption = "عفوا صافي الدخل الخاضع للضريبة لم يتجاوز حد الإعفاء للأعباء العائلية المقررة قانونا للحالة الإجتماعية :" + " " + textbox14.value + " " + "وهي " + "1440 جنية " + " " + "وفقا لقانون 187 لسنة 1993";
    showPopup( caption, 'error'); 
    textbox8.value = "";
    textbox6.value = "";         
    textbox3.value = "";
    textbox4.value = "";
// Function to populate tax table
    const table = document.getElementById("taxTable");

    const table1 = document.getElementById("taxTable1");  
  
    // Clear the table data (excluding header row)
    while (table.rows.length > 1) {
        table.deleteRow(1);
    }
    while (table1.rows.length > 1) {
        table1.deleteRow(1);
    }
    return;  
  
  
      
} else  if ( textbox11.value === "أفراد | أشخاص طبيعية" && textbox10.value <=1997 && textbox14.value === "متزوج ولا يعول أولاد" && textbox1.value >=1680 ) {
    income1 = income - 1680
    if (income1 <= 2500) {
    tax = income1 * 20 / 100;
    } else if (income1 <= 7000) {
    tax =  2500 * 20 / 100 + (income1 - 2500) * 27 / 100;
    } else if (income1 <= 16000) {
    tax = 2500 * 20 / 100 + 4500 * 27 / 100 + (income1 - 7000) * 35 / 100;
    } else if (income1 <= 27000) {
    tax = 2500 * 20 / 100 + 4500 * 27 / 100 + 9000 * 35 / 100 + (income1 - 16000) * 40 / 100;      
    } else if (income1 <= 68000) {
    tax =  2500 * 20 / 100 + 4500 * 27 / 100 + 9000 * 35 / 100 + 11000 * 40 / 100 + (income1 - 27000) * 45 / 100; 
    } else {
    tax = 27715 + (income1 - 68000) * 48 / 100;
    }            
   let caption = "تم حساب الضريبة بنجاح ! " + "الكيان القانوني : " + ( textbox11.value ) + "  " + " صافي الدخل الخاضع للضريبة : " + ( textbox1.value ) + " جنية " + " " + "السنة الضريبية : " + ( textbox10.value ) + " " + " الضريبة المستحقة : " + ( tax ) + " جنية ";
    showPopup( caption, 'info');   
  
// Define tax brackets
let netIncome = income1; // هذا مبلغ الدخل الصافي الذي ترغب في حساب الضريبة عليه

let taxBrackets;

if (netIncome <= 2500) {
  taxBrackets = [
    { minIncome: 1, maxIncome: income1, taxRate: 20, fixedTax: income1 * 20 / 100 }
  ];
} else if (netIncome <= 7000) {
  taxBrackets = [
    { minIncome: 1, maxIncome: 2500, taxRate: 20, fixedTax: 2500 * 20 / 100 },
    { minIncome: 2, maxIncome: income1 - 2500, taxRate: 27, fixedTax: (income1 - 2500) * 27 / 100 }
  ];
} else if (netIncome <= 16000) {
  taxBrackets = [
    { minIncome: 1, maxIncome: 2500, taxRate: 20, fixedTax: 2500 * 20 / 100 },
    { minIncome: 2, maxIncome: 4500, taxRate: 27, fixedTax: 4500 * 27 / 100 },
    { minIncome: 3, maxIncome: income1 - 7000, taxRate: 35, fixedTax: (income1 - 7000) * 35 / 100 }
  ];
} else if (netIncome <= 27000) {
  taxBrackets = [
    { minIncome: 1, maxIncome: 2500, taxRate: 20, fixedTax: 2500 * 20 / 100 },
    { minIncome: 2, maxIncome: 4500, taxRate: 27, fixedTax: 4500 * 27 / 100 },
    { minIncome: 3, maxIncome: 9000, taxRate: 35, fixedTax: 9000 * 35 / 100 },   
    { minIncome: 4, maxIncome: income1 - 16000, taxRate: 40, fixedTax: (income1 - 16000) * 40 / 100 }
  ]; 
} else if (netIncome <= 68000) {
  taxBrackets = [
    { minIncome: 1, maxIncome: 2500, taxRate: 20, fixedTax: 2500 * 20 / 100 },
    { minIncome: 2, maxIncome: 4500, taxRate: 27, fixedTax: 4500 * 27 / 100 },
    { minIncome: 3, maxIncome: 9000, taxRate: 35, fixedTax: 9000 * 35 / 100 },
    { minIncome: 4, maxIncome: 11000, taxRate: 40, fixedTax: 11000 * 40 / 100 },    
    { minIncome: 5, maxIncome: income1 - 27000, taxRate: 45, fixedTax: (income1 - 27000) * 45 / 100 }
  ];   
} else {
  taxBrackets = [
    { minIncome: 1, maxIncome: 2500, taxRate: 20, fixedTax: 2500 * 20 / 100 },
    { minIncome: 2, maxIncome: 4500, taxRate: 27, fixedTax: 4500 * 27 / 100 },
    { minIncome: 3, maxIncome: 9000, taxRate: 35, fixedTax: 9000 * 35 / 100 },
    { minIncome: 4, maxIncome: 11000, taxRate: 40, fixedTax: 11000 * 40 / 100 },
    { minIncome: 5, maxIncome: 41000, taxRate: 45, fixedTax: 41000 * 45 / 100 },     
    { minIncome: 6, maxIncome: income1 - 68000, taxRate: 48, fixedTax: (income1 - 68000) * 48 / 100 }
  ];
}
  
console.log(taxBrackets);
// Function to populate tax table
function populateTaxTable() {
    const table = document.getElementById("taxTable");

    const table1 = document.getElementById("taxTable1");  
  
    // Clear the table data (excluding header row)
    while (table.rows.length > 1) {
        table.deleteRow(1);
    }
    while (table1.rows.length > 1) {
        table1.deleteRow(1);
    }

    // Populate the table with new data
    taxBrackets.forEach(bracket => {
        const row = table.insertRow(-1);
        const minIncomeCell = row.insertCell(0);
        const maxIncomeCell = row.insertCell(1);
        const taxRateCell = row.insertCell(2);
        const taxDueCell = row.insertCell(3);
        const remainingIncomeCell = row.insertCell(4); // Added cell for remaining income
        
        minIncomeCell.textContent = bracket.minIncome.toLocaleString(); // Display minimum income
        maxIncomeCell.textContent = bracket.maxIncome === Infinity ? "Infinity" : bracket.maxIncome.toLocaleString(); // Display maximum income
        taxRateCell.textContent = bracket.taxRate + "%"; // Display tax rate
        taxDueCell.textContent = bracket.fixedTax.toLocaleString(); // Display fixed tax amount
        const remainingIncome = bracket.maxIncome === Infinity ? 0 : bracket.maxIncome - bracket.fixedTax; // Calculate remaining income
        remainingIncomeCell.textContent = remainingIncome.toLocaleString(); // Display remaining income
    });
}


// Call the function to populate the tax table
populateTaxTable();        


// جدول الأعباء العائلية  
// Define tax brackets
let netIncome1 = income1; // هذا مبلغ الدخل الصافي الذي ترغب في حساب الضريبة عليه

let taxBrackets1;

if (netIncome1 <= 2500) {
  taxBrackets1 = [
    { minIncome: 1, maxIncome: textbox14.value, taxRate: -1680, fixedTax: income1 }
  ];
} else if (netIncome1 <= 7000) {
  taxBrackets1 = [
    { minIncome: 1, maxIncome: textbox14.value, taxRate: -1680, fixedTax: income1 }
  ];
} else if (netIncome1 <= 16000) {
  taxBrackets1 = [
    { minIncome: 1, maxIncome: textbox14.value, taxRate: -1680, fixedTax: income1 }
  ];
} else if (netIncome1 <= 27000) {
  taxBrackets1 = [
    { minIncome: 1, maxIncome: textbox14.value, taxRate: -1680, fixedTax: income1 }    
  ];
} else if (netIncome1 <= 68000) {
  taxBrackets1 = [
    { minIncome: 1, maxIncome: textbox14.value, taxRate: -1680, fixedTax: income1 }    
  ];  
} else {
  taxBrackets1 = [
    { minIncome: 1, maxIncome: textbox14.value, taxRate: -1680, fixedTax: income1 }
  ];
}

console.log(taxBrackets1);
// Function to populate tax table
function populateTaxTable1() {

    const table1 = document.getElementById("taxTable1");  
  
    // Clear the table data (excluding header row)
    while (table1.rows.length > 1) {
        table1.deleteRow(1);
    }

    // Populate the table with new data
    taxBrackets1.forEach(bracket1 => {
        const row = table1.insertRow(-1);
        const minIncomeCell = row.insertCell(0);
        const maxIncomeCell = row.insertCell(1);
        const taxRateCell = row.insertCell(2);
        const taxDueCell = row.insertCell(3);
        const remainingIncomeCell = row.insertCell(4); // Added cell for remaining income
        
        minIncomeCell.textContent = bracket1.minIncome.toLocaleString(); // Display minimum income
        maxIncomeCell.textContent = bracket1.maxIncome === Infinity ? "Infinity" : bracket1.maxIncome.toLocaleString(); // Display maximum income
        taxRateCell.textContent = bracket1.taxRate + ""; // Display tax rate
        taxDueCell.textContent = bracket1.fixedTax.toLocaleString(); // Display fixed tax amount
        const remainingIncome = bracket1.maxIncome === Infinity ? 0 : bracket1.maxIncome - bracket1.fixedTax; // Calculate remaining income
    });
}


// Call the function to populate the tax table
populateTaxTable1();       
      

} else  if ( textbox11.value === "أفراد | أشخاص طبيعية" && textbox10.value <=1997 && textbox14.value === "متزوج ولا يعول أولاد" && textbox1.value < 1680 ) {
   let caption = "عفوا صافي الدخل الخاضع للضريبة لم يتجاوز حد الإعفاء للأعباء العائلية المقررة قانونا للحالة الإجتماعية :" + " " + textbox14.value + " " + "وهي " + "1680 جنية " + " " + "وفقا لقانون 187 لسنة 1993";    
    showPopup( caption, 'error'); 
    textbox8.value = "";
    textbox6.value = "";         
    textbox3.value = "";
    textbox4.value = "";
// Function to populate tax table
    const table = document.getElementById("taxTable");

    const table1 = document.getElementById("taxTable1");  
  
    // Clear the table data (excluding header row)
    while (table.rows.length > 1) {
        table.deleteRow(1);
    }
    while (table1.rows.length > 1) {
        table1.deleteRow(1);
    }
    return;   
  
      
} else  if ( textbox11.value === "أفراد | أشخاص طبيعية" && textbox10.value <=1997 && textbox14.value === "غير متزوج ويعول ولدا أو أكثر" && textbox1.value >= 1680 ) {
    income1 = income - 1680
    if (income1 <= 2500) {
    tax = income1 * 20 / 100;
    } else if (income1 <= 7000) {
    tax =  2500 * 20 / 100 + (income1 - 2500) * 27 / 100;
    } else if (income1 <= 16000) {
    tax = 2500 * 20 / 100 + 4500 * 27 / 100 + (income1 - 7000) * 35 / 100;
    } else if (income1 <= 27000) {
    tax = 2500 * 20 / 100 + 4500 * 27 / 100 + 9000 * 35 / 100 + (income1 - 16000) * 40 / 100;      
    } else if (income1 <= 68000) {
    tax =  2500 * 20 / 100 + 4500 * 27 / 100 + 9000 * 35 / 100 + 11000 * 40 / 100 + (income1 - 27000) * 45 / 100; 
    } else {
    tax = 27715 + (income1 - 68000) * 48 / 100;
    }            
   let caption = "تم حساب الضريبة بنجاح ! " + "الكيان القانوني : " + ( textbox11.value ) + "  " + " صافي الدخل الخاضع للضريبة : " + ( textbox1.value ) + " جنية " + " " + "السنة الضريبية : " + ( textbox10.value ) + " " + " الضريبة المستحقة : " + ( tax ) + " جنية ";
    showPopup( caption, 'info');  
  
// Define tax brackets
let netIncome = income1; // هذا مبلغ الدخل الصافي الذي ترغب في حساب الضريبة عليه

let taxBrackets;

if (netIncome <= 2500) {
  taxBrackets = [
    { minIncome: 1, maxIncome: income1, taxRate: 20, fixedTax: income1 * 20 / 100 }
  ];
} else if (netIncome <= 7000) {
  taxBrackets = [
    { minIncome: 1, maxIncome: 2500, taxRate: 20, fixedTax: 2500 * 20 / 100 },
    { minIncome: 2, maxIncome: income1 - 2500, taxRate: 27, fixedTax: (income1 - 2500) * 27 / 100 }
  ];
} else if (netIncome <= 16000) {
  taxBrackets = [
    { minIncome: 1, maxIncome: 2500, taxRate: 20, fixedTax: 2500 * 20 / 100 },
    { minIncome: 2, maxIncome: 4500, taxRate: 27, fixedTax: 4500 * 27 / 100 },
    { minIncome: 3, maxIncome: income1 - 7000, taxRate: 35, fixedTax: (income1 - 7000) * 35 / 100 }
  ];
} else if (netIncome <= 27000) {
  taxBrackets = [
    { minIncome: 1, maxIncome: 2500, taxRate: 20, fixedTax: 2500 * 20 / 100 },
    { minIncome: 2, maxIncome: 4500, taxRate: 27, fixedTax: 4500 * 27 / 100 },
    { minIncome: 3, maxIncome: 9000, taxRate: 35, fixedTax: 9000 * 35 / 100 },   
    { minIncome: 4, maxIncome: income1 - 16000, taxRate: 40, fixedTax: (income1 - 16000) * 40 / 100 }
  ]; 
} else if (netIncome <= 68000) {
  taxBrackets = [
    { minIncome: 1, maxIncome: 2500, taxRate: 20, fixedTax: 2500 * 20 / 100 },
    { minIncome: 2, maxIncome: 4500, taxRate: 27, fixedTax: 4500 * 27 / 100 },
    { minIncome: 3, maxIncome: 9000, taxRate: 35, fixedTax: 9000 * 35 / 100 },
    { minIncome: 4, maxIncome: 11000, taxRate: 40, fixedTax: 11000 * 40 / 100 },    
    { minIncome: 5, maxIncome: income1 - 27000, taxRate: 45, fixedTax: (income1 - 27000) * 45 / 100 }
  ];   
} else {
  taxBrackets = [
    { minIncome: 1, maxIncome: 2500, taxRate: 20, fixedTax: 2500 * 20 / 100 },
    { minIncome: 2, maxIncome: 4500, taxRate: 27, fixedTax: 4500 * 27 / 100 },
    { minIncome: 3, maxIncome: 9000, taxRate: 35, fixedTax: 9000 * 35 / 100 },
    { minIncome: 4, maxIncome: 11000, taxRate: 40, fixedTax: 11000 * 40 / 100 },
    { minIncome: 5, maxIncome: 41000, taxRate: 45, fixedTax: 41000 * 45 / 100 },     
    { minIncome: 6, maxIncome: income1 - 68000, taxRate: 48, fixedTax: (income1 - 68000) * 48 / 100 }
  ];
}
  
console.log(taxBrackets);
// Function to populate tax table
function populateTaxTable() {
    const table = document.getElementById("taxTable");

    const table1 = document.getElementById("taxTable1");  
  
    // Clear the table data (excluding header row)
    while (table.rows.length > 1) {
        table.deleteRow(1);
    }
    while (table1.rows.length > 1) {
        table1.deleteRow(1);
    }

    // Populate the table with new data
    taxBrackets.forEach(bracket => {
        const row = table.insertRow(-1);
        const minIncomeCell = row.insertCell(0);
        const maxIncomeCell = row.insertCell(1);
        const taxRateCell = row.insertCell(2);
        const taxDueCell = row.insertCell(3);
        const remainingIncomeCell = row.insertCell(4); // Added cell for remaining income
        
        minIncomeCell.textContent = bracket.minIncome.toLocaleString(); // Display minimum income
        maxIncomeCell.textContent = bracket.maxIncome === Infinity ? "Infinity" : bracket.maxIncome.toLocaleString(); // Display maximum income
        taxRateCell.textContent = bracket.taxRate + "%"; // Display tax rate
        taxDueCell.textContent = bracket.fixedTax.toLocaleString(); // Display fixed tax amount
        const remainingIncome = bracket.maxIncome === Infinity ? 0 : bracket.maxIncome - bracket.fixedTax; // Calculate remaining income
        remainingIncomeCell.textContent = remainingIncome.toLocaleString(); // Display remaining income
    });
}


// Call the function to populate the tax table
populateTaxTable();        


// جدول الأعباء العائلية  
// Define tax brackets
let netIncome1 = income1; // هذا مبلغ الدخل الصافي الذي ترغب في حساب الضريبة عليه

let taxBrackets1;

if (netIncome1 <= 2500) {
  taxBrackets1 = [
    { minIncome: 1, maxIncome: textbox14.value, taxRate: -1680, fixedTax: income1 }
  ];
} else if (netIncome1 <= 7000) {
  taxBrackets1 = [
    { minIncome: 1, maxIncome: textbox14.value, taxRate: -1680, fixedTax: income1 }
  ];
} else if (netIncome1 <= 16000) {
  taxBrackets1 = [
    { minIncome: 1, maxIncome: textbox14.value, taxRate: -1680, fixedTax: income1 }
  ];
} else if (netIncome1 <= 27000) {
  taxBrackets1 = [
    { minIncome: 1, maxIncome: textbox14.value, taxRate: -1680, fixedTax: income1 }    
  ];
} else if (netIncome1 <= 68000) {
  taxBrackets1 = [
    { minIncome: 1, maxIncome: textbox14.value, taxRate: -1680, fixedTax: income1 }    
  ];  
} else {
  taxBrackets1 = [
    { minIncome: 1, maxIncome: textbox14.value, taxRate: -1680, fixedTax: income1 }
  ];
}

console.log(taxBrackets1);
// Function to populate tax table
function populateTaxTable1() {

    const table1 = document.getElementById("taxTable1");  
  
    // Clear the table data (excluding header row)
    while (table1.rows.length > 1) {
        table1.deleteRow(1);
    }

    // Populate the table with new data
    taxBrackets1.forEach(bracket1 => {
        const row = table1.insertRow(-1);
        const minIncomeCell = row.insertCell(0);
        const maxIncomeCell = row.insertCell(1);
        const taxRateCell = row.insertCell(2);
        const taxDueCell = row.insertCell(3);
        const remainingIncomeCell = row.insertCell(4); // Added cell for remaining income
        
        minIncomeCell.textContent = bracket1.minIncome.toLocaleString(); // Display minimum income
        maxIncomeCell.textContent = bracket1.maxIncome === Infinity ? "Infinity" : bracket1.maxIncome.toLocaleString(); // Display maximum income
        taxRateCell.textContent = bracket1.taxRate + ""; // Display tax rate
        taxDueCell.textContent = bracket1.fixedTax.toLocaleString(); // Display fixed tax amount
        const remainingIncome = bracket1.maxIncome === Infinity ? 0 : bracket1.maxIncome - bracket1.fixedTax; // Calculate remaining income
    });
}


// Call the function to populate the tax table
populateTaxTable1();        


  
} else  if ( textbox11.value === "أفراد | أشخاص طبيعية" && textbox10.value <=1997 && textbox14.value === "غير متزوج ويعول ولدا أو أكثر" && textbox1.value < 1680 ) {
   let caption = "عفوا صافي الدخل الخاضع للضريبة لم يتجاوز حد الإعفاء للأعباء العائلية المقررة قانونا للحالة الإجتماعية :" + " " + textbox14.value + " " + "وهي " + "1680 جنية " + " " + "وفقا لقانون 187 لسنة 1993";
    showPopup( caption, 'error'); 
    textbox8.value = "";
    textbox6.value = "";         
    textbox3.value = "";
    textbox4.value = "";
// Function to populate tax table
    const table = document.getElementById("taxTable");

    const table1 = document.getElementById("taxTable1");  
  
    // Clear the table data (excluding header row)
    while (table.rows.length > 1) {
        table.deleteRow(1);
    }
    while (table1.rows.length > 1) {
        table1.deleteRow(1);
    }
    return;     
  
      
      
} else  if ( textbox11.value === "أفراد | أشخاص طبيعية" && textbox10.value <=1997 && textbox14.value === "متزوج ويعول ولدا أو أكثر" && textbox1.value >= 1920 ) {
    income1 = income - 1920
    if (income1 <= 2500) {
    tax = income1 * 20 / 100;
    } else if (income1 <= 7000) {
    tax =  2500 * 20 / 100 + (income1 - 2500) * 27 / 100;
    } else if (income1 <= 16000) {
    tax = 2500 * 20 / 100 + 4500 * 27 / 100 + (income1 - 7000) * 35 / 100;
    } else if (income1 <= 27000) {
    tax = 2500 * 20 / 100 + 4500 * 27 / 100 + 9000 * 35 / 100 + (income1 - 16000) * 40 / 100;      
    } else if (income1 <= 68000) {
    tax =  2500 * 20 / 100 + 4500 * 27 / 100 + 9000 * 35 / 100 + 11000 * 40 / 100 + (income1 - 27000) * 45 / 100; 
    } else {
    tax = 27715 + (income1 - 68000) * 48 / 100;
    }            
   let caption = "تم حساب الضريبة بنجاح ! " + "الكيان القانوني : " + ( textbox11.value ) + "  " + " صافي الدخل الخاضع للضريبة : " + ( textbox1.value ) + " جنية " + " " + "السنة الضريبية : " + ( textbox10.value ) + " " + " الضريبة المستحقة : " + ( tax ) + " جنية ";
    showPopup( caption, 'info');  
  
// Define tax brackets
let netIncome = income1; // هذا مبلغ الدخل الصافي الذي ترغب في حساب الضريبة عليه

let taxBrackets;

if (netIncome <= 2500) {
  taxBrackets = [
    { minIncome: 1, maxIncome: income1, taxRate: 20, fixedTax: income1 * 20 / 100 }
  ];
} else if (netIncome <= 7000) {
  taxBrackets = [
    { minIncome: 1, maxIncome: 2500, taxRate: 20, fixedTax: 2500 * 20 / 100 },
    { minIncome: 2, maxIncome: income1 - 2500, taxRate: 27, fixedTax: (income1 - 2500) * 27 / 100 }
  ];
} else if (netIncome <= 16000) {
  taxBrackets = [
    { minIncome: 1, maxIncome: 2500, taxRate: 20, fixedTax: 2500 * 20 / 100 },
    { minIncome: 2, maxIncome: 4500, taxRate: 27, fixedTax: 4500 * 27 / 100 },
    { minIncome: 3, maxIncome: income1 - 7000, taxRate: 35, fixedTax: (income1 - 7000) * 35 / 100 }
  ];
} else if (netIncome <= 27000) {
  taxBrackets = [
    { minIncome: 1, maxIncome: 2500, taxRate: 20, fixedTax: 2500 * 20 / 100 },
    { minIncome: 2, maxIncome: 4500, taxRate: 27, fixedTax: 4500 * 27 / 100 },
    { minIncome: 3, maxIncome: 9000, taxRate: 35, fixedTax: 9000 * 35 / 100 },   
    { minIncome: 4, maxIncome: income1 - 16000, taxRate: 40, fixedTax: (income1 - 16000) * 40 / 100 }
  ]; 
} else if (netIncome <= 68000) {
  taxBrackets = [
    { minIncome: 1, maxIncome: 2500, taxRate: 20, fixedTax: 2500 * 20 / 100 },
    { minIncome: 2, maxIncome: 4500, taxRate: 27, fixedTax: 4500 * 27 / 100 },
    { minIncome: 3, maxIncome: 9000, taxRate: 35, fixedTax: 9000 * 35 / 100 },
    { minIncome: 4, maxIncome: 11000, taxRate: 40, fixedTax: 11000 * 40 / 100 },    
    { minIncome: 5, maxIncome: income1 - 27000, taxRate: 45, fixedTax: (income1 - 27000) * 45 / 100 }
  ];   
} else {
  taxBrackets = [
    { minIncome: 1, maxIncome: 2500, taxRate: 20, fixedTax: 2500 * 20 / 100 },
    { minIncome: 2, maxIncome: 4500, taxRate: 27, fixedTax: 4500 * 27 / 100 },
    { minIncome: 3, maxIncome: 9000, taxRate: 35, fixedTax: 9000 * 35 / 100 },
    { minIncome: 4, maxIncome: 11000, taxRate: 40, fixedTax: 11000 * 40 / 100 },
    { minIncome: 5, maxIncome: 41000, taxRate: 45, fixedTax: 41000 * 45 / 100 },     
    { minIncome: 6, maxIncome: income1 - 68000, taxRate: 48, fixedTax: (income1 - 68000) * 48 / 100 }
  ];
}
  
console.log(taxBrackets);
// Function to populate tax table
function populateTaxTable() {
    const table = document.getElementById("taxTable");

    const table1 = document.getElementById("taxTable1");  
  
    // Clear the table data (excluding header row)
    while (table.rows.length > 1) {
        table.deleteRow(1);
    }
    while (table1.rows.length > 1) {
        table1.deleteRow(1);
    }

    // Populate the table with new data
    taxBrackets.forEach(bracket => {
        const row = table.insertRow(-1);
        const minIncomeCell = row.insertCell(0);
        const maxIncomeCell = row.insertCell(1);
        const taxRateCell = row.insertCell(2);
        const taxDueCell = row.insertCell(3);
        const remainingIncomeCell = row.insertCell(4); // Added cell for remaining income
        
        minIncomeCell.textContent = bracket.minIncome.toLocaleString(); // Display minimum income
        maxIncomeCell.textContent = bracket.maxIncome === Infinity ? "Infinity" : bracket.maxIncome.toLocaleString(); // Display maximum income
        taxRateCell.textContent = bracket.taxRate + "%"; // Display tax rate
        taxDueCell.textContent = bracket.fixedTax.toLocaleString(); // Display fixed tax amount
        const remainingIncome = bracket.maxIncome === Infinity ? 0 : bracket.maxIncome - bracket.fixedTax; // Calculate remaining income
        remainingIncomeCell.textContent = remainingIncome.toLocaleString(); // Display remaining income
    });
}


// Call the function to populate the tax table
populateTaxTable();        


// جدول الأعباء العائلية  
// Define tax brackets
let netIncome1 = income1; // هذا مبلغ الدخل الصافي الذي ترغب في حساب الضريبة عليه

let taxBrackets1;

if (netIncome1 <= 2500) {
  taxBrackets1 = [
    { minIncome: 1, maxIncome: textbox14.value, taxRate: -1920, fixedTax: income1 }
  ];
} else if (netIncome1 <= 7000) {
  taxBrackets1 = [
    { minIncome: 1, maxIncome: textbox14.value, taxRate: -1920, fixedTax: income1 }
  ];
} else if (netIncome1 <= 16000) {
  taxBrackets1 = [
    { minIncome: 1, maxIncome: textbox14.value, taxRate: -1920, fixedTax: income1 }
  ];
} else if (netIncome1 <= 27000) {
  taxBrackets1 = [
    { minIncome: 1, maxIncome: textbox14.value, taxRate: -1920, fixedTax: income1 }    
  ];
} else if (netIncome1 <= 68000) {
  taxBrackets1 = [
    { minIncome: 1, maxIncome: textbox14.value, taxRate: -1920, fixedTax: income1 }    
  ];  
} else {
  taxBrackets1 = [
    { minIncome: 1, maxIncome: textbox14.value, taxRate: -1920, fixedTax: income1 }
  ];
}

console.log(taxBrackets1);
// Function to populate tax table
function populateTaxTable1() {

    const table1 = document.getElementById("taxTable1");  
  
    // Clear the table data (excluding header row)
    while (table1.rows.length > 1) {
        table1.deleteRow(1);
    }

    // Populate the table with new data
    taxBrackets1.forEach(bracket1 => {
        const row = table1.insertRow(-1);
        const minIncomeCell = row.insertCell(0);
        const maxIncomeCell = row.insertCell(1);
        const taxRateCell = row.insertCell(2);
        const taxDueCell = row.insertCell(3);
        const remainingIncomeCell = row.insertCell(4); // Added cell for remaining income
        
        minIncomeCell.textContent = bracket1.minIncome.toLocaleString(); // Display minimum income
        maxIncomeCell.textContent = bracket1.maxIncome === Infinity ? "Infinity" : bracket1.maxIncome.toLocaleString(); // Display maximum income
        taxRateCell.textContent = bracket1.taxRate + ""; // Display tax rate
        taxDueCell.textContent = bracket1.fixedTax.toLocaleString(); // Display fixed tax amount
        const remainingIncome = bracket1.maxIncome === Infinity ? 0 : bracket1.maxIncome - bracket1.fixedTax; // Calculate remaining income
    });
}


// Call the function to populate the tax table
populateTaxTable1();        
      
      

} else  if ( textbox11.value === "أفراد | أشخاص طبيعية" && textbox10.value <=1997 && textbox14.value === "متزوج ويعول ولدا أو أكثر" && textbox1.value < 1920 ) {
   let caption = "عفوا صافي الدخل الخاضع للضريبة لم يتجاوز حد الإعفاء للأعباء العائلية المقررة قانونا للحالة الإجتماعية :" + " " + textbox14.value + " " + "وهي " + "1920 جنية " + " " + "وفقا لقانون 187 لسنة 1993";
    showPopup( caption, 'error'); 
    textbox8.value = "";
    textbox6.value = "";         
    textbox3.value = "";
    textbox4.value = "";
// Function to populate tax table
    const table = document.getElementById("taxTable");

    const table1 = document.getElementById("taxTable1");  
  
    // Clear the table data (excluding header row)
    while (table.rows.length > 1) {
        table.deleteRow(1);
    }
    while (table1.rows.length > 1) {
        table1.deleteRow(1);
    }
    return;   
  
  
  
  
            
} else if ( textbox11.value === "شركات | شركات الأشخاص" && textbox10.value <=1997 && textbox14.value === "أعزب" && textbox1.value >=1440 ) {
    income1 = income - 1440
    if (income1 <= 2500) {
    tax = income1 * 20 / 100;
    } else if (income1 <= 7000) {
    tax =  2500 * 20 / 100 + (income1 - 2500) * 27 / 100;
    } else if (income1 <= 16000) {
    tax = 2500 * 20 / 100 + 4500 * 27 / 100 + (income1 - 7000) * 35 / 100;
    } else if (income1 <= 27000) {
    tax = 2500 * 20 / 100 + 4500 * 27 / 100 + 9000 * 35 / 100 + (income1 - 16000) * 40 / 100;      
    } else if (income1 <= 68000) {
    tax =  2500 * 20 / 100 + 4500 * 27 / 100 + 9000 * 35 / 100 + 11000 * 40 / 100 + (income1 - 27000) * 45 / 100; 
    } else {
    tax = 27715 + (income1 - 68000) * 48 / 100;
    }            
   let caption = "تم حساب الضريبة بنجاح ! " + "الكيان القانوني : " + ( textbox11.value ) + "  " + " صافي الدخل الخاضع للضريبة : " + ( textbox1.value ) + " جنية " + " " + "السنة الضريبية : " + ( textbox10.value ) + " " + " الضريبة المستحقة : " + ( tax ) + " جنية ";
    showPopup( caption, 'info');   
  
// Define tax brackets
let netIncome = income1; // هذا مبلغ الدخل الصافي الذي ترغب في حساب الضريبة عليه

let taxBrackets;

if (netIncome <= 2500) {
  taxBrackets = [
    { minIncome: 1, maxIncome: income1, taxRate: 20, fixedTax: income1 * 20 / 100 }
  ];
} else if (netIncome <= 7000) {
  taxBrackets = [
    { minIncome: 1, maxIncome: 2500, taxRate: 20, fixedTax: 2500 * 20 / 100 },
    { minIncome: 2, maxIncome: income1 - 2500, taxRate: 27, fixedTax: (income1 - 2500) * 27 / 100 }
  ];
} else if (netIncome <= 16000) {
  taxBrackets = [
    { minIncome: 1, maxIncome: 2500, taxRate: 20, fixedTax: 2500 * 20 / 100 },
    { minIncome: 2, maxIncome: 4500, taxRate: 27, fixedTax: 4500 * 27 / 100 },
    { minIncome: 3, maxIncome: income1 - 7000, taxRate: 35, fixedTax: (income1 - 7000) * 35 / 100 }
  ];
} else if (netIncome <= 27000) {
  taxBrackets = [
    { minIncome: 1, maxIncome: 2500, taxRate: 20, fixedTax: 2500 * 20 / 100 },
    { minIncome: 2, maxIncome: 4500, taxRate: 27, fixedTax: 4500 * 27 / 100 },
    { minIncome: 3, maxIncome: 9000, taxRate: 35, fixedTax: 9000 * 35 / 100 },   
    { minIncome: 4, maxIncome: income1 - 16000, taxRate: 40, fixedTax: (income1 - 16000) * 40 / 100 }
  ]; 
} else if (netIncome <= 68000) {
  taxBrackets = [
    { minIncome: 1, maxIncome: 2500, taxRate: 20, fixedTax: 2500 * 20 / 100 },
    { minIncome: 2, maxIncome: 4500, taxRate: 27, fixedTax: 4500 * 27 / 100 },
    { minIncome: 3, maxIncome: 9000, taxRate: 35, fixedTax: 9000 * 35 / 100 },
    { minIncome: 4, maxIncome: 11000, taxRate: 40, fixedTax: 11000 * 40 / 100 },    
    { minIncome: 5, maxIncome: income1 - 27000, taxRate: 45, fixedTax: (income1 - 27000) * 45 / 100 }
  ];   
} else {
  taxBrackets = [
    { minIncome: 1, maxIncome: 2500, taxRate: 20, fixedTax: 2500 * 20 / 100 },
    { minIncome: 2, maxIncome: 4500, taxRate: 27, fixedTax: 4500 * 27 / 100 },
    { minIncome: 3, maxIncome: 9000, taxRate: 35, fixedTax: 9000 * 35 / 100 },
    { minIncome: 4, maxIncome: 11000, taxRate: 40, fixedTax: 11000 * 40 / 100 },
    { minIncome: 5, maxIncome: 41000, taxRate: 45, fixedTax: 41000 * 45 / 100 },     
    { minIncome: 6, maxIncome: income1 - 68000, taxRate: 48, fixedTax: (income1 - 68000) * 48 / 100 }
  ];
}
  
console.log(taxBrackets);
// Function to populate tax table
function populateTaxTable() {
    const table = document.getElementById("taxTable");

    const table1 = document.getElementById("taxTable1");  
  
    // Clear the table data (excluding header row)
    while (table.rows.length > 1) {
        table.deleteRow(1);
    }
    while (table1.rows.length > 1) {
        table1.deleteRow(1);
    }

    // Populate the table with new data
    taxBrackets.forEach(bracket => {
        const row = table.insertRow(-1);
        const minIncomeCell = row.insertCell(0);
        const maxIncomeCell = row.insertCell(1);
        const taxRateCell = row.insertCell(2);
        const taxDueCell = row.insertCell(3);
        const remainingIncomeCell = row.insertCell(4); // Added cell for remaining income
        
        minIncomeCell.textContent = bracket.minIncome.toLocaleString(); // Display minimum income
        maxIncomeCell.textContent = bracket.maxIncome === Infinity ? "Infinity" : bracket.maxIncome.toLocaleString(); // Display maximum income
        taxRateCell.textContent = bracket.taxRate + "%"; // Display tax rate
        taxDueCell.textContent = bracket.fixedTax.toLocaleString(); // Display fixed tax amount
        const remainingIncome = bracket.maxIncome === Infinity ? 0 : bracket.maxIncome - bracket.fixedTax; // Calculate remaining income
        remainingIncomeCell.textContent = remainingIncome.toLocaleString(); // Display remaining income
    });
}


// Call the function to populate the tax table
populateTaxTable();        


// جدول الأعباء العائلية  
// Define tax brackets
let netIncome1 = income1; // هذا مبلغ الدخل الصافي الذي ترغب في حساب الضريبة عليه

let taxBrackets1;

if (netIncome1 <= 2500) {
  taxBrackets1 = [
    { minIncome: 1, maxIncome: textbox14.value, taxRate: -1440, fixedTax: income1 }
  ];
} else if (netIncome1 <= 7000) {
  taxBrackets1 = [
    { minIncome: 1, maxIncome: textbox14.value, taxRate: -1440, fixedTax: income1 }
  ];
} else if (netIncome1 <= 16000) {
  taxBrackets1 = [
    { minIncome: 1, maxIncome: textbox14.value, taxRate: -1440, fixedTax: income1 }
  ];
} else if (netIncome1 <= 27000) {
  taxBrackets1 = [
    { minIncome: 1, maxIncome: textbox14.value, taxRate: -1440, fixedTax: income1 }    
  ];
} else if (netIncome1 <= 68000) {
  taxBrackets1 = [
    { minIncome: 1, maxIncome: textbox14.value, taxRate: -1440, fixedTax: income1 }    
  ];  
} else {
  taxBrackets1 = [
    { minIncome: 1, maxIncome: textbox14.value, taxRate: -1440, fixedTax: income1 }
  ];
}

console.log(taxBrackets1);
// Function to populate tax table
function populateTaxTable1() {

    const table1 = document.getElementById("taxTable1");  
  
    // Clear the table data (excluding header row)
    while (table1.rows.length > 1) {
        table1.deleteRow(1);
    }

    // Populate the table with new data
    taxBrackets1.forEach(bracket1 => {
        const row = table1.insertRow(-1);
        const minIncomeCell = row.insertCell(0);
        const maxIncomeCell = row.insertCell(1);
        const taxRateCell = row.insertCell(2);
        const taxDueCell = row.insertCell(3);
        const remainingIncomeCell = row.insertCell(4); // Added cell for remaining income
        
        minIncomeCell.textContent = bracket1.minIncome.toLocaleString(); // Display minimum income
        maxIncomeCell.textContent = bracket1.maxIncome === Infinity ? "Infinity" : bracket1.maxIncome.toLocaleString(); // Display maximum income
        taxRateCell.textContent = bracket1.taxRate + ""; // Display tax rate
        taxDueCell.textContent = bracket1.fixedTax.toLocaleString(); // Display fixed tax amount
        const remainingIncome = bracket1.maxIncome === Infinity ? 0 : bracket1.maxIncome - bracket1.fixedTax; // Calculate remaining income
    });
}


// Call the function to populate the tax table
populateTaxTable1();       
      

} else  if ( textbox11.value === "شركات | شركات الأشخاص" && textbox10.value <=1997 && textbox14.value === "أعزب" && textbox1.value < 1440 ) {
   let caption = "عفوا صافي الدخل الخاضع للضريبة لم يتجاوز حد الإعفاء للأعباء العائلية المقررة قانونا للحالة الإجتماعية :" + " " + textbox14.value + " " + "وهي " + "1440 جنية " + " " + "وفقا لقانون 187 لسنة 1993";
    showPopup( caption, 'error'); 
    textbox8.value = "";
    textbox6.value = "";         
    textbox3.value = "";
    textbox4.value = "";
// Function to populate tax table
    const table = document.getElementById("taxTable");

    const table1 = document.getElementById("taxTable1");  
  
    // Clear the table data (excluding header row)
    while (table.rows.length > 1) {
        table.deleteRow(1);
    }
    while (table1.rows.length > 1) {
        table1.deleteRow(1);
    }
    return;   
  
  
  
      
} else  if ( textbox11.value === "شركات | شركات الأشخاص" && textbox10.value <=1997 && textbox14.value === "متزوج ولا يعول أولاد" && textbox1.value >=1680 ) {
    income1 = income - 1680
    if (income1 <= 2500) {
    tax = income1 * 20 / 100;
    } else if (income1 <= 7000) {
    tax =  2500 * 20 / 100 + (income1 - 2500) * 27 / 100;
    } else if (income1 <= 16000) {
    tax = 2500 * 20 / 100 + 4500 * 27 / 100 + (income1 - 7000) * 35 / 100;
    } else if (income1 <= 27000) {
    tax = 2500 * 20 / 100 + 4500 * 27 / 100 + 9000 * 35 / 100 + (income1 - 16000) * 40 / 100;      
    } else if (income1 <= 68000) {
    tax =  2500 * 20 / 100 + 4500 * 27 / 100 + 9000 * 35 / 100 + 11000 * 40 / 100 + (income1 - 27000) * 45 / 100; 
    } else {
    tax = 27715 + (income1 - 68000) * 48 / 100;
    }            
   let caption = "تم حساب الضريبة بنجاح ! " + "الكيان القانوني : " + ( textbox11.value ) + "  " + " صافي الدخل الخاضع للضريبة : " + ( textbox1.value ) + " جنية " + " " + "السنة الضريبية : " + ( textbox10.value ) + " " + " الضريبة المستحقة : " + ( tax ) + " جنية ";
    showPopup( caption, 'info');   
  
// Define tax brackets
let netIncome = income1; // هذا مبلغ الدخل الصافي الذي ترغب في حساب الضريبة عليه

let taxBrackets;

if (netIncome <= 2500) {
  taxBrackets = [
    { minIncome: 1, maxIncome: income1, taxRate: 20, fixedTax: income1 * 20 / 100 }
  ];
} else if (netIncome <= 7000) {
  taxBrackets = [
    { minIncome: 1, maxIncome: 2500, taxRate: 20, fixedTax: 2500 * 20 / 100 },
    { minIncome: 2, maxIncome: income1 - 2500, taxRate: 27, fixedTax: (income1 - 2500) * 27 / 100 }
  ];
} else if (netIncome <= 16000) {
  taxBrackets = [
    { minIncome: 1, maxIncome: 2500, taxRate: 20, fixedTax: 2500 * 20 / 100 },
    { minIncome: 2, maxIncome: 4500, taxRate: 27, fixedTax: 4500 * 27 / 100 },
    { minIncome: 3, maxIncome: income1 - 7000, taxRate: 35, fixedTax: (income1 - 7000) * 35 / 100 }
  ];
} else if (netIncome <= 27000) {
  taxBrackets = [
    { minIncome: 1, maxIncome: 2500, taxRate: 20, fixedTax: 2500 * 20 / 100 },
    { minIncome: 2, maxIncome: 4500, taxRate: 27, fixedTax: 4500 * 27 / 100 },
    { minIncome: 3, maxIncome: 9000, taxRate: 35, fixedTax: 9000 * 35 / 100 },   
    { minIncome: 4, maxIncome: income1 - 16000, taxRate: 40, fixedTax: (income1 - 16000) * 40 / 100 }
  ]; 
} else if (netIncome <= 68000) {
  taxBrackets = [
    { minIncome: 1, maxIncome: 2500, taxRate: 20, fixedTax: 2500 * 20 / 100 },
    { minIncome: 2, maxIncome: 4500, taxRate: 27, fixedTax: 4500 * 27 / 100 },
    { minIncome: 3, maxIncome: 9000, taxRate: 35, fixedTax: 9000 * 35 / 100 },
    { minIncome: 4, maxIncome: 11000, taxRate: 40, fixedTax: 11000 * 40 / 100 },    
    { minIncome: 5, maxIncome: income1 - 27000, taxRate: 45, fixedTax: (income1 - 27000) * 45 / 100 }
  ];   
} else {
  taxBrackets = [
    { minIncome: 1, maxIncome: 2500, taxRate: 20, fixedTax: 2500 * 20 / 100 },
    { minIncome: 2, maxIncome: 4500, taxRate: 27, fixedTax: 4500 * 27 / 100 },
    { minIncome: 3, maxIncome: 9000, taxRate: 35, fixedTax: 9000 * 35 / 100 },
    { minIncome: 4, maxIncome: 11000, taxRate: 40, fixedTax: 11000 * 40 / 100 },
    { minIncome: 5, maxIncome: 41000, taxRate: 45, fixedTax: 41000 * 45 / 100 },     
    { minIncome: 6, maxIncome: income1 - 68000, taxRate: 48, fixedTax: (income1 - 68000) * 48 / 100 }
  ];
}
  
console.log(taxBrackets);
// Function to populate tax table
function populateTaxTable() {
    const table = document.getElementById("taxTable");

    const table1 = document.getElementById("taxTable1");  
  
    // Clear the table data (excluding header row)
    while (table.rows.length > 1) {
        table.deleteRow(1);
    }
    while (table1.rows.length > 1) {
        table1.deleteRow(1);
    }

    // Populate the table with new data
    taxBrackets.forEach(bracket => {
        const row = table.insertRow(-1);
        const minIncomeCell = row.insertCell(0);
        const maxIncomeCell = row.insertCell(1);
        const taxRateCell = row.insertCell(2);
        const taxDueCell = row.insertCell(3);
        const remainingIncomeCell = row.insertCell(4); // Added cell for remaining income
        
        minIncomeCell.textContent = bracket.minIncome.toLocaleString(); // Display minimum income
        maxIncomeCell.textContent = bracket.maxIncome === Infinity ? "Infinity" : bracket.maxIncome.toLocaleString(); // Display maximum income
        taxRateCell.textContent = bracket.taxRate + "%"; // Display tax rate
        taxDueCell.textContent = bracket.fixedTax.toLocaleString(); // Display fixed tax amount
        const remainingIncome = bracket.maxIncome === Infinity ? 0 : bracket.maxIncome - bracket.fixedTax; // Calculate remaining income
        remainingIncomeCell.textContent = remainingIncome.toLocaleString(); // Display remaining income
    });
}


// Call the function to populate the tax table
populateTaxTable();        


// جدول الأعباء العائلية  
// Define tax brackets
let netIncome1 = income1; // هذا مبلغ الدخل الصافي الذي ترغب في حساب الضريبة عليه

let taxBrackets1;

if (netIncome1 <= 2500) {
  taxBrackets1 = [
    { minIncome: 1, maxIncome: textbox14.value, taxRate: -1680, fixedTax: income1 }
  ];
} else if (netIncome1 <= 7000) {
  taxBrackets1 = [
    { minIncome: 1, maxIncome: textbox14.value, taxRate: -1680, fixedTax: income1 }
  ];
} else if (netIncome1 <= 16000) {
  taxBrackets1 = [
    { minIncome: 1, maxIncome: textbox14.value, taxRate: -1680, fixedTax: income1 }
  ];
} else if (netIncome1 <= 27000) {
  taxBrackets1 = [
    { minIncome: 1, maxIncome: textbox14.value, taxRate: -1680, fixedTax: income1 }    
  ];
} else if (netIncome1 <= 68000) {
  taxBrackets1 = [
    { minIncome: 1, maxIncome: textbox14.value, taxRate: -1680, fixedTax: income1 }    
  ];  
} else {
  taxBrackets1 = [
    { minIncome: 1, maxIncome: textbox14.value, taxRate: -1680, fixedTax: income1 }
  ];
}

console.log(taxBrackets1);
// Function to populate tax table
function populateTaxTable1() {

    const table1 = document.getElementById("taxTable1");  
  
    // Clear the table data (excluding header row)
    while (table1.rows.length > 1) {
        table1.deleteRow(1);
    }

    // Populate the table with new data
    taxBrackets1.forEach(bracket1 => {
        const row = table1.insertRow(-1);
        const minIncomeCell = row.insertCell(0);
        const maxIncomeCell = row.insertCell(1);
        const taxRateCell = row.insertCell(2);
        const taxDueCell = row.insertCell(3);
        const remainingIncomeCell = row.insertCell(4); // Added cell for remaining income
        
        minIncomeCell.textContent = bracket1.minIncome.toLocaleString(); // Display minimum income
        maxIncomeCell.textContent = bracket1.maxIncome === Infinity ? "Infinity" : bracket1.maxIncome.toLocaleString(); // Display maximum income
        taxRateCell.textContent = bracket1.taxRate + ""; // Display tax rate
        taxDueCell.textContent = bracket1.fixedTax.toLocaleString(); // Display fixed tax amount
        const remainingIncome = bracket1.maxIncome === Infinity ? 0 : bracket1.maxIncome - bracket1.fixedTax; // Calculate remaining income
    });
}


// Call the function to populate the tax table
populateTaxTable1();       
      

  
} else  if ( textbox11.value === "شركات | شركات الأشخاص" && textbox10.value <=1997 && textbox14.value === "متزوج ولا يعول أولاد" && textbox1.value < 1680 ) {
   let caption = "عفوا صافي الدخل الخاضع للضريبة لم يتجاوز حد الإعفاء للأعباء العائلية المقررة قانونا للحالة الإجتماعية :" + " " + textbox14.value + " " + "وهي " + "1680 جنية " + " " + "وفقا لقانون 187 لسنة 1993";    
    showPopup( caption, 'error'); 
    textbox8.value = "";
    textbox6.value = "";         
    textbox3.value = "";
    textbox4.value = "";
// Function to populate tax table
    const table = document.getElementById("taxTable");

    const table1 = document.getElementById("taxTable1");  
  
    // Clear the table data (excluding header row)
    while (table.rows.length > 1) {
        table.deleteRow(1);
    }
    while (table1.rows.length > 1) {
        table1.deleteRow(1);
    }
    return;   
  
  
      
} else  if ( textbox11.value === "شركات | شركات الأشخاص" && textbox10.value <=1997 && textbox14.value === "غير متزوج ويعول ولدا أو أكثر" && textbox1.value >= 1680  ) {
    income1 = income - 1680
    if (income1 <= 2500) {
    tax = income1 * 20 / 100;
    } else if (income1 <= 7000) {
    tax =  2500 * 20 / 100 + (income1 - 2500) * 27 / 100;
    } else if (income1 <= 16000) {
    tax = 2500 * 20 / 100 + 4500 * 27 / 100 + (income1 - 7000) * 35 / 100;
    } else if (income1 <= 27000) {
    tax = 2500 * 20 / 100 + 4500 * 27 / 100 + 9000 * 35 / 100 + (income1 - 16000) * 40 / 100;      
    } else if (income1 <= 68000) {
    tax =  2500 * 20 / 100 + 4500 * 27 / 100 + 9000 * 35 / 100 + 11000 * 40 / 100 + (income1 - 27000) * 45 / 100; 
    } else {
    tax = 27715 + (income1 - 68000) * 48 / 100;
    }            
   let caption = "تم حساب الضريبة بنجاح ! " + "الكيان القانوني : " + ( textbox11.value ) + "  " + " صافي الدخل الخاضع للضريبة : " + ( textbox1.value ) + " جنية " + " " + "السنة الضريبية : " + ( textbox10.value ) + " " + " الضريبة المستحقة : " + ( tax ) + " جنية ";
    showPopup( caption, 'info');   
  
// Define tax brackets
let netIncome = income1; // هذا مبلغ الدخل الصافي الذي ترغب في حساب الضريبة عليه

let taxBrackets;

if (netIncome <= 2500) {
  taxBrackets = [
    { minIncome: 1, maxIncome: income1, taxRate: 20, fixedTax: income1 * 20 / 100 }
  ];
} else if (netIncome <= 7000) {
  taxBrackets = [
    { minIncome: 1, maxIncome: 2500, taxRate: 20, fixedTax: 2500 * 20 / 100 },
    { minIncome: 2, maxIncome: income1 - 2500, taxRate: 27, fixedTax: (income1 - 2500) * 27 / 100 }
  ];
} else if (netIncome <= 16000) {
  taxBrackets = [
    { minIncome: 1, maxIncome: 2500, taxRate: 20, fixedTax: 2500 * 20 / 100 },
    { minIncome: 2, maxIncome: 4500, taxRate: 27, fixedTax: 4500 * 27 / 100 },
    { minIncome: 3, maxIncome: income1 - 7000, taxRate: 35, fixedTax: (income1 - 7000) * 35 / 100 }
  ];
} else if (netIncome <= 27000) {
  taxBrackets = [
    { minIncome: 1, maxIncome: 2500, taxRate: 20, fixedTax: 2500 * 20 / 100 },
    { minIncome: 2, maxIncome: 4500, taxRate: 27, fixedTax: 4500 * 27 / 100 },
    { minIncome: 3, maxIncome: 9000, taxRate: 35, fixedTax: 9000 * 35 / 100 },   
    { minIncome: 4, maxIncome: income1 - 16000, taxRate: 40, fixedTax: (income1 - 16000) * 40 / 100 }
  ]; 
} else if (netIncome <= 68000) {
  taxBrackets = [
    { minIncome: 1, maxIncome: 2500, taxRate: 20, fixedTax: 2500 * 20 / 100 },
    { minIncome: 2, maxIncome: 4500, taxRate: 27, fixedTax: 4500 * 27 / 100 },
    { minIncome: 3, maxIncome: 9000, taxRate: 35, fixedTax: 9000 * 35 / 100 },
    { minIncome: 4, maxIncome: 11000, taxRate: 40, fixedTax: 11000 * 40 / 100 },    
    { minIncome: 5, maxIncome: income1 - 27000, taxRate: 45, fixedTax: (income1 - 27000) * 45 / 100 }
  ];   
} else {
  taxBrackets = [
    { minIncome: 1, maxIncome: 2500, taxRate: 20, fixedTax: 2500 * 20 / 100 },
    { minIncome: 2, maxIncome: 4500, taxRate: 27, fixedTax: 4500 * 27 / 100 },
    { minIncome: 3, maxIncome: 9000, taxRate: 35, fixedTax: 9000 * 35 / 100 },
    { minIncome: 4, maxIncome: 11000, taxRate: 40, fixedTax: 11000 * 40 / 100 },
    { minIncome: 5, maxIncome: 41000, taxRate: 45, fixedTax: 41000 * 45 / 100 },     
    { minIncome: 6, maxIncome: income1 - 68000, taxRate: 48, fixedTax: (income1 - 68000) * 48 / 100 }
  ];
}
  
console.log(taxBrackets);
// Function to populate tax table
function populateTaxTable() {
    const table = document.getElementById("taxTable");

    const table1 = document.getElementById("taxTable1");  
  
    // Clear the table data (excluding header row)
    while (table.rows.length > 1) {
        table.deleteRow(1);
    }
    while (table1.rows.length > 1) {
        table1.deleteRow(1);
    }

    // Populate the table with new data
    taxBrackets.forEach(bracket => {
        const row = table.insertRow(-1);
        const minIncomeCell = row.insertCell(0);
        const maxIncomeCell = row.insertCell(1);
        const taxRateCell = row.insertCell(2);
        const taxDueCell = row.insertCell(3);
        const remainingIncomeCell = row.insertCell(4); // Added cell for remaining income
        
        minIncomeCell.textContent = bracket.minIncome.toLocaleString(); // Display minimum income
        maxIncomeCell.textContent = bracket.maxIncome === Infinity ? "Infinity" : bracket.maxIncome.toLocaleString(); // Display maximum income
        taxRateCell.textContent = bracket.taxRate + "%"; // Display tax rate
        taxDueCell.textContent = bracket.fixedTax.toLocaleString(); // Display fixed tax amount
        const remainingIncome = bracket.maxIncome === Infinity ? 0 : bracket.maxIncome - bracket.fixedTax; // Calculate remaining income
        remainingIncomeCell.textContent = remainingIncome.toLocaleString(); // Display remaining income
    });
}


// Call the function to populate the tax table
populateTaxTable();        


// جدول الأعباء العائلية  
// Define tax brackets
let netIncome1 = income1; // هذا مبلغ الدخل الصافي الذي ترغب في حساب الضريبة عليه

let taxBrackets1;

if (netIncome1 <= 2500) {
  taxBrackets1 = [
    { minIncome: 1, maxIncome: textbox14.value, taxRate: -1680, fixedTax: income1 }
  ];
} else if (netIncome1 <= 7000) {
  taxBrackets1 = [
    { minIncome: 1, maxIncome: textbox14.value, taxRate: -1680, fixedTax: income1 }
  ];
} else if (netIncome1 <= 16000) {
  taxBrackets1 = [
    { minIncome: 1, maxIncome: textbox14.value, taxRate: -1680, fixedTax: income1 }
  ];
} else if (netIncome1 <= 27000) {
  taxBrackets1 = [
    { minIncome: 1, maxIncome: textbox14.value, taxRate: -1680, fixedTax: income1 }    
  ];
} else if (netIncome1 <= 68000) {
  taxBrackets1 = [
    { minIncome: 1, maxIncome: textbox14.value, taxRate: -1680, fixedTax: income1 }    
  ];  
} else {
  taxBrackets1 = [
    { minIncome: 1, maxIncome: textbox14.value, taxRate: -1680, fixedTax: income1 }
  ];
}

console.log(taxBrackets1);
// Function to populate tax table
function populateTaxTable1() {

    const table1 = document.getElementById("taxTable1");  
  
    // Clear the table data (excluding header row)
    while (table1.rows.length > 1) {
        table1.deleteRow(1);
    }

    // Populate the table with new data
    taxBrackets1.forEach(bracket1 => {
        const row = table1.insertRow(-1);
        const minIncomeCell = row.insertCell(0);
        const maxIncomeCell = row.insertCell(1);
        const taxRateCell = row.insertCell(2);
        const taxDueCell = row.insertCell(3);
        const remainingIncomeCell = row.insertCell(4); // Added cell for remaining income
        
        minIncomeCell.textContent = bracket1.minIncome.toLocaleString(); // Display minimum income
        maxIncomeCell.textContent = bracket1.maxIncome === Infinity ? "Infinity" : bracket1.maxIncome.toLocaleString(); // Display maximum income
        taxRateCell.textContent = bracket1.taxRate + ""; // Display tax rate
        taxDueCell.textContent = bracket1.fixedTax.toLocaleString(); // Display fixed tax amount
        const remainingIncome = bracket1.maxIncome === Infinity ? 0 : bracket1.maxIncome - bracket1.fixedTax; // Calculate remaining income
    });
}


// Call the function to populate the tax table
populateTaxTable1();        

      

  
} else  if ( textbox11.value === "شركات | شركات الأشخاص" && textbox10.value <=1997 && textbox14.value === "غير متزوج ويعول ولدا أو أكثر" && textbox1.value < 1680 ) {
   let caption = "عفوا صافي الدخل الخاضع للضريبة لم يتجاوز حد الإعفاء للأعباء العائلية المقررة قانونا للحالة الإجتماعية :" + " " + textbox14.value + " " + "وهي " + "1680 جنية " + " " + "وفقا لقانون 187 لسنة 1993";
    showPopup( caption, 'error'); 
    textbox8.value = "";
    textbox6.value = "";        
    textbox3.value = "";
    textbox4.value = "";
// Function to populate tax table
    const table = document.getElementById("taxTable");

    const table1 = document.getElementById("taxTable1");  
  
    // Clear the table data (excluding header row)
    while (table.rows.length > 1) {
        table.deleteRow(1);
    }
    while (table1.rows.length > 1) {
        table1.deleteRow(1);
    }
    return;    
  
  
      
} else  if ( textbox11.value === "شركات | شركات الأشخاص" && textbox10.value <=1997 && textbox14.value === "متزوج ويعول ولدا أو أكثر" && textbox1.value >= 1920 ) {
    income1 = income - 1920
    if (income1 <= 2500) {
    tax = income1 * 20 / 100;
    } else if (income1 <= 7000) {
    tax =  2500 * 20 / 100 + (income1 - 2500) * 27 / 100;
    } else if (income1 <= 16000) {
    tax = 2500 * 20 / 100 + 4500 * 27 / 100 + (income1 - 7000) * 35 / 100;
    } else if (income1 <= 27000) {
    tax = 2500 * 20 / 100 + 4500 * 27 / 100 + 9000 * 35 / 100 + (income1 - 16000) * 40 / 100;      
    } else if (income1 <= 68000) {
    tax =  2500 * 20 / 100 + 4500 * 27 / 100 + 9000 * 35 / 100 + 11000 * 40 / 100 + (income1 - 27000) * 45 / 100; 
    } else {
    tax = 27715 + (income1 - 68000) * 48 / 100;
    }            
   let caption = "تم حساب الضريبة بنجاح ! " + "الكيان القانوني : " + ( textbox11.value ) + "  " + " صافي الدخل الخاضع للضريبة : " + ( textbox1.value ) + " جنية " + " " + "السنة الضريبية : " + ( textbox10.value ) + " " + " الضريبة المستحقة : " + ( tax ) + " جنية ";
    showPopup( caption, 'info');  
  
// Define tax brackets
let netIncome = income1; // هذا مبلغ الدخل الصافي الذي ترغب في حساب الضريبة عليه

let taxBrackets;

if (netIncome <= 2500) {
  taxBrackets = [
    { minIncome: 1, maxIncome: income1, taxRate: 20, fixedTax: income1 * 20 / 100 }
  ];
} else if (netIncome <= 7000) {
  taxBrackets = [
    { minIncome: 1, maxIncome: 2500, taxRate: 20, fixedTax: 2500 * 20 / 100 },
    { minIncome: 2, maxIncome: income1 - 2500, taxRate: 27, fixedTax: (income1 - 2500) * 27 / 100 }
  ];
} else if (netIncome <= 16000) {
  taxBrackets = [
    { minIncome: 1, maxIncome: 2500, taxRate: 20, fixedTax: 2500 * 20 / 100 },
    { minIncome: 2, maxIncome: 4500, taxRate: 27, fixedTax: 4500 * 27 / 100 },
    { minIncome: 3, maxIncome: income1 - 7000, taxRate: 35, fixedTax: (income1 - 7000) * 35 / 100 }
  ];
} else if (netIncome <= 27000) {
  taxBrackets = [
    { minIncome: 1, maxIncome: 2500, taxRate: 20, fixedTax: 2500 * 20 / 100 },
    { minIncome: 2, maxIncome: 4500, taxRate: 27, fixedTax: 4500 * 27 / 100 },
    { minIncome: 3, maxIncome: 9000, taxRate: 35, fixedTax: 9000 * 35 / 100 },   
    { minIncome: 4, maxIncome: income1 - 16000, taxRate: 40, fixedTax: (income1 - 16000) * 40 / 100 }
  ]; 
} else if (netIncome <= 68000) {
  taxBrackets = [
    { minIncome: 1, maxIncome: 2500, taxRate: 20, fixedTax: 2500 * 20 / 100 },
    { minIncome: 2, maxIncome: 4500, taxRate: 27, fixedTax: 4500 * 27 / 100 },
    { minIncome: 3, maxIncome: 9000, taxRate: 35, fixedTax: 9000 * 35 / 100 },
    { minIncome: 4, maxIncome: 11000, taxRate: 40, fixedTax: 11000 * 40 / 100 },    
    { minIncome: 5, maxIncome: income1 - 27000, taxRate: 45, fixedTax: (income1 - 27000) * 45 / 100 }
  ];   
} else {
  taxBrackets = [
    { minIncome: 1, maxIncome: 2500, taxRate: 20, fixedTax: 2500 * 20 / 100 },
    { minIncome: 2, maxIncome: 4500, taxRate: 27, fixedTax: 4500 * 27 / 100 },
    { minIncome: 3, maxIncome: 9000, taxRate: 35, fixedTax: 9000 * 35 / 100 },
    { minIncome: 4, maxIncome: 11000, taxRate: 40, fixedTax: 11000 * 40 / 100 },
    { minIncome: 5, maxIncome: 41000, taxRate: 45, fixedTax: 41000 * 45 / 100 },     
    { minIncome: 6, maxIncome: income1 - 68000, taxRate: 48, fixedTax: (income1 - 68000) * 48 / 100 }
  ];
}
  
console.log(taxBrackets);
// Function to populate tax table
function populateTaxTable() {
    const table = document.getElementById("taxTable");

    const table1 = document.getElementById("taxTable1");  
  
    // Clear the table data (excluding header row)
    while (table.rows.length > 1) {
        table.deleteRow(1);
    }
    while (table1.rows.length > 1) {
        table1.deleteRow(1);
    }

    // Populate the table with new data
    taxBrackets.forEach(bracket => {
        const row = table.insertRow(-1);
        const minIncomeCell = row.insertCell(0);
        const maxIncomeCell = row.insertCell(1);
        const taxRateCell = row.insertCell(2);
        const taxDueCell = row.insertCell(3);
        const remainingIncomeCell = row.insertCell(4); // Added cell for remaining income
        
        minIncomeCell.textContent = bracket.minIncome.toLocaleString(); // Display minimum income
        maxIncomeCell.textContent = bracket.maxIncome === Infinity ? "Infinity" : bracket.maxIncome.toLocaleString(); // Display maximum income
        taxRateCell.textContent = bracket.taxRate + "%"; // Display tax rate
        taxDueCell.textContent = bracket.fixedTax.toLocaleString(); // Display fixed tax amount
        const remainingIncome = bracket.maxIncome === Infinity ? 0 : bracket.maxIncome - bracket.fixedTax; // Calculate remaining income
        remainingIncomeCell.textContent = remainingIncome.toLocaleString(); // Display remaining income
    });
}


// Call the function to populate the tax table
populateTaxTable();        


// جدول الأعباء العائلية  
// Define tax brackets
let netIncome1 = income1; // هذا مبلغ الدخل الصافي الذي ترغب في حساب الضريبة عليه

let taxBrackets1;

if (netIncome1 <= 2500) {
  taxBrackets1 = [
    { minIncome: 1, maxIncome: textbox14.value, taxRate: -1920, fixedTax: income1 }
  ];
} else if (netIncome1 <= 7000) {
  taxBrackets1 = [
    { minIncome: 1, maxIncome: textbox14.value, taxRate: -1920, fixedTax: income1 }
  ];
} else if (netIncome1 <= 16000) {
  taxBrackets1 = [
    { minIncome: 1, maxIncome: textbox14.value, taxRate: -1920, fixedTax: income1 }
  ];
} else if (netIncome1 <= 27000) {
  taxBrackets1 = [
    { minIncome: 1, maxIncome: textbox14.value, taxRate: -1920, fixedTax: income1 }    
  ];
} else if (netIncome1 <= 68000) {
  taxBrackets1 = [
    { minIncome: 1, maxIncome: textbox14.value, taxRate: -1920, fixedTax: income1 }    
  ];  
} else {
  taxBrackets1 = [
    { minIncome: 1, maxIncome: textbox14.value, taxRate: -1920, fixedTax: income1 }
  ];
}

console.log(taxBrackets1);
// Function to populate tax table
function populateTaxTable1() {

    const table1 = document.getElementById("taxTable1");  
  
    // Clear the table data (excluding header row)
    while (table1.rows.length > 1) {
        table1.deleteRow(1);
    }

    // Populate the table with new data
    taxBrackets1.forEach(bracket1 => {
        const row = table1.insertRow(-1);
        const minIncomeCell = row.insertCell(0);
        const maxIncomeCell = row.insertCell(1);
        const taxRateCell = row.insertCell(2);
        const taxDueCell = row.insertCell(3);
        const remainingIncomeCell = row.insertCell(4); // Added cell for remaining income
        
        minIncomeCell.textContent = bracket1.minIncome.toLocaleString(); // Display minimum income
        maxIncomeCell.textContent = bracket1.maxIncome === Infinity ? "Infinity" : bracket1.maxIncome.toLocaleString(); // Display maximum income
        taxRateCell.textContent = bracket1.taxRate + ""; // Display tax rate
        taxDueCell.textContent = bracket1.fixedTax.toLocaleString(); // Display fixed tax amount
        const remainingIncome = bracket1.maxIncome === Infinity ? 0 : bracket1.maxIncome - bracket1.fixedTax; // Calculate remaining income
    });
}


// Call the function to populate the tax table
populateTaxTable1();           
      
      

  
} else  if ( textbox11.value === "شركات | شركات الأشخاص" && textbox10.value <=1997 && textbox14.value === "متزوج ويعول ولدا أو أكثر" && textbox1.value < 1920 ) {
   let caption = "عفوا صافي الدخل الخاضع للضريبة لم يتجاوز حد الإعفاء للأعباء العائلية المقررة قانونا للحالة الإجتماعية :" + " " + textbox14.value + " " + "وهي " + "1920 جنية " + " " + "وفقا لقانون 187 لسنة 1993";
    showPopup( caption, 'error'); 
    textbox8.value = "";
    textbox6.value = "";          
    textbox3.value = "";
    textbox4.value = "";
// Function to populate tax table
    const table = document.getElementById("taxTable");

    const table1 = document.getElementById("taxTable1");  
  
    // Clear the table data (excluding header row)
    while (table.rows.length > 1) {
        table.deleteRow(1);
    }
    while (table1.rows.length > 1) {
        table1.deleteRow(1);
    }
    return;    
  
  
   
  
} else  if ( textbox11.value === "أفراد | أشخاص طبيعية" && textbox10.value >=1998 && textbox14.value === "أعزب" && textbox1.value >= 2000 ) {
    income1 = income - 2000
    if (income1 <= 2500) {
    tax = income1 * 20 / 100;
    } else if (income1 <= 7000) {
    tax =  2500 * 20 / 100 + (income1 - 2500) * 27 / 100;
    } else if (income1 <= 16000) {
    tax = 2500 * 20 / 100 + 4500 * 27 / 100 + (income1 - 7000) * 35 / 100;
    } else {
    tax = 4865 + (income1 - 16000) * 40 / 100;
    }            
   let caption = "تم حساب الضريبة بنجاح ! " + "الكيان القانوني : " + ( textbox11.value ) + "  " + " صافي الدخل الخاضع للضريبة : " + ( textbox1.value ) + " جنية " + " " + "السنة الضريبية : " + ( textbox10.value ) + " " + " الضريبة المستحقة : " + ( tax ) + " جنية ";
    showPopup( caption, 'info');   
  
// Define tax brackets
let netIncome = income1; // هذا مبلغ الدخل الصافي الذي ترغب في حساب الضريبة عليه

let taxBrackets;

if (netIncome <= 2500) {
  taxBrackets = [
    { minIncome: 1, maxIncome: income1, taxRate: 20, fixedTax: income1 * 20 / 100 }
  ];
} else if (netIncome <= 7000) {
  taxBrackets = [
    { minIncome: 1, maxIncome: 2500, taxRate: 20, fixedTax: 2500 * 20 / 100 },
    { minIncome: 2, maxIncome: income1 - 2500, taxRate: 27, fixedTax: (income1 - 2500) * 27 / 100 }
  ];
} else if (netIncome <= 16000) {
  taxBrackets = [
    { minIncome: 1, maxIncome: 2500, taxRate: 20, fixedTax: 2500 * 20 / 100 },
    { minIncome: 2, maxIncome: 4500, taxRate: 27, fixedTax: 4500 * 27 / 100 },
    { minIncome: 3, maxIncome: income1 - 7000, taxRate: 35, fixedTax: (income1 - 7000) * 35 / 100 }
  ]; 
} else {
  taxBrackets = [
    { minIncome: 1, maxIncome: 2500, taxRate: 20, fixedTax: 2500 * 20 / 100 },
    { minIncome: 2, maxIncome: 4500, taxRate: 27, fixedTax: 4500 * 27 / 100 },
    { minIncome: 3, maxIncome: 9000, taxRate: 35, fixedTax: 9000 * 35 / 100 },  
    { minIncome: 4, maxIncome: income1 - 16000, taxRate: 40, fixedTax: (income1 - 16000) * 40 / 100 }
  ];
}
  
console.log(taxBrackets);
// Function to populate tax table
function populateTaxTable() {
    const table = document.getElementById("taxTable");

    const table1 = document.getElementById("taxTable1");  
  
    // Clear the table data (excluding header row)
    while (table.rows.length > 1) {
        table.deleteRow(1);
    }
    while (table1.rows.length > 1) {
        table1.deleteRow(1);
    }

    // Populate the table with new data
    taxBrackets.forEach(bracket => {
        const row = table.insertRow(-1);
        const minIncomeCell = row.insertCell(0);
        const maxIncomeCell = row.insertCell(1);
        const taxRateCell = row.insertCell(2);
        const taxDueCell = row.insertCell(3);
        const remainingIncomeCell = row.insertCell(4); // Added cell for remaining income
        
        minIncomeCell.textContent = bracket.minIncome.toLocaleString(); // Display minimum income
        maxIncomeCell.textContent = bracket.maxIncome === Infinity ? "Infinity" : bracket.maxIncome.toLocaleString(); // Display maximum income
        taxRateCell.textContent = bracket.taxRate + "%"; // Display tax rate
        taxDueCell.textContent = bracket.fixedTax.toLocaleString(); // Display fixed tax amount
        const remainingIncome = bracket.maxIncome === Infinity ? 0 : bracket.maxIncome - bracket.fixedTax; // Calculate remaining income
        remainingIncomeCell.textContent = remainingIncome.toLocaleString(); // Display remaining income
    });
}


// Call the function to populate the tax table
populateTaxTable();
  
  
  
// جدول الأعباء العائلية  
// Define tax brackets
let netIncome1 = income1; // هذا مبلغ الدخل الصافي الذي ترغب في حساب الضريبة عليه

let taxBrackets1;

if (netIncome1 <= 2500) {
  taxBrackets1 = [
    { minIncome: 1, maxIncome: textbox14.value, taxRate: -2000, fixedTax: income1 }
  ];
} else if (netIncome1 <= 7000) {
  taxBrackets1 = [
    { minIncome: 1, maxIncome: textbox14.value, taxRate: -2000, fixedTax: income1 }
  ];
} else if (netIncome1 <= 16000) {
  taxBrackets1 = [
    { minIncome: 1, maxIncome: textbox14.value, taxRate: -2000, fixedTax: income1 }
  ];
} else {
  taxBrackets1 = [
    { minIncome: 1, maxIncome: textbox14.value, taxRate: -2000, fixedTax: income1 }
  ];
}

console.log(taxBrackets1);
// Function to populate tax table
function populateTaxTable1() {

    const table1 = document.getElementById("taxTable1");  
  
    // Clear the table data (excluding header row)
    while (table1.rows.length > 1) {
        table1.deleteRow(1);
    }

    // Populate the table with new data
    taxBrackets1.forEach(bracket1 => {
        const row = table1.insertRow(-1);
        const minIncomeCell = row.insertCell(0);
        const maxIncomeCell = row.insertCell(1);
        const taxRateCell = row.insertCell(2);
        const taxDueCell = row.insertCell(3);
        const remainingIncomeCell = row.insertCell(4); // Added cell for remaining income
        
        minIncomeCell.textContent = bracket1.minIncome.toLocaleString(); // Display minimum income
        maxIncomeCell.textContent = bracket1.maxIncome === Infinity ? "Infinity" : bracket1.maxIncome.toLocaleString(); // Display maximum income
        taxRateCell.textContent = bracket1.taxRate + ""; // Display tax rate
        taxDueCell.textContent = bracket1.fixedTax.toLocaleString(); // Display fixed tax amount
        const remainingIncome = bracket1.maxIncome === Infinity ? 0 : bracket1.maxIncome - bracket1.fixedTax; // Calculate remaining income
    });
}


// Call the function to populate the tax table
populateTaxTable1();    
  
  

} else  if ( textbox11.value === "أفراد | أشخاص طبيعية" && textbox10.value >=1998 && textbox14.value === "أعزب" && textbox1.value < 2000 ) {
   let caption = "عفوا صافي الدخل الخاضع للضريبة لم يتجاوز حد الإعفاء للأعباء العائلية المقررة قانونا للحالة الإجتماعية :" + " " + textbox14.value + " " + "وهي " + "2000 جنية " + " " + "وفقا لقانون 162 لسنة 1997";
    showPopup( caption, 'error'); 
    textbox8.value = "";
    textbox6.value = "";         
    textbox3.value = "";
    textbox4.value = "";
// Function to populate tax table
    const table = document.getElementById("taxTable");

    const table1 = document.getElementById("taxTable1");  
  
    // Clear the table data (excluding header row)
    while (table.rows.length > 1) {
        table.deleteRow(1);
    }
    while (table1.rows.length > 1) {
        table1.deleteRow(1);
    }
    return;    
  
  
  
  
  
} else  if ( textbox11.value === "أفراد | أشخاص طبيعية" && textbox10.value >=1998 && textbox14.value === "متزوج ولا يعول أولاد" && textbox1.value >= 2500 ) {
    income1 = income - 2500
    if (income1 <= 2500) {
    tax = income1 * 20 / 100;
    } else if (income1 <= 7000) {
    tax =  2500 * 20 / 100 + (income1 - 2500) * 27 / 100;
    } else if (income1 <= 16000) {
    tax = 2500 * 20 / 100 + 4500 * 27 / 100 + (income1 - 7000) * 35 / 100;
    } else {
    tax = 4865 + (income1 - 16000) * 40 / 100;
    }            
   let caption = "تم حساب الضريبة بنجاح ! " + "الكيان القانوني : " + ( textbox11.value ) + "  " + " صافي الدخل الخاضع للضريبة : " + ( textbox1.value ) + " جنية " + " " + "السنة الضريبية : " + ( textbox10.value ) + " " + " الضريبة المستحقة : " + ( tax ) + " جنية ";
    showPopup( caption, 'info');  
  
// Define tax brackets
let netIncome = income1; // هذا مبلغ الدخل الصافي الذي ترغب في حساب الضريبة عليه

let taxBrackets;

if (netIncome <= 2500) {
  taxBrackets = [
    { minIncome: 1, maxIncome: income1, taxRate: 20, fixedTax: income1 * 20 / 100 }
  ];
} else if (netIncome <= 7000) {
  taxBrackets = [
    { minIncome: 1, maxIncome: 2500, taxRate: 20, fixedTax: 2500 * 20 / 100 },
    { minIncome: 2, maxIncome: income1 - 2500, taxRate: 27, fixedTax: (income1 - 2500) * 27 / 100 }
  ];
} else if (netIncome <= 16000) {
  taxBrackets = [
    { minIncome: 1, maxIncome: 2500, taxRate: 20, fixedTax: 2500 * 20 / 100 },
    { minIncome: 2, maxIncome: 4500, taxRate: 27, fixedTax: 4500 * 27 / 100 },
    { minIncome: 3, maxIncome: income1 - 7000, taxRate: 35, fixedTax: (income1 - 7000) * 35 / 100 }
  ]; 
} else {
  taxBrackets = [
    { minIncome: 1, maxIncome: 2500, taxRate: 20, fixedTax: 2500 * 20 / 100 },
    { minIncome: 2, maxIncome: 4500, taxRate: 27, fixedTax: 4500 * 27 / 100 },
    { minIncome: 3, maxIncome: 9000, taxRate: 35, fixedTax: 9000 * 35 / 100 },  
    { minIncome: 4, maxIncome: income1 - 16000, taxRate: 40, fixedTax: (income1 - 16000) * 40 / 100 }
  ];
}
  
console.log(taxBrackets);
// Function to populate tax table
function populateTaxTable() {
    const table = document.getElementById("taxTable");

    const table1 = document.getElementById("taxTable1");  
  
    // Clear the table data (excluding header row)
    while (table.rows.length > 1) {
        table.deleteRow(1);
    }
    while (table1.rows.length > 1) {
        table1.deleteRow(1);
    }

    // Populate the table with new data
    taxBrackets.forEach(bracket => {
        const row = table.insertRow(-1);
        const minIncomeCell = row.insertCell(0);
        const maxIncomeCell = row.insertCell(1);
        const taxRateCell = row.insertCell(2);
        const taxDueCell = row.insertCell(3);
        const remainingIncomeCell = row.insertCell(4); // Added cell for remaining income
        
        minIncomeCell.textContent = bracket.minIncome.toLocaleString(); // Display minimum income
        maxIncomeCell.textContent = bracket.maxIncome === Infinity ? "Infinity" : bracket.maxIncome.toLocaleString(); // Display maximum income
        taxRateCell.textContent = bracket.taxRate + "%"; // Display tax rate
        taxDueCell.textContent = bracket.fixedTax.toLocaleString(); // Display fixed tax amount
        const remainingIncome = bracket.maxIncome === Infinity ? 0 : bracket.maxIncome - bracket.fixedTax; // Calculate remaining income
        remainingIncomeCell.textContent = remainingIncome.toLocaleString(); // Display remaining income
    });
}


// Call the function to populate the tax table
populateTaxTable();
  
  
  
// جدول الأعباء العائلية  
// Define tax brackets
let netIncome1 = income1; // هذا مبلغ الدخل الصافي الذي ترغب في حساب الضريبة عليه

let taxBrackets1;

if (netIncome1 <= 2500) {
  taxBrackets1 = [
    { minIncome: 1, maxIncome: textbox14.value, taxRate: -2500, fixedTax: income1 }
  ];
} else if (netIncome1 <= 7000) {
  taxBrackets1 = [
    { minIncome: 1, maxIncome: textbox14.value, taxRate: -2500, fixedTax: income1 }
  ];
} else if (netIncome1 <= 16000) {
  taxBrackets1 = [
    { minIncome: 1, maxIncome: textbox14.value, taxRate: -2500, fixedTax: income1 }
  ];
} else {
  taxBrackets1 = [
    { minIncome: 1, maxIncome: textbox14.value, taxRate: -2500, fixedTax: income1 }
  ];
}

console.log(taxBrackets1);
// Function to populate tax table
function populateTaxTable1() {

    const table1 = document.getElementById("taxTable1");  
  
    // Clear the table data (excluding header row)
    while (table1.rows.length > 1) {
        table1.deleteRow(1);
    }

    // Populate the table with new data
    taxBrackets1.forEach(bracket1 => {
        const row = table1.insertRow(-1);
        const minIncomeCell = row.insertCell(0);
        const maxIncomeCell = row.insertCell(1);
        const taxRateCell = row.insertCell(2);
        const taxDueCell = row.insertCell(3);
        const remainingIncomeCell = row.insertCell(4); // Added cell for remaining income
        
        minIncomeCell.textContent = bracket1.minIncome.toLocaleString(); // Display minimum income
        maxIncomeCell.textContent = bracket1.maxIncome === Infinity ? "Infinity" : bracket1.maxIncome.toLocaleString(); // Display maximum income
        taxRateCell.textContent = bracket1.taxRate + ""; // Display tax rate
        taxDueCell.textContent = bracket1.fixedTax.toLocaleString(); // Display fixed tax amount
        const remainingIncome = bracket1.maxIncome === Infinity ? 0 : bracket1.maxIncome - bracket1.fixedTax; // Calculate remaining income
    });
}


// Call the function to populate the tax table
populateTaxTable1();    
  
  

} else  if ( textbox11.value === "أفراد | أشخاص طبيعية" && textbox10.value >=1998 && textbox14.value === "متزوج ولا يعول أولاد" && textbox1.value < 2500 ) {
   let caption = "عفوا صافي الدخل الخاضع للضريبة لم يتجاوز حد الإعفاء للأعباء العائلية المقررة قانونا للحالة الإجتماعية :" + " " + textbox14.value + " " + "وهي " + "2500 جنية " + " " + "وفقا لقانون 162 لسنة 1997";
    showPopup( caption, 'error'); 
    textbox8.value = "";
    textbox6.value = "";         
    textbox3.value = "";
    textbox4.value = "";
// Function to populate tax table
    const table = document.getElementById("taxTable");

    const table1 = document.getElementById("taxTable1");  
  
    // Clear the table data (excluding header row)
    while (table.rows.length > 1) {
        table.deleteRow(1);
    }
    while (table1.rows.length > 1) {
        table1.deleteRow(1);
    }
    return;    
  
  
  
  
  
} else  if ( textbox11.value === "أفراد | أشخاص طبيعية" && textbox10.value >=1998 && textbox14.value === "غير متزوج ويعول ولدا أو أكثر" && textbox1.value >= 2500 ) {
    income1 = income - 2500
    if (income1 <= 2500) {
    tax = income1 * 20 / 100;
    } else if (income1 <= 7000) {
    tax =  2500 * 20 / 100 + (income1 - 2500) * 27 / 100;
    } else if (income1 <= 16000) {
    tax = 2500 * 20 / 100 + 4500 * 27 / 100 + (income1 - 7000) * 35 / 100;
    } else {
    tax = 4865 + (income1 - 16000) * 40 / 100;
    }            
   let caption = "تم حساب الضريبة بنجاح ! " + "الكيان القانوني : " + ( textbox11.value ) + "  " + " صافي الدخل الخاضع للضريبة : " + ( textbox1.value ) + " جنية " + " " + "السنة الضريبية : " + ( textbox10.value ) + " " + " الضريبة المستحقة : " + ( tax ) + " جنية ";
    showPopup( caption, 'info');   
  
// Define tax brackets
let netIncome = income1; // هذا مبلغ الدخل الصافي الذي ترغب في حساب الضريبة عليه

let taxBrackets;

if (netIncome <= 2500) {
  taxBrackets = [
    { minIncome: 1, maxIncome: income1, taxRate: 20, fixedTax: income1 * 20 / 100 }
  ];
} else if (netIncome <= 7000) {
  taxBrackets = [
    { minIncome: 1, maxIncome: 2500, taxRate: 20, fixedTax: 2500 * 20 / 100 },
    { minIncome: 2, maxIncome: income1 - 2500, taxRate: 27, fixedTax: (income1 - 2500) * 27 / 100 }
  ];
} else if (netIncome <= 16000) {
  taxBrackets = [
    { minIncome: 1, maxIncome: 2500, taxRate: 20, fixedTax: 2500 * 20 / 100 },
    { minIncome: 2, maxIncome: 4500, taxRate: 27, fixedTax: 4500 * 27 / 100 },
    { minIncome: 3, maxIncome: income1 - 7000, taxRate: 35, fixedTax: (income1 - 7000) * 35 / 100 }
  ]; 
} else {
  taxBrackets = [
    { minIncome: 1, maxIncome: 2500, taxRate: 20, fixedTax: 2500 * 20 / 100 },
    { minIncome: 2, maxIncome: 4500, taxRate: 27, fixedTax: 4500 * 27 / 100 },
    { minIncome: 3, maxIncome: 9000, taxRate: 35, fixedTax: 9000 * 35 / 100 },  
    { minIncome: 4, maxIncome: income1 - 16000, taxRate: 40, fixedTax: (income1 - 16000) * 40 / 100 }
  ];
}
  
console.log(taxBrackets);
// Function to populate tax table
function populateTaxTable() {
    const table = document.getElementById("taxTable");

    const table1 = document.getElementById("taxTable1");  
  
    // Clear the table data (excluding header row)
    while (table.rows.length > 1) {
        table.deleteRow(1);
    }
    while (table1.rows.length > 1) {
        table1.deleteRow(1);
    }

    // Populate the table with new data
    taxBrackets.forEach(bracket => {
        const row = table.insertRow(-1);
        const minIncomeCell = row.insertCell(0);
        const maxIncomeCell = row.insertCell(1);
        const taxRateCell = row.insertCell(2);
        const taxDueCell = row.insertCell(3);
        const remainingIncomeCell = row.insertCell(4); // Added cell for remaining income
        
        minIncomeCell.textContent = bracket.minIncome.toLocaleString(); // Display minimum income
        maxIncomeCell.textContent = bracket.maxIncome === Infinity ? "Infinity" : bracket.maxIncome.toLocaleString(); // Display maximum income
        taxRateCell.textContent = bracket.taxRate + "%"; // Display tax rate
        taxDueCell.textContent = bracket.fixedTax.toLocaleString(); // Display fixed tax amount
        const remainingIncome = bracket.maxIncome === Infinity ? 0 : bracket.maxIncome - bracket.fixedTax; // Calculate remaining income
        remainingIncomeCell.textContent = remainingIncome.toLocaleString(); // Display remaining income
    });
}


// Call the function to populate the tax table
populateTaxTable();
  
  
  
// جدول الأعباء العائلية  
// Define tax brackets
let netIncome1 = income1; // هذا مبلغ الدخل الصافي الذي ترغب في حساب الضريبة عليه

let taxBrackets1;

if (netIncome1 <= 2500) {
  taxBrackets1 = [
    { minIncome: 1, maxIncome: textbox14.value, taxRate: -2500, fixedTax: income1 }
  ];
} else if (netIncome1 <= 7000) {
  taxBrackets1 = [
    { minIncome: 1, maxIncome: textbox14.value, taxRate: -2500, fixedTax: income1 }
  ];
} else if (netIncome1 <= 16000) {
  taxBrackets1 = [
    { minIncome: 1, maxIncome: textbox14.value, taxRate: -2500, fixedTax: income1 }
  ];
} else {
  taxBrackets1 = [
    { minIncome: 1, maxIncome: textbox14.value, taxRate: -2500, fixedTax: income1 }
  ];
}

console.log(taxBrackets1);
// Function to populate tax table
function populateTaxTable1() {

    const table1 = document.getElementById("taxTable1");  
  
    // Clear the table data (excluding header row)
    while (table1.rows.length > 1) {
        table1.deleteRow(1);
    }

    // Populate the table with new data
    taxBrackets1.forEach(bracket1 => {
        const row = table1.insertRow(-1);
        const minIncomeCell = row.insertCell(0);
        const maxIncomeCell = row.insertCell(1);
        const taxRateCell = row.insertCell(2);
        const taxDueCell = row.insertCell(3);
        const remainingIncomeCell = row.insertCell(4); // Added cell for remaining income
        
        minIncomeCell.textContent = bracket1.minIncome.toLocaleString(); // Display minimum income
        maxIncomeCell.textContent = bracket1.maxIncome === Infinity ? "Infinity" : bracket1.maxIncome.toLocaleString(); // Display maximum income
        taxRateCell.textContent = bracket1.taxRate + ""; // Display tax rate
        taxDueCell.textContent = bracket1.fixedTax.toLocaleString(); // Display fixed tax amount
        const remainingIncome = bracket1.maxIncome === Infinity ? 0 : bracket1.maxIncome - bracket1.fixedTax; // Calculate remaining income
    });
}


// Call the function to populate the tax table
populateTaxTable1();    
  
  

} else  if ( textbox11.value === "أفراد | أشخاص طبيعية" && textbox10.value >=1998 && textbox14.value === "غير متزوج ويعول ولدا أو أكثر" && textbox1.value < 2500 ) {
   let caption = "عفوا صافي الدخل الخاضع للضريبة لم يتجاوز حد الإعفاء للأعباء العائلية المقررة قانونا للحالة الإجتماعية :" + " " + textbox14.value + " " + "وهي " + "2500 جنية " + " " + "وفقا لقانون 162 لسنة 1997";
    showPopup( caption, 'error'); 
    textbox8.value = "";
    textbox6.value = "";          
    textbox3.value = "";
    textbox4.value = "";
// Function to populate tax table
    const table = document.getElementById("taxTable");

    const table1 = document.getElementById("taxTable1");  
  
    // Clear the table data (excluding header row)
    while (table.rows.length > 1) {
        table.deleteRow(1);
    }
    while (table1.rows.length > 1) {
        table1.deleteRow(1);
    }
    return;      
  
  
  
} else  if ( textbox11.value === "أفراد | أشخاص طبيعية" && textbox10.value >=1998 && textbox14.value === "متزوج ويعول ولدا أو أكثر" && textbox1.value >= 3000 ) {
    income1 = income - 3000
    if (income1 <= 2500) {
    tax = income1 * 20 / 100;
    } else if (income1 <= 7000) {
    tax =  2500 * 20 / 100 + (income1 - 2500) * 27 / 100;
    } else if (income1 <= 16000) {
    tax = 2500 * 20 / 100 + 4500 * 27 / 100 + (income1 - 7000) * 35 / 100;
    } else {
    tax = 4865 + (income1 - 16000) * 40 / 100;
    }            
   let caption = "تم حساب الضريبة بنجاح ! " + "الكيان القانوني : " + ( textbox11.value ) + "  " + " صافي الدخل الخاضع للضريبة : " + ( textbox1.value ) + " جنية " + " " + "السنة الضريبية : " + ( textbox10.value ) + " " + " الضريبة المستحقة : " + ( tax ) + " جنية ";
    showPopup( caption, 'info');   
  
// Define tax brackets
let netIncome = income1; // هذا مبلغ الدخل الصافي الذي ترغب في حساب الضريبة عليه

let taxBrackets;

if (netIncome <= 2500) {
  taxBrackets = [
    { minIncome: 1, maxIncome: income1, taxRate: 20, fixedTax: income1 * 20 / 100 }
  ];
} else if (netIncome <= 7000) {
  taxBrackets = [
    { minIncome: 1, maxIncome: 2500, taxRate: 20, fixedTax: 2500 * 20 / 100 },
    { minIncome: 2, maxIncome: income1 - 2500, taxRate: 27, fixedTax: (income1 - 2500) * 27 / 100 }
  ];
} else if (netIncome <= 16000) {
  taxBrackets = [
    { minIncome: 1, maxIncome: 2500, taxRate: 20, fixedTax: 2500 * 20 / 100 },
    { minIncome: 2, maxIncome: 4500, taxRate: 27, fixedTax: 4500 * 27 / 100 },
    { minIncome: 3, maxIncome: income1 - 7000, taxRate: 35, fixedTax: (income1 - 7000) * 35 / 100 }
  ]; 
} else {
  taxBrackets = [
    { minIncome: 1, maxIncome: 2500, taxRate: 20, fixedTax: 2500 * 20 / 100 },
    { minIncome: 2, maxIncome: 4500, taxRate: 27, fixedTax: 4500 * 27 / 100 },
    { minIncome: 3, maxIncome: 9000, taxRate: 35, fixedTax: 9000 * 35 / 100 },  
    { minIncome: 4, maxIncome: income1 - 16000, taxRate: 40, fixedTax: (income1 - 16000) * 40 / 100 }
  ];
}
  
console.log(taxBrackets);
// Function to populate tax table
function populateTaxTable() {
    const table = document.getElementById("taxTable");

    const table1 = document.getElementById("taxTable1");  
  
    // Clear the table data (excluding header row)
    while (table.rows.length > 1) {
        table.deleteRow(1);
    }
    while (table1.rows.length > 1) {
        table1.deleteRow(1);
    }

    // Populate the table with new data
    taxBrackets.forEach(bracket => {
        const row = table.insertRow(-1);
        const minIncomeCell = row.insertCell(0);
        const maxIncomeCell = row.insertCell(1);
        const taxRateCell = row.insertCell(2);
        const taxDueCell = row.insertCell(3);
        const remainingIncomeCell = row.insertCell(4); // Added cell for remaining income
        
        minIncomeCell.textContent = bracket.minIncome.toLocaleString(); // Display minimum income
        maxIncomeCell.textContent = bracket.maxIncome === Infinity ? "Infinity" : bracket.maxIncome.toLocaleString(); // Display maximum income
        taxRateCell.textContent = bracket.taxRate + "%"; // Display tax rate
        taxDueCell.textContent = bracket.fixedTax.toLocaleString(); // Display fixed tax amount
        const remainingIncome = bracket.maxIncome === Infinity ? 0 : bracket.maxIncome - bracket.fixedTax; // Calculate remaining income
        remainingIncomeCell.textContent = remainingIncome.toLocaleString(); // Display remaining income
    });
}


// Call the function to populate the tax table
populateTaxTable();
  
  
  
// جدول الأعباء العائلية  
// Define tax brackets
let netIncome1 = income1; // هذا مبلغ الدخل الصافي الذي ترغب في حساب الضريبة عليه

let taxBrackets1;

if (netIncome1 <= 2500) {
  taxBrackets1 = [
    { minIncome: 1, maxIncome: textbox14.value, taxRate: -3000, fixedTax: income1 }
  ];
} else if (netIncome1 <= 7000) {
  taxBrackets1 = [
    { minIncome: 1, maxIncome: textbox14.value, taxRate: -3000, fixedTax: income1 }
  ];
} else if (netIncome1 <= 16000) {
  taxBrackets1 = [
    { minIncome: 1, maxIncome: textbox14.value, taxRate: -3000, fixedTax: income1 }
  ];
} else {
  taxBrackets1 = [
    { minIncome: 1, maxIncome: textbox14.value, taxRate: -3000, fixedTax: income1 }
  ];
}

console.log(taxBrackets1);
// Function to populate tax table
function populateTaxTable1() {

    const table1 = document.getElementById("taxTable1");  
  
    // Clear the table data (excluding header row)
    while (table1.rows.length > 1) {
        table1.deleteRow(1);
    }

    // Populate the table with new data
    taxBrackets1.forEach(bracket1 => {
        const row = table1.insertRow(-1);
        const minIncomeCell = row.insertCell(0);
        const maxIncomeCell = row.insertCell(1);
        const taxRateCell = row.insertCell(2);
        const taxDueCell = row.insertCell(3);
        const remainingIncomeCell = row.insertCell(4); // Added cell for remaining income
        
        minIncomeCell.textContent = bracket1.minIncome.toLocaleString(); // Display minimum income
        maxIncomeCell.textContent = bracket1.maxIncome === Infinity ? "Infinity" : bracket1.maxIncome.toLocaleString(); // Display maximum income
        taxRateCell.textContent = bracket1.taxRate + ""; // Display tax rate
        taxDueCell.textContent = bracket1.fixedTax.toLocaleString(); // Display fixed tax amount
        const remainingIncome = bracket1.maxIncome === Infinity ? 0 : bracket1.maxIncome - bracket1.fixedTax; // Calculate remaining income
    });
}


// Call the function to populate the tax table
populateTaxTable1();    
  
  

} else  if ( textbox11.value === "أفراد | أشخاص طبيعية" && textbox10.value >=1998 && textbox14.value === "متزوج ويعول ولدا أو أكثر" && textbox1.value < 3000 ) {
   let caption = "عفوا صافي الدخل الخاضع للضريبة لم يتجاوز حد الإعفاء للأعباء العائلية المقررة قانونا للحالة الإجتماعية :" + " " + textbox14.value + " " + "وهي " + "3000 جنية " + " " + "وفقا لقانون 162 لسنة 1997";
    showPopup( caption, 'error'); 
    textbox8.value = "";
    textbox6.value = "";         
    textbox3.value = "";
    textbox4.value = "";
// Function to populate tax table
    const table = document.getElementById("taxTable");

    const table1 = document.getElementById("taxTable1");  
  
    // Clear the table data (excluding header row)
    while (table.rows.length > 1) {
        table.deleteRow(1);
    }
    while (table1.rows.length > 1) {
        table1.deleteRow(1);
    }
    return;   
  
 
  
  
  
} else  if ( textbox11.value === "شركات | شركات الأشخاص" && textbox10.value >=1998 && textbox14.value === "أعزب" && textbox1.value >= 2000 ) {
    income1 = income - 2000
    if (income1 <= 2500) {
    tax = income1 * 20 / 100;
    } else if (income1 <= 7000) {
    tax =  2500 * 20 / 100 + (income1 - 2500) * 27 / 100;
    } else if (income1 <= 16000) {
    tax = 2500 * 20 / 100 + 4500 * 27 / 100 + (income1 - 7000) * 35 / 100;
    } else {
    tax = 4865 + (income1 - 16000) * 40 / 100;
    }            
   let caption = "تم حساب الضريبة بنجاح ! " + "الكيان القانوني : " + ( textbox11.value ) + "  " + " صافي الدخل الخاضع للضريبة : " + ( textbox1.value ) + " جنية " + " " + "السنة الضريبية : " + ( textbox10.value ) + " " + " الضريبة المستحقة : " + ( tax ) + " جنية ";
    showPopup( caption, 'info');   
  
// Define tax brackets
let netIncome = income1; // هذا مبلغ الدخل الصافي الذي ترغب في حساب الضريبة عليه

let taxBrackets;

if (netIncome <= 2500) {
  taxBrackets = [
    { minIncome: 1, maxIncome: income1, taxRate: 20, fixedTax: income1 * 20 / 100 }
  ];
} else if (netIncome <= 7000) {
  taxBrackets = [
    { minIncome: 1, maxIncome: 2500, taxRate: 20, fixedTax: 2500 * 20 / 100 },
    { minIncome: 2, maxIncome: income1 - 2500, taxRate: 27, fixedTax: (income1 - 2500) * 27 / 100 }
  ];
} else if (netIncome <= 16000) {
  taxBrackets = [
    { minIncome: 1, maxIncome: 2500, taxRate: 20, fixedTax: 2500 * 20 / 100 },
    { minIncome: 2, maxIncome: 4500, taxRate: 27, fixedTax: 4500 * 27 / 100 },
    { minIncome: 3, maxIncome: income1 - 7000, taxRate: 35, fixedTax: (income1 - 7000) * 35 / 100 }
  ]; 
} else {
  taxBrackets = [
    { minIncome: 1, maxIncome: 2500, taxRate: 20, fixedTax: 2500 * 20 / 100 },
    { minIncome: 2, maxIncome: 4500, taxRate: 27, fixedTax: 4500 * 27 / 100 },
    { minIncome: 3, maxIncome: 9000, taxRate: 35, fixedTax: 9000 * 35 / 100 },  
    { minIncome: 4, maxIncome: income1 - 16000, taxRate: 40, fixedTax: (income1 - 16000) * 40 / 100 }
  ];
}
  
console.log(taxBrackets);
// Function to populate tax table
function populateTaxTable() {
    const table = document.getElementById("taxTable");

    const table1 = document.getElementById("taxTable1");  
  
    // Clear the table data (excluding header row)
    while (table.rows.length > 1) {
        table.deleteRow(1);
    }
    while (table1.rows.length > 1) {
        table1.deleteRow(1);
    }

    // Populate the table with new data
    taxBrackets.forEach(bracket => {
        const row = table.insertRow(-1);
        const minIncomeCell = row.insertCell(0);
        const maxIncomeCell = row.insertCell(1);
        const taxRateCell = row.insertCell(2);
        const taxDueCell = row.insertCell(3);
        const remainingIncomeCell = row.insertCell(4); // Added cell for remaining income
        
        minIncomeCell.textContent = bracket.minIncome.toLocaleString(); // Display minimum income
        maxIncomeCell.textContent = bracket.maxIncome === Infinity ? "Infinity" : bracket.maxIncome.toLocaleString(); // Display maximum income
        taxRateCell.textContent = bracket.taxRate + "%"; // Display tax rate
        taxDueCell.textContent = bracket.fixedTax.toLocaleString(); // Display fixed tax amount
        const remainingIncome = bracket.maxIncome === Infinity ? 0 : bracket.maxIncome - bracket.fixedTax; // Calculate remaining income
        remainingIncomeCell.textContent = remainingIncome.toLocaleString(); // Display remaining income
    });
}


// Call the function to populate the tax table
populateTaxTable();
  
  
  
// جدول الأعباء العائلية  
// Define tax brackets
let netIncome1 = income1; // هذا مبلغ الدخل الصافي الذي ترغب في حساب الضريبة عليه

let taxBrackets1;

if (netIncome1 <= 2500) {
  taxBrackets1 = [
    { minIncome: 1, maxIncome: textbox14.value, taxRate: -2000, fixedTax: income1 }
  ];
} else if (netIncome1 <= 7000) {
  taxBrackets1 = [
    { minIncome: 1, maxIncome: textbox14.value, taxRate: -2000, fixedTax: income1 }
  ];
} else if (netIncome1 <= 16000) {
  taxBrackets1 = [
    { minIncome: 1, maxIncome: textbox14.value, taxRate: -2000, fixedTax: income1 }
  ];
} else {
  taxBrackets1 = [
    { minIncome: 1, maxIncome: textbox14.value, taxRate: -2000, fixedTax: income1 }
  ];
}

console.log(taxBrackets1);
// Function to populate tax table
function populateTaxTable1() {

    const table1 = document.getElementById("taxTable1");  
  
    // Clear the table data (excluding header row)
    while (table1.rows.length > 1) {
        table1.deleteRow(1);
    }

    // Populate the table with new data
    taxBrackets1.forEach(bracket1 => {
        const row = table1.insertRow(-1);
        const minIncomeCell = row.insertCell(0);
        const maxIncomeCell = row.insertCell(1);
        const taxRateCell = row.insertCell(2);
        const taxDueCell = row.insertCell(3);
        const remainingIncomeCell = row.insertCell(4); // Added cell for remaining income
        
        minIncomeCell.textContent = bracket1.minIncome.toLocaleString(); // Display minimum income
        maxIncomeCell.textContent = bracket1.maxIncome === Infinity ? "Infinity" : bracket1.maxIncome.toLocaleString(); // Display maximum income
        taxRateCell.textContent = bracket1.taxRate + ""; // Display tax rate
        taxDueCell.textContent = bracket1.fixedTax.toLocaleString(); // Display fixed tax amount
        const remainingIncome = bracket1.maxIncome === Infinity ? 0 : bracket1.maxIncome - bracket1.fixedTax; // Calculate remaining income
    });
}


// Call the function to populate the tax table
populateTaxTable1();    
  
  

} else  if ( textbox11.value === "شركات | شركات الأشخاص" && textbox10.value >=1998 && textbox14.value === "أعزب" && textbox1.value < 2000 ) {
   let caption = "عفوا صافي الدخل الخاضع للضريبة لم يتجاوز حد الإعفاء للأعباء العائلية المقررة قانونا للحالة الإجتماعية :" + " " + textbox14.value + " " + "وهي " + "2000 جنية " + " " + "وفقا لقانون 162 لسنة 1997";
    showPopup( caption, 'error'); 

    textbox8.value = "";
    textbox6.value = "";          
    textbox3.value = "";
    textbox4.value = "";
// Function to populate tax table
    const table = document.getElementById("taxTable");

    const table1 = document.getElementById("taxTable1");  
  
    // Clear the table data (excluding header row)
    while (table.rows.length > 1) {
        table.deleteRow(1);
    }
    while (table1.rows.length > 1) {
        table1.deleteRow(1);
    }
    return;  
  
  
  
  
  
} else  if ( textbox11.value === "شركات | شركات الأشخاص" && textbox10.value >=1998 && textbox14.value === "متزوج ولا يعول أولاد" && textbox1.value >= 2500 ) {
    income1 = income - 2500
    if (income1 <= 2500) {
    tax = income1 * 20 / 100;
    } else if (income1 <= 7000) {
    tax =  2500 * 20 / 100 + (income1 - 2500) * 27 / 100;
    } else if (income1 <= 16000) {
    tax = 2500 * 20 / 100 + 4500 * 27 / 100 + (income1 - 7000) * 35 / 100;
    } else {
    tax = 4865 + (income1 - 16000) * 40 / 100;
    }            
   let caption = "تم حساب الضريبة بنجاح ! " + "الكيان القانوني : " + ( textbox11.value ) + "  " + " صافي الدخل الخاضع للضريبة : " + ( textbox1.value ) + " جنية " + " " + "السنة الضريبية : " + ( textbox10.value ) + " " + " الضريبة المستحقة : " + ( tax ) + " جنية ";
    showPopup( caption, 'info');   
  
// Define tax brackets
let netIncome = income1; // هذا مبلغ الدخل الصافي الذي ترغب في حساب الضريبة عليه

let taxBrackets;

if (netIncome <= 2500) {
  taxBrackets = [
    { minIncome: 1, maxIncome: income1, taxRate: 20, fixedTax: income1 * 20 / 100 }
  ];
} else if (netIncome <= 7000) {
  taxBrackets = [
    { minIncome: 1, maxIncome: 2500, taxRate: 20, fixedTax: 2500 * 20 / 100 },
    { minIncome: 2, maxIncome: income1 - 2500, taxRate: 27, fixedTax: (income1 - 2500) * 27 / 100 }
  ];
} else if (netIncome <= 16000) {
  taxBrackets = [
    { minIncome: 1, maxIncome: 2500, taxRate: 20, fixedTax: 2500 * 20 / 100 },
    { minIncome: 2, maxIncome: 4500, taxRate: 27, fixedTax: 4500 * 27 / 100 },
    { minIncome: 3, maxIncome: income1 - 7000, taxRate: 35, fixedTax: (income1 - 7000) * 35 / 100 }
  ]; 
} else {
  taxBrackets = [
    { minIncome: 1, maxIncome: 2500, taxRate: 20, fixedTax: 2500 * 20 / 100 },
    { minIncome: 2, maxIncome: 4500, taxRate: 27, fixedTax: 4500 * 27 / 100 },
    { minIncome: 3, maxIncome: 9000, taxRate: 35, fixedTax: 9000 * 35 / 100 },  
    { minIncome: 4, maxIncome: income1 - 16000, taxRate: 40, fixedTax: (income1 - 16000) * 40 / 100 }
  ];
}
  
console.log(taxBrackets);
// Function to populate tax table
function populateTaxTable() {
    const table = document.getElementById("taxTable");

    const table1 = document.getElementById("taxTable1");  
  
    // Clear the table data (excluding header row)
    while (table.rows.length > 1) {
        table.deleteRow(1);
    }
    while (table1.rows.length > 1) {
        table1.deleteRow(1);
    }

    // Populate the table with new data
    taxBrackets.forEach(bracket => {
        const row = table.insertRow(-1);
        const minIncomeCell = row.insertCell(0);
        const maxIncomeCell = row.insertCell(1);
        const taxRateCell = row.insertCell(2);
        const taxDueCell = row.insertCell(3);
        const remainingIncomeCell = row.insertCell(4); // Added cell for remaining income
        
        minIncomeCell.textContent = bracket.minIncome.toLocaleString(); // Display minimum income
        maxIncomeCell.textContent = bracket.maxIncome === Infinity ? "Infinity" : bracket.maxIncome.toLocaleString(); // Display maximum income
        taxRateCell.textContent = bracket.taxRate + "%"; // Display tax rate
        taxDueCell.textContent = bracket.fixedTax.toLocaleString(); // Display fixed tax amount
        const remainingIncome = bracket.maxIncome === Infinity ? 0 : bracket.maxIncome - bracket.fixedTax; // Calculate remaining income
        remainingIncomeCell.textContent = remainingIncome.toLocaleString(); // Display remaining income
    });
}


// Call the function to populate the tax table
populateTaxTable();
  
  
  
// جدول الأعباء العائلية  
// Define tax brackets
let netIncome1 = income1; // هذا مبلغ الدخل الصافي الذي ترغب في حساب الضريبة عليه

let taxBrackets1;

if (netIncome1 <= 2500) {
  taxBrackets1 = [
    { minIncome: 1, maxIncome: textbox14.value, taxRate: -2500, fixedTax: income1 }
  ];
} else if (netIncome1 <= 7000) {
  taxBrackets1 = [
    { minIncome: 1, maxIncome: textbox14.value, taxRate: -2500, fixedTax: income1 }
  ];
} else if (netIncome1 <= 16000) {
  taxBrackets1 = [
    { minIncome: 1, maxIncome: textbox14.value, taxRate: -2500, fixedTax: income1 }
  ];
} else {
  taxBrackets1 = [
    { minIncome: 1, maxIncome: textbox14.value, taxRate: -2500, fixedTax: income1 }
  ];
}

console.log(taxBrackets1);
// Function to populate tax table
function populateTaxTable1() {

    const table1 = document.getElementById("taxTable1");  
  
    // Clear the table data (excluding header row)
    while (table1.rows.length > 1) {
        table1.deleteRow(1);
    }

    // Populate the table with new data
    taxBrackets1.forEach(bracket1 => {
        const row = table1.insertRow(-1);
        const minIncomeCell = row.insertCell(0);
        const maxIncomeCell = row.insertCell(1);
        const taxRateCell = row.insertCell(2);
        const taxDueCell = row.insertCell(3);
        const remainingIncomeCell = row.insertCell(4); // Added cell for remaining income
        
        minIncomeCell.textContent = bracket1.minIncome.toLocaleString(); // Display minimum income
        maxIncomeCell.textContent = bracket1.maxIncome === Infinity ? "Infinity" : bracket1.maxIncome.toLocaleString(); // Display maximum income
        taxRateCell.textContent = bracket1.taxRate + ""; // Display tax rate
        taxDueCell.textContent = bracket1.fixedTax.toLocaleString(); // Display fixed tax amount
        const remainingIncome = bracket1.maxIncome === Infinity ? 0 : bracket1.maxIncome - bracket1.fixedTax; // Calculate remaining income
    });
}


// Call the function to populate the tax table
populateTaxTable1();    
  
  

} else  if ( textbox11.value === "شركات | شركات الأشخاص" && textbox10.value >=1998 && textbox14.value === "متزوج ولا يعول أولاد" && textbox1.value < 2500 ) {
   let caption = "عفوا صافي الدخل الخاضع للضريبة لم يتجاوز حد الإعفاء للأعباء العائلية المقررة قانونا للحالة الإجتماعية :" + " " + textbox14.value + " " + "وهي " + "2500 جنية " + " " + "وفقا لقانون 162 لسنة 1997";
    showPopup( caption, 'error'); 
    textbox8.value = "";
    textbox6.value = "";         
    textbox3.value = "";
    textbox4.value = "";
// Function to populate tax table
    const table = document.getElementById("taxTable");

    const table1 = document.getElementById("taxTable1");  
  
    // Clear the table data (excluding header row)
    while (table.rows.length > 1) {
        table.deleteRow(1);
    }
    while (table1.rows.length > 1) {
        table1.deleteRow(1);
    }
    return;      
  
  
  
  
} else  if ( textbox11.value === "شركات | شركات الأشخاص" && textbox10.value >=1998 && textbox14.value === "غير متزوج ويعول ولدا أو أكثر" && textbox1.value >= 2500 ) {
    income1 = income - 2500
    if (income1 <= 2500) {
    tax = income1 * 20 / 100;
    } else if (income1 <= 7000) {
    tax =  2500 * 20 / 100 + (income1 - 2500) * 27 / 100;
    } else if (income1 <= 16000) {
    tax = 2500 * 20 / 100 + 4500 * 27 / 100 + (income1 - 7000) * 35 / 100;
    } else {
    tax = 4865 + (income1 - 16000) * 40 / 100;
    }            
   let caption = "تم حساب الضريبة بنجاح ! " + "الكيان القانوني : " + ( textbox11.value ) + "  " + " صافي الدخل الخاضع للضريبة : " + ( textbox1.value ) + " جنية " + " " + "السنة الضريبية : " + ( textbox10.value ) + " " + " الضريبة المستحقة : " + ( tax ) + " جنية ";
    showPopup( caption, 'info');   
  
// Define tax brackets
let netIncome = income1; // هذا مبلغ الدخل الصافي الذي ترغب في حساب الضريبة عليه

let taxBrackets;

if (netIncome <= 2500) {
  taxBrackets = [
    { minIncome: 1, maxIncome: income1, taxRate: 20, fixedTax: income1 * 20 / 100 }
  ];
} else if (netIncome <= 7000) {
  taxBrackets = [
    { minIncome: 1, maxIncome: 2500, taxRate: 20, fixedTax: 2500 * 20 / 100 },
    { minIncome: 2, maxIncome: income1 - 2500, taxRate: 27, fixedTax: (income1 - 2500) * 27 / 100 }
  ];
} else if (netIncome <= 16000) {
  taxBrackets = [
    { minIncome: 1, maxIncome: 2500, taxRate: 20, fixedTax: 2500 * 20 / 100 },
    { minIncome: 2, maxIncome: 4500, taxRate: 27, fixedTax: 4500 * 27 / 100 },
    { minIncome: 3, maxIncome: income1 - 7000, taxRate: 35, fixedTax: (income1 - 7000) * 35 / 100 }
  ]; 
} else {
  taxBrackets = [
    { minIncome: 1, maxIncome: 2500, taxRate: 20, fixedTax: 2500 * 20 / 100 },
    { minIncome: 2, maxIncome: 4500, taxRate: 27, fixedTax: 4500 * 27 / 100 },
    { minIncome: 3, maxIncome: 9000, taxRate: 35, fixedTax: 9000 * 35 / 100 },  
    { minIncome: 4, maxIncome: income1 - 16000, taxRate: 40, fixedTax: (income1 - 16000) * 40 / 100 }
  ];
}
  
console.log(taxBrackets);
// Function to populate tax table
function populateTaxTable() {
    const table = document.getElementById("taxTable");

    const table1 = document.getElementById("taxTable1");  
  
    // Clear the table data (excluding header row)
    while (table.rows.length > 1) {
        table.deleteRow(1);
    }
    while (table1.rows.length > 1) {
        table1.deleteRow(1);
    }

    // Populate the table with new data
    taxBrackets.forEach(bracket => {
        const row = table.insertRow(-1);
        const minIncomeCell = row.insertCell(0);
        const maxIncomeCell = row.insertCell(1);
        const taxRateCell = row.insertCell(2);
        const taxDueCell = row.insertCell(3);
        const remainingIncomeCell = row.insertCell(4); // Added cell for remaining income
        
        minIncomeCell.textContent = bracket.minIncome.toLocaleString(); // Display minimum income
        maxIncomeCell.textContent = bracket.maxIncome === Infinity ? "Infinity" : bracket.maxIncome.toLocaleString(); // Display maximum income
        taxRateCell.textContent = bracket.taxRate + "%"; // Display tax rate
        taxDueCell.textContent = bracket.fixedTax.toLocaleString(); // Display fixed tax amount
        const remainingIncome = bracket.maxIncome === Infinity ? 0 : bracket.maxIncome - bracket.fixedTax; // Calculate remaining income
        remainingIncomeCell.textContent = remainingIncome.toLocaleString(); // Display remaining income
    });
}


// Call the function to populate the tax table
populateTaxTable();
  
  
  
// جدول الأعباء العائلية  
// Define tax brackets
let netIncome1 = income1; // هذا مبلغ الدخل الصافي الذي ترغب في حساب الضريبة عليه

let taxBrackets1;

if (netIncome1 <= 2500) {
  taxBrackets1 = [
    { minIncome: 1, maxIncome: textbox14.value, taxRate: -2500, fixedTax: income1 }
  ];
} else if (netIncome1 <= 7000) {
  taxBrackets1 = [
    { minIncome: 1, maxIncome: textbox14.value, taxRate: -2500, fixedTax: income1 }
  ];
} else if (netIncome1 <= 16000) {
  taxBrackets1 = [
    { minIncome: 1, maxIncome: textbox14.value, taxRate: -2500, fixedTax: income1 }
  ];
} else {
  taxBrackets1 = [
    { minIncome: 1, maxIncome: textbox14.value, taxRate: -2500, fixedTax: income1 }
  ];
}

console.log(taxBrackets1);
// Function to populate tax table
function populateTaxTable1() {

    const table1 = document.getElementById("taxTable1");  
  
    // Clear the table data (excluding header row)
    while (table1.rows.length > 1) {
        table1.deleteRow(1);
    }

    // Populate the table with new data
    taxBrackets1.forEach(bracket1 => {
        const row = table1.insertRow(-1);
        const minIncomeCell = row.insertCell(0);
        const maxIncomeCell = row.insertCell(1);
        const taxRateCell = row.insertCell(2);
        const taxDueCell = row.insertCell(3);
        const remainingIncomeCell = row.insertCell(4); // Added cell for remaining income
        
        minIncomeCell.textContent = bracket1.minIncome.toLocaleString(); // Display minimum income
        maxIncomeCell.textContent = bracket1.maxIncome === Infinity ? "Infinity" : bracket1.maxIncome.toLocaleString(); // Display maximum income
        taxRateCell.textContent = bracket1.taxRate + ""; // Display tax rate
        taxDueCell.textContent = bracket1.fixedTax.toLocaleString(); // Display fixed tax amount
        const remainingIncome = bracket1.maxIncome === Infinity ? 0 : bracket1.maxIncome - bracket1.fixedTax; // Calculate remaining income
    });
}


// Call the function to populate the tax table
populateTaxTable1();    
  
  

} else  if ( textbox11.value === "شركات | شركات الأشخاص" && textbox10.value >=1998 && textbox14.value === "غير متزوج ويعول ولدا أو أكثر" && textbox1.value < 2500 ) {
   let caption = "عفوا صافي الدخل الخاضع للضريبة لم يتجاوز حد الإعفاء للأعباء العائلية المقررة قانونا للحالة الإجتماعية :" + " " + textbox14.value + " " + "وهي " + "2500 جنية " + " " + "وفقا لقانون 162 لسنة 1997";
    showPopup( caption, 'error'); 

    textbox8.value = "";
    textbox6.value = "";         
    textbox3.value = "";
    textbox4.value = "";
// Function to populate tax table
    const table = document.getElementById("taxTable");

    const table1 = document.getElementById("taxTable1");  
  
    // Clear the table data (excluding header row)
    while (table.rows.length > 1) {
        table.deleteRow(1);
    }
    while (table1.rows.length > 1) {
        table1.deleteRow(1);
    }
    return;        
  
  

  
  
} else  if ( textbox11.value === "شركات | شركات الأشخاص" && textbox10.value >=1998 && textbox14.value === "متزوج ويعول ولدا أو أكثر" && textbox1.value >= 3000 ) {
    income1 = income - 3000
    if (income1 <= 2500) {
    tax = income1 * 20 / 100;
    } else if (income1 <= 7000) {
    tax =  2500 * 20 / 100 + (income1 - 2500) * 27 / 100;
    } else if (income1 <= 16000) {
    tax = 2500 * 20 / 100 + 4500 * 27 / 100 + (income1 - 7000) * 35 / 100;
    } else {
    tax = 4865 + (income1 - 16000) * 40 / 100;
    }            
   let caption = "تم حساب الضريبة بنجاح ! " + "الكيان القانوني : " + ( textbox11.value ) + "  " + " صافي الدخل الخاضع للضريبة : " + ( textbox1.value ) + " جنية " + " " + "السنة الضريبية : " + ( textbox10.value ) + " " + " الضريبة المستحقة : " + ( tax ) + " جنية ";
    showPopup( caption, 'info');   
  
// Define tax brackets
let netIncome = income1; // هذا مبلغ الدخل الصافي الذي ترغب في حساب الضريبة عليه

let taxBrackets;

if (netIncome <= 2500) {
  taxBrackets = [
    { minIncome: 1, maxIncome: income1, taxRate: 20, fixedTax: income1 * 20 / 100 }
  ];
} else if (netIncome <= 7000) {
  taxBrackets = [
    { minIncome: 1, maxIncome: 2500, taxRate: 20, fixedTax: 2500 * 20 / 100 },
    { minIncome: 2, maxIncome: income1 - 2500, taxRate: 27, fixedTax: (income1 - 2500) * 27 / 100 }
  ];
} else if (netIncome <= 16000) {
  taxBrackets = [
    { minIncome: 1, maxIncome: 2500, taxRate: 20, fixedTax: 2500 * 20 / 100 },
    { minIncome: 2, maxIncome: 4500, taxRate: 27, fixedTax: 4500 * 27 / 100 },
    { minIncome: 3, maxIncome: income1 - 7000, taxRate: 35, fixedTax: (income1 - 7000) * 35 / 100 }
  ]; 
} else {
  taxBrackets = [
    { minIncome: 1, maxIncome: 2500, taxRate: 20, fixedTax: 2500 * 20 / 100 },
    { minIncome: 2, maxIncome: 4500, taxRate: 27, fixedTax: 4500 * 27 / 100 },
    { minIncome: 3, maxIncome: 9000, taxRate: 35, fixedTax: 9000 * 35 / 100 },  
    { minIncome: 4, maxIncome: income1 - 16000, taxRate: 40, fixedTax: (income1 - 16000) * 40 / 100 }
  ];
}
  
console.log(taxBrackets);
// Function to populate tax table
function populateTaxTable() {
    const table = document.getElementById("taxTable");

    const table1 = document.getElementById("taxTable1");  
  
    // Clear the table data (excluding header row)
    while (table.rows.length > 1) {
        table.deleteRow(1);
    }
    while (table1.rows.length > 1) {
        table1.deleteRow(1);
    }

    // Populate the table with new data
    taxBrackets.forEach(bracket => {
        const row = table.insertRow(-1);
        const minIncomeCell = row.insertCell(0);
        const maxIncomeCell = row.insertCell(1);
        const taxRateCell = row.insertCell(2);
        const taxDueCell = row.insertCell(3);
        const remainingIncomeCell = row.insertCell(4); // Added cell for remaining income
        
        minIncomeCell.textContent = bracket.minIncome.toLocaleString(); // Display minimum income
        maxIncomeCell.textContent = bracket.maxIncome === Infinity ? "Infinity" : bracket.maxIncome.toLocaleString(); // Display maximum income
        taxRateCell.textContent = bracket.taxRate + "%"; // Display tax rate
        taxDueCell.textContent = bracket.fixedTax.toLocaleString(); // Display fixed tax amount
        const remainingIncome = bracket.maxIncome === Infinity ? 0 : bracket.maxIncome - bracket.fixedTax; // Calculate remaining income
        remainingIncomeCell.textContent = remainingIncome.toLocaleString(); // Display remaining income
    });
}


// Call the function to populate the tax table
populateTaxTable();
  
  
  
// جدول الأعباء العائلية  
// Define tax brackets
let netIncome1 = income1; // هذا مبلغ الدخل الصافي الذي ترغب في حساب الضريبة عليه

let taxBrackets1;

if (netIncome1 <= 2500) {
  taxBrackets1 = [
    { minIncome: 1, maxIncome: textbox14.value, taxRate: -3000, fixedTax: income1 }
  ];
} else if (netIncome1 <= 7000) {
  taxBrackets1 = [
    { minIncome: 1, maxIncome: textbox14.value, taxRate: -3000, fixedTax: income1 }
  ];
} else if (netIncome1 <= 16000) {
  taxBrackets1 = [
    { minIncome: 1, maxIncome: textbox14.value, taxRate: -3000, fixedTax: income1 }
  ];
} else {
  taxBrackets1 = [
    { minIncome: 1, maxIncome: textbox14.value, taxRate: -3000, fixedTax: income1 }
  ];
}

console.log(taxBrackets1);
// Function to populate tax table
function populateTaxTable1() {

    const table1 = document.getElementById("taxTable1");  
  
    // Clear the table data (excluding header row)
    while (table1.rows.length > 1) {
        table1.deleteRow(1);
    }

    // Populate the table with new data
    taxBrackets1.forEach(bracket1 => {
        const row = table1.insertRow(-1);
        const minIncomeCell = row.insertCell(0);
        const maxIncomeCell = row.insertCell(1);
        const taxRateCell = row.insertCell(2);
        const taxDueCell = row.insertCell(3);
        const remainingIncomeCell = row.insertCell(4); // Added cell for remaining income
        
        minIncomeCell.textContent = bracket1.minIncome.toLocaleString(); // Display minimum income
        maxIncomeCell.textContent = bracket1.maxIncome === Infinity ? "Infinity" : bracket1.maxIncome.toLocaleString(); // Display maximum income
        taxRateCell.textContent = bracket1.taxRate + ""; // Display tax rate
        taxDueCell.textContent = bracket1.fixedTax.toLocaleString(); // Display fixed tax amount
        const remainingIncome = bracket1.maxIncome === Infinity ? 0 : bracket1.maxIncome - bracket1.fixedTax; // Calculate remaining income
    });
}


// Call the function to populate the tax table
populateTaxTable1();    
  
  

} else  if ( textbox11.value === "شركات | شركات الأشخاص" && textbox10.value >=1998 && textbox14.value === "متزوج ويعول ولدا أو أكثر" && textbox1.value < 3000 ) {
   let caption = "عفوا صافي الدخل الخاضع للضريبة لم يتجاوز حد الإعفاء للأعباء العائلية المقررة قانونا للحالة الإجتماعية :" + " " + textbox14.value + " " + "وهي " + "3000 جنية " + " " + "وفقا لقانون 162 لسنة 1997";
    showPopup( caption, 'error');
    textbox8.value = "";
    textbox6.value = "";          
    textbox3.value = "";
    textbox4.value = "";
// Function to populate tax table
    const table = document.getElementById("taxTable");

    const table1 = document.getElementById("taxTable1");  
  
    // Clear the table data (excluding header row)
    while (table.rows.length > 1) {
        table.deleteRow(1);
    }
    while (table1.rows.length > 1) {
        table1.deleteRow(1);
    }
    return;     
    
  
    } else {
    alert("");
    textbox1.value = "";
    textbox2.value = "";
    textbox3.value = "";
    textbox4.value = "";
    textbox6.value = "";
    textbox5.value = "";
    textbox8.value = "";
    textbox9.value = "";
    return;
    }

    textbox4.value = tax;

    textbox5.value = caption;
    }

      
    </script>

        


    <script>

        document.getElementById("button4").addEventListener("click", function() {
        
        var str1 = parseInt(document.getElementById("textbox3").value);
        var str2 = parseInt(document.getElementById("textbox4").value);
        var textbox3 = document.getElementById("textbox3");  
        var textbox6 = document.getElementById("textbox6");         
        var textbox9 = document.getElementById("textbox9");
        var textbox8 = document.getElementById("textbox8");        
        var textbox10 = document.getElementById("textbox10");  
        var textbox11 = document.getElementById("textbox11");            
        var textbox13 = document.getElementById("textbox13");         
        var textbox14 = document.getElementById("textbox14");         
        
        
        const textbox1 = document.getElementById("textbox1");
        const textbox4 = document.getElementById("textbox4");
        
    if (textbox11.value === "-- اختر من القائمة الكيان القانوني --") {
    let caption = "يرجي إختيار الكيان القانوني";
    showPopup(caption, 'error'); 
    textbox11.focus();
    return;
      
    }
          
    if ( textbox11.value === "شركات | شركات الأشخاص" && textbox1.value === "" ) { 
    let caption = "يرجي إدخال صافي الدخل الخاضع للضريبة لكل شريك علي حدة ( إدخال الأرقام باللغة الإنجليزية )";
    showPopup(caption, 'error');      
    textbox1.value = "";               
    textbox1.focus();
    return;
    }           
          
    if (textbox1.value === "") {      
    let caption = "يرجي إدخال صافي الدخل الخاضع للضريبة ( إدخال الأرقام باللغة الإنجليزية )";
    showPopup(caption, 'error');        
    textbox1.value = "";               
    textbox1.focus();
    return;

    }
          
          
    if (textbox14.value === "-- اختر من القائمة الحالة الإجتماعية --") {
    let caption = "يرجي إختيار الحالة الإجتماعية";
    showPopup(caption, 'error');       
    textbox14.focus();
    return;
      
    }           

    if (textbox10.value === "-- اختر من القائمة السنة الضريبية --") {
    let caption = "يرجي إختيار السنة الضرييبة";
    showPopup(caption, 'error');       
    textbox10.focus();
    return;
      
    }
        
    if (textbox4.value === "") {
    let caption = "يرجي الضغط علي زر إحسب الضريبة المستحقة أولا";
    showPopup(caption, 'error'); 
    textbox4.focus();
    return;
    } 
          
          
    if (textbox13.value === "-- اختر من القائمة نوع المحاسبة --") {
    let caption = "يرجي إختيار نوع المحاسبة";
    showPopup(caption, 'error');       
    textbox13.focus();
    return;      
    }          
          
    if (textbox3.value === "") {
    let caption = "يرجي إدخال الضريبة من واقع الإقرار ( إدخال الأرقام باللغة الإنجليزية )";
    showPopup(caption, 'error');      
    textbox3.value = "";               
    textbox3.focus();
    return;
    }
          
    if (textbox9.value === "-- اختر من القائمة أساس الربط --") {
    let caption = "يرجي إختيار أساس الربط";
    showPopup(caption, 'error');       
    textbox8.value = "";
    textbox6.value = "";
    textbox9.focus();
    return;
    }


    let caption = "";
          
        function showAlert(message) {
            alert(message);
        }
        
                    
    if ( textbox10.value <=2004 && textbox13.value ==="تقديري غير مؤيد بمستندات" ) {
    textbox8.value = "";
    textbox6.value = ""; 
    let caption = "عفوا هذه السنوات خارج نطاق تطبيق المادة 87 مكرر علي التقديري وغير المؤيد بمستندات";
    showPopup(caption, 'error');                     
    textbox1.value = "";
    textbox3.value = "";
    textbox4.value = "";
    textbox6.value = "";
    textbox8.value = "";
    // Function to populate tax table
    const table = document.getElementById("taxTable");

    const table1 = document.getElementById("taxTable1");  
  
    // Clear the table data (excluding header row)
    while (table.rows.length > 1) {
        table.deleteRow(1);
    }
    while (table1.rows.length > 1) {
        table1.deleteRow(1);
    }
    return;
          

          
    } else if ( textbox10.value <=2004 && textbox13.value ==="دفتري ووارد بالعينة" ) {
    textbox8.value = "";
    textbox6.value = ""; 
    let caption = "عفوا هذه السنوات خارج نطاق تطبيق المادة 87 مكرر علي الدفتري والوارد بالعينة";
    showPopup(caption, 'error');       
    textbox1.value = "";
    textbox3.value = "";
    textbox4.value = "";
    textbox6.value = "";
    textbox8.value = "";
    // Function to populate tax table
    const table = document.getElementById("taxTable");

    const table1 = document.getElementById("taxTable1");  
  
    // Clear the table data (excluding header row)
    while (table.rows.length > 1) {
        table.deleteRow(1);
    }
    while (table1.rows.length > 1) {
        table1.deleteRow(1);
    }
    return;
          
          
        }
        });        
        </script>
          
          
          
    <script>
            
    function resetButton() {
// Function to populate tax table
    const table = document.getElementById("taxTable");

    const table1 = document.getElementById("taxTable1");  
  
    // Clear the table data (excluding header row)
    while (table.rows.length > 1) {
        table.deleteRow(1);
    }
    while (table1.rows.length > 1) {
        table1.deleteRow(1);
    }       
      
  const textbox1 = document.getElementById("textbox1");
  const textbox3 = document.getElementById("textbox3");
  const textbox4 = document.getElementById("textbox4");
  const textbox6 = document.getElementById("textbox6");
  const textbox8 = document.getElementById("textbox8");
      
  textbox1.focus();      
  textbox1.value = ""
  textbox3.value = ""
  textbox4.value = "" 
  textbox6.value = "" 
  textbox8.value = ""                  
} 
                
     
        document.getElementById("button5").addEventListener("click", function() {     
                          
        });        
            
       </script>                                                      

    <script>

// تبديل الوضع الليلي
function toggleNightMode() {
    const body = document.body;
    body.classList.toggle('dark-mode');
    const nightModeToggle = document.querySelector('.night-mode-toggle');
    const isNightMode = body.classList.contains('dark-mode');
    nightModeToggle.innerHTML = isNightMode ? '☀' : '🌙';
}
// تحميل تفضيل العرض المحفوظ والوضع الليلي
document.addEventListener('DOMContentLoaded', function() {
    const darkModePreference = localStorage.getItem('darkModePreference'); // إضافة تفضيل الوضع الليلي
    // تطبيق الوضع الليلي إذا كان مفعلاً
    if (darkModePreference === 'true') {
        toggleNightMode();
    }
});

// تبديل الوضع الليلي
function toggleNightMode() {
    const body = document.body;
    body.classList.toggle('dark-mode');
    const nightModeToggle = document.querySelector('.night-mode-toggle');
    const isNightMode = body.classList.contains('dark-mode');
    nightModeToggle.innerHTML = isNightMode ? '☀' : '🌙';
    // حفظ تفضيل الوضع الليلي
    localStorage.setItem('darkModePreference', isNightMode ? 'true' : 'false');
}     


       // إظهار النص العائم عند تحميل الصفحة
        window.onload = function() {
            showFloatingText(); // استدعاء الدالة لأول مرة عند تحميل الصفحة

            // تكرار إظهار النص العائم كل 30 ثانية
            setInterval(function() {
                showFloatingText();
            }, 30000);
        };

        // دالة لإظهار النص العائم
        function showFloatingText() {
            var floatingText = document.getElementById("floatingText");
            floatingText.style.display = "block";

            // إخفاء النص العائم بعد 5 ثواني
            setTimeout(function() {
                floatingText.style.display = "none";
            }, 5000);
        }

      
      // إعادة توجيه المستخدم عند الضغط على الأيقونة العائمة
        document.getElementById("youtubeIcon").onclick = function() {
            window.location.href = "https://play.google.com/store/apps/details?id=com.mrizk.taxlawapp";
        };
      
      
  </script>                  
                  
       <script>  
 // لتغيير اتجاه الصفحة من اليسار إلى اليمين  (RTL)
document.dir = 'rtl';
       </script>