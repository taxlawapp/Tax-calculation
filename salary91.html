    <!DOCTYPE html>
    <html lang="en">
    <head>
        <meta charset="UTF-8">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <link rel="stylesheet" type="text/css" href="login.css" >
       <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/all.min.css"> <!-- مكتبة الأيقونات -->
    <!-- رابط خط Cairo من Google Fonts -->
    <link href="https://fonts.googleapis.com/css2?family=Beiruti:wght@400;700&display=swap" rel="stylesheet"> 
        <title>حساب ضريبة المرتبات والأجور وفقا لقانون الضريبة علي الدخل رقم 91 لسنة 2005 وتعديلاته</title>
    <!-- لو الأيقونة بصيغة PNG -->
    <link rel="icon" type="image/png" href="https://www3.0zz0.com/2024/05/30/07/482205963.png">
    </head>
    <style>
    *{
        margin: 0;
        padding: 0;
        box-sizing: border-box;
        font-family: 'Beiruti' , sans-serif;
    }
  
    body{
        font-family: 'Beiruti', sans-serif;            
        display: flex;
        justify-content: center;
        align-items: center;
        min-height: 5rem;
        background: linear-gradient(to right, white, #e1f5fe);      
        user-select: none;

      
    }
      
      
    .form{
    margin: 0px auto;          
    border-radius: 0px;
    position: relative;
    padding: 20px 20px 20px;
    background: linear-gradient(to right, white, #e1f5fe);      
    border-radius: 0px;
    text-align: center;
    box-shadow: 50%;
    animation: rotate 1.5s linear infinite;
    border-style: none;
    border: 0px solid #420c0c;
      
    }



    .form h2{
    background: linear-gradient(to right, #eaecee, #e1f5fe);/* خلفية متدرجة */
    color: #2b0876;
    font-weight: bold;
    text-transform: uppercase;
    letter-spacing: 0px;
    font-size: 25px;
    border: 2px solid #420c0c;
    border-radius: 0px;  
    margin-top: 40px; /* إضافة المسافة السفلية */     
    }
    .form .input{
        text-align: center;
        margin-top: 5px;
        font-weight: 900;

    }



    .form .input .inputbox{
        
        margin-top: 5px;
    }

    .form .input .inputbox label:not(.settings-label,.toggle-all-label){
    background: ; 
    margin-top: 0px;      
    display: block;
    color: #02076e;
    margin-bottom: 2.5px;
    font-size: 22px;
    border: 0px solid #420c0c;
    margin-top: 2px;      

    }

    .form .input .inputbox input:not(.settings-checkbox){
    text-align: center;
    font-weight: 900;
    width: 100%;
    background: #ffffff;
    outline: none;
    border-radius: 60px;
    padding: 6px 20px;
    font-size: 20px;
    color: #0e1ba0;
    height: 45px;
    border: 2px solid #420c0c;
    border-radius: 5px;            
    margin:1.5px 0; 
    margin-top: 0px;      

    }
      
.form .input .inputbox input:focus{
  outline: none;
  border-color: #007bff;
  box-shadow: 0 0 0 0.2rem rgba(0, 123, 255, 0.50);
}

    .forget{
        margin-top: 5px;
        color: #555;
    }

    .forget a{
        color: #ff0047;
    }

     
      .form-control {
    width: 100%;
    height: 45px;
    border: 2px solid #420c0c; 
    border-radius: 0px;
    padding: 0 10px;
    font-size: 18px;
    font-family: 'Beiruti', sans-serif; 
    color: #fff;
    text-align: center;
  
}
      
#textbox10 {
    background-color: #1565c0;
    color: #fff;
    font-weight: 900;
    
    text-align: center;
    width: 100%;
    outline: none;
    border-radius: 60px;
    padding: 6px 20px;
    font-size: 18px;
    height: 45px;
    border: 0px solid #420c0c;
    border-radius: 5px;            
    margin:1.5px 0; 
    margin-top: 0px;      
  
} 
      
  #textbox10:focus{
  outline: none;
  border-color: #007bff;
  box-shadow: 0 0 0 0.2rem rgba(0, 123, 255, 0.50);
}

.form-control option {
  font-size: 18px;
  font-family: sans-serif;
  color: #fff;
}

.form-control:hover {
  border: 2px solid #000;
}

  .hr{
      font-size: 20px;
      font-weight: 900;
      
    
      }

      
      input[type="date"] {
  text-align: center;
}


      
#taxTable {
  background-color: #e1f5fe;
  color: #1a237e;
  font-weight: 400;
  margin-top: 5px;
  font-size: 16px;
  border: 2px solid #420c0c;
  box-shadow: inset -2px -2px 6px rgba(255,255,255,.05),
    }  
            

      
  #taxTable1 {
  background-color: #b3e5fc;
  color: #1a237e;
  font-weight: 400;  
  margin-top: 5px;
  font-size: 16px;
  border: 2px solid #420c0c;
  box-shadow: inset -2px -2px 6px rgba(255,255,255,.05),
    }
      
      
  #taxTable2 {
  background-color: #e1f5fe;
  color: #1a237e;
  font-weight: 400;
  margin-top: 5px;
  font-size: 16px;
  border: 2px solid #420c0c;
  box-shadow: inset -2px -2px 6px rgba(255,255,255,.05),
    } 
      
  #taxTable3 {
  background-color: #e1f5fe;
  color: #1a237e;
  font-weight: 400;
  margin-top: 5px;
  font-size: 16px;
  border: 2px solid #420c0c;
  box-shadow: inset -2px -2px 6px rgba(255,255,255,.05),
    }      
      
  #taxTable4 {
  background-color: #e1f5fe;
  color: #1a237e;
  font-weight: 400;
  margin-top: 5px;
  font-size: 16px;
  border: 2px solid #420c0c;
  box-shadow: inset -2px -2px 6px rgba(255,255,255,.05),
    }
      


      
 #dete1 {
    margin-top: 0px;
  
}     
      
 #dete2 {
    margin-top: 0px;
  
}

#textbox31 {
    margin-top: 2.5px;
    font-size: 20px;
    font-weight: bold;  
    background-color: #1a237e;
    color: #FFFF00;
    border-radius: 0px;
    width: 100%;
    height: 30px;
  
}       
      
#hr {
    margin-top: 0px;
  
}
      
  #yearMessage {
  color: #1a237e;
  font-weight: bold;
    text-align: center;
    background: #e1f5fe; 
    margin-top: 5px;      
    display: block;
    font-size: 16px;
    border: 0px solid #420c0c;

    }      

  #yearMessage1 {
  color: #1a237e;
  font-weight: bold;
    text-align: center;
    background: #e1f5fe; 
    margin-top: 5px;      
    display: block;
    font-size: 16px;
    border: 0px solid #420c0c;

    }  
      
  #yearMessage2 {
  color: #e65100;
  font-weight: bold;
    text-align: center;
    background: #e1f5fe; 
    margin-top: 5px;      
    display: block;
    font-size: 18px;
    border: 0px solid #420c0c;

    } 
      
  #yearMessage3 {
  color: #1a237e;
  font-weight: bold;
    text-align: center;
    background: #e1f5fe; 
    margin-top: 5px;      
    display: block;
    font-size: 16px;
    border: 0px solid #420c0c;;

    } 

      
  #yearMessage4 {
  color: #1a237e;
  font-weight: bold;
    text-align: center;
    background: #e1f5fe; 
    margin-top: 5px;      
    display: block;
    font-size: 16px;
    border: 0px solid #420c0c;

    }  
      
  #yearMessage5 {
  color: #e65100;
  font-weight: bold;
    text-align: center;
    background: #e1f5fe; 
    margin-top: 5px;      
    display: block;
    font-size: 18px;
    border: 0px solid #420c0c;

    }  
      
      
  #yearMessage6 {
  color: #1a237e;
  font-weight: bold;
    text-align: center;
    background: #e1f5fe; 
    margin-top: 5px;      
    display: block;
    font-size: 16px;
    border: 0px solid #420c0c;

    }       
      
      
  #yearMessage7 {
  color: #1a237e;
  font-weight: bold;
    text-align: center;
    background: #e1f5fe; 
    margin-top: 5px;      
    display: block;
    font-size: 16px;
    border: 0px solid #420c0c;

    }       
      
  #yearMessage8 {
  color: #e65100;
  font-weight: bold;
    text-align: center;
    background: #e1f5fe; 
    margin-top: 5px;      
    display: block;
    font-size: 18px;
    border: 0px solid #420c0c;

    } 
      



#taxTable2,
#taxTable3,
#taxTable4 {
  display: none;
}



.button {
    font-size: 17px; /* حجم الخط */
    font-weight: bold; /* وزن الخط */
    padding: 7.5px 75px; /* حجم الحشو */
    margin: 10px auto; /* تقليل هامش الزر */
    border: none; /* حذف الحدود */
    border-radius: 5px; /* تقويس الزوايا */
    background: linear-gradient(135deg, #0277bd, #1a237e); /* خلفية متدرجة */
    color: white; /* لون النص */
    cursor: pointer; /* تحويل المؤشر إلى يد عند التحويم */
    transition: background-color 0.3s, transform 0.3s; /* تأثير الانتقال */
    text-decoration: none; /* إزالة الخط تحت النص داخل الزر */
    display: block; /* عرض الزر ككتلة */
    text-align: center; /* توسيط النص داخل الزر */
}

.button:hover {
    background-color: #1a237e; /* لون خلفية الزر عند التحويم */
    color: #FFFF00; /* لون النص */  
    transform: scale(1.05); /* تحجيم الزر عند التحويم */
    border: 2px solid white; /* إضافة حد عند التحويم */
  
}

.button:active {
    transform: scale(0.95); /* تحجيم الزر عند الضغط */
}

.button a {
    text-decoration: none; /* إزالة الخط تحت النص داخل الرابط */
    color: inherit; /* الاحتفاظ بلون النص داخل الرابط */
}      

      
#button5 {
    color: white; /* لون النص */
    background: red; /* لون الخلفية */
    border: none; /* إزالة الحدود */
    border-radius: 5px; /* زوايا مستديرة */
    text-decoration: none; /* إزالة التسطير عن النص */
    display: block; /* عرض الزر ككتلة */
    font-size: 17px; /* حجم الخط */
    font-weight: bold; /* وزن الخط */
    padding: 7.5px 75px; /* حجم الحشو */
    margin: 5px auto; /* هامش الزر */
    margin-bottom: 60px;
    cursor: pointer; /* تحويل المؤشر إلى يد عند التحويم */
    transition: background-color 0.3s, transform 0.3s; /* تأثير الانتقال */
    text-align: center; /* توسيط النص داخل الزر */
}
  
#button5:hover {
    background-color: darkred; /* تغيير لون الخلفية عند التحويم */
    transform: scale(1.05); /* تحجيم الزر عند التحويم */
  
      } 
      

        /* استايل النص العائم */
        .floating-text {
            font-size: 18px;
            font-weight: bold;
            position: fixed;
            bottom: 27.5px;
            right: 60px; /* تعديل المسافة بين النص والأيقونة */
            background-color: #ffffff;
            color: red;
            padding: 10px;
            border-radius: 5px;
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.2);
            z-index: 1000;
            display: none; /* الإخفاء الافتراضي للنص */
            margin-bottom: 50px; /* مسافة سفلية */          
        }
      
      
        /* أنماط القائمة السفلية */
        .navbar {
            position: fixed;
            bottom: 3px;
            left: 50%; /* توسيط العنصر أفقيًا */
            transform: translateX(-50%); /* توسيط العنصر بدقة */
            width: 92.5%; /* عرض العنصر */
            background: linear-gradient(135deg, #0277bd, #1a237e); /* خلفية متدرجة */
            display: flex;
            justify-content: space-around; /* توزيع العناصر */
            padding: 5px 15px; /* حشو داخلي */
            box-shadow: 2px 2px 2px 2px rgba(0, 0, 0, 0.1); /* ظل خفيف */
            border-radius: 22.5px; /* زوايا مستديرة */
            border-bottom: 3px solid white; /* حدود */
            z-Index:1;
        }

        .navbar .nav-item {
            flex: 1;
            text-align: center;
            color: white; /* لون النص */
            font-size: 14px; /* حجم النص */
            cursor: pointer; /* تغيير شكل المؤشر */
            padding: 5px 0; /* حشو داخلي */
            transition: transform 0.3s ease, box-shadow 0.3s ease, background-color 0.3s ease; /* تأثيرات الانتقال */
            border-width: 1px; /* حدود */
            border-style: solid;
            border-color: transparent;
        }

        .icon {
            margin-bottom: 2px; /* مسافة سفلية للأيقونة */
            font-size: 20px; /* حجم الأيقونة */
        }

        .nav-item span {
            display: block;
            font-size: 15px; /* حجم النص */
            font-weight: bold; /* وزن النص */
            text-decoration: none; /* إزالة التسطير */
        }

        .nav-item span:active {
            font-size: 20px; /* حجم النص */
            font-weight: bold; /* وزن النص */ 
        }

        .nav-item:active .icon {
          font-size: 22px; /* حجم الأيقونة */
        }  
     
        /* أنماط شعار الإشعارات */
        .notification-badge {
            position: absolute;
            top: -5px; /* المسافة من الأعلى */
            right: 87.5px; /* المسافة من اليمين */
            background-color: red; /* لون الخلفية */
            color: white; /* لون النص */
            font-size: 15px; /* حجم النص */
            padding: 2.5px 5px; /* حشو داخلي */
            border-radius: 50%; /* زوايا مستديرة */
            display: flex;
            align-items: center;
            justify-content: center;
        }   
      
        /* أنماط الوضع الليلي للقائمة */
        body.dark-mode .navbar {
            background: #121212; /* لون خلفية القائمة في الوضع الليلي */
            border-top: 2px solid #fafafa; /* حدود علوية */
        }

        body.dark-mode .navbar .nav-item {
            color: #ddd; /* لون النص في الوضع الليلي */
            border-color: transparent; /* حدود شفافة */
        }

        body.dark-mode .navbar .nav-item.home {
            border-color: #ddd; /* حدود العنصر الرئيسي */
            border: none; /* إزالة الحدود */  
        }
      
        body.dark-mode .icon {
            color: #ddd; /* لون الأيقونات في الوضع الليلي */
        }

        /* إزالة الخط تحت أسماء القوائم */
        .navbar-nav .nav-link {
            text-decoration: none;
        }
        .navbar a {
            text-decoration: none;
        }
      
      
        /* أنماط الشريط العلوي */
        .top-bar {
            position: fixed;
            top: 0px; /* المسافة من الأعلى */
            left: 50%; /* توسيط العنصر أفقيًا */
            transform: translateX(-50%); /* توسيط العنصر بدقة */
            width: 100%; /* عرض العنصر */
            height: 57.5px; /* ارتفاع العنصر */
            background: linear-gradient(135deg, #0277bd, #1a237e); /* خلفية متدرجة */
            display: flex;
            justify-content: space-between; /* توزيع العناصر */
            padding: 10px 15px; /* حشو داخلي */
            box-shadow: 2px 2px 2px 2px rgba(0, 0, 0, 0.1); /* ظل خفيف */
            border-radius: 0px 0px 22.5px 22.5px; /* زوايا مستديرة */
            border-bottom: 3px solid white; /* حدود */
            align-items: center; /* توسيط العناصر عموديًا */
            z-index: 1; /* ترتيب العنصر */
            color: white; /* لون النص */
        }



.top-bar .menu-icon {
    font-size: 27.5px;
    cursor: pointer;
}

.top-bar .title {
    font-size: 17px; /* حجم الخط لعناصر العنوان */
    margin-left: 20px; /* مسافة بين السهم والعنوان */
    flex-grow: 1; /* يسمح للعناصر الأخرى بالتقلص عندما تكون الشاشة صغيرة */
    text-align: center; /* توسيط العنوان */
    font-weight: bold;  

}

.top-bar .icon {
    display: none; /* إخفاء الأيقونات بعد التعديل */
}  
      
      
      
      
        /* تنسيق النافذة المنبثقة */
        .popup {
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%) scale(0.8);
            background: white;
            padding: 25px 30px;
            border-radius: 16px;
            box-shadow: 0 12px 35px rgba(0, 0, 0, 0.18);
            display: flex;
            flex-direction: column;
            align-items: center;
            opacity: 0;
            transition: all 0.4s cubic-bezier(0.34, 1.56, 0.64, 1);
            z-index: 10002;
            max-width: 85%;
            width: fit-content;
            min-width: 260px;
            max-width: 320px;
            text-align: center;
            border-top: 5px solid;
        }

        .popup.show {
            opacity: 1;
            transform: translate(-50%, -50%) scale(1);
        }

        /* تنسيق الأيقونة */
        .popup-icon {
            font-size: 26px;
            margin-bottom: 2.5px;
            transition: all 0.3s;
        }

        /* تنسيق الرسالة */
        .popup-message {
            font-size: 20px;
            line-height: 1.0;
            font-weight: bold; 
            color: #333;
        }

        /* ألوان وأنواع الرسائل */
        .popup.info {
            border-color: #4285f4;
            background: linear-gradient(145deg, #f7faff, #e8f1fe);
        }
        .popup.warning {
            border-color: #fbbc05;
            background: linear-gradient(145deg, #fff9e6, #fff2cc);
        }
        .popup.error {
            border-color: #ea4335;
            background: linear-gradient(145deg, #ffefed, #ffe5e3);
        }
        .popup.success {
            border-color: #34a853;
            background: linear-gradient(145deg, #f0f9f2, #e6f5e9);
        }

        /* ألوان الأيقونات */
        .info .popup-icon { color: #4285f4; }
        .warning .popup-icon { color: #fbbc05; }
        .error .popup-icon { color: #ea4335; }
        .success .popup-icon { color: #34a853; }

        /* تأثيرات الحركة */
        @keyframes float {
            0%, 100% { transform: translateY(0); }
            50% { transform: translateY(-8px); }
        }
        .popup.show .popup-icon {
            animation: float 2s ease-in-out infinite;
        }

        /* طبقة التعتيم */
        .popup-overlay {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(0,0,0,0.45);
            z-index: 9999;
            opacity: 0;
            transition: opacity 0.3s;
            backdrop-filter: blur(3px);
            pointer-events: none;
        }
        .popup-overlay.show {
            opacity: 1;
            display: block;
            pointer-events: auto;
        }

        .settings-popup {
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            background: #fff;
            padding: 20px;
            border-radius: 15px;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.2);
            z-index: 10001;
            width: 90%;
            max-width: 400px;
            display: none;
            animation: fadeInUp 0.3s ease-out;
            border: 5px solid #ddd;
        }

        .settings-popup.show {
            display: block;
        }

        .settings-header {
            margin-bottom: 20px;
            text-align: center;
        }

        .settings-header h3 {
            margin: 0;
            font-size: 20px;
            color: #1a237e;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 8px;
            font-weight: bold;
        }

        .settings-content {
            max-height: 60vh;
            overflow-y: auto;
            padding-right: 5px;
        }

        .settings-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 10px;
            padding: 10px 12px;
            background-color: #f8f9fa;
            border-radius: 10px;
        }

        .settings-label {
            display: flex;
            align-items: center;
            gap: 8px;
            font-weight: bold;
            color: #333;
            font-size: 18px;
        }

        .settings-label i {
            font-size: 18px;
            width: 22px;
            text-align: center;
        }

        .settings-controls {
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .settings-checkbox {
            -webkit-appearance: none;
            appearance: none;
            width: 26px;
            height: 26px;
            border: 2px solid #ccc;
            border-radius: 5px;
            cursor: pointer;
            position: relative;
            transition: all 0.2s ease;
        }

        .settings-checkbox:checked {
            background-color: #0277bd;
            border-color: #0277bd;
        }

        .settings-checkbox:checked::after {
            content: '\f00c';
            font-family: 'Font Awesome 5 Free';
            font-weight: 900;
            color: white;
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            font-size: 10px;
        }

        .toggle-all {
            background: #f8f9fa;
            padding: 12px 15px;
            border-radius: 10px;
            margin: 15px 0;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .toggle-all-label {
            font-weight: bold;
            color: #1a237e;
            font-size: 18px;
            display: flex;
            align-items: center;
            gap: 6px;
        }

        .settings-footer {
            display: flex;
            gap: 10px;
            margin-top: 5px;
        }

        .settings-footer a {
            flex: 1;
            padding: 10px 20px;
            font-size: 18px;
            border-radius: 8px;
            max-width: none;
        }

        /* ألوان خاصة بكل نوع من الرسائل */
        .info { 
            color: #0277bd; 
            border-left-color: #0277bd;
            background: #e3f2fd;
        }
        .success { 
            color: #2e7d32; 
            border-left-color: #2e7d32;
            background: #e8f5e9;
        }
        .warning { 
            color: #ff8f00; 
            border-left-color: #ff8f00;
            background: #fff8e1;
        }
        .error { 
            color: #c62828; 
            border-left-color: #c62828;
            background: #ffebee;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translate(-50%, -55%); }
            to { opacity: 1; transform: translate(-50%, -50%); }
        }

        @keyframes fadeInUp {
            from { opacity: 0; transform: translate(-50%, -60%); }
            to { opacity: 1; transform: translate(-50%, -50%); }
        }

        /* تحسينات للشاشات الصغيرة */
        @media (max-width: 400px) {
            .settings-popup {
                padding: 15px;
            }
            
            .settings-item {
                flex-direction: column;
                align-items: flex-start;
                gap: 8px;
            }
            
            .settings-controls {
                width: 100%;
                justify-content: space-between;
            }
            
            .settings-select {
                width: 100%;
            }
        }

        #durationInfo {
            background-color: #1565c0;
            color: #fff;
            font-weight: 900;
            text-align: center;
            width: 100%;
            outline: none;
            border-radius: 60px;
            padding: 6px 20px;
            font-size: 18px;
            height: 45px;
            border: 0px solid #420c0c;
            border-radius: 5px;            
            margin:1.5px 0; 
            margin-top: 0px;      
        } 
              
        #durationInfo:focus{
            outline: none;
            border-color: #007bff;
            box-shadow: 0 0 0 0.2rem rgba(0, 123, 255, 0.50);
        }
              
        #durationSuccess {
            background-color: #1565c0;
            color: #fff;
            font-weight: 900;
            text-align: center;
            width: 100%;
            outline: none;
            border-radius: 60px;
            padding: 6px 20px;
            font-size: 18px;
            height: 45px;
            border: 0px solid #420c0c;
            border-radius: 5px;            
            margin:1.5px 0; 
            margin-top: 0px;      
        } 
              
        #durationSuccess:focus{
            outline: none;
            border-color: #007bff;
            box-shadow: 0 0 0 0.2rem rgba(0, 123, 255, 0.50);
        }
              
        #durationWarning {
            background-color: #1565c0;
            color: #fff;
            font-weight: 900;
            text-align: center;
            width: 100%;
            outline: none;
            border-radius: 60px;
            padding: 6px 20px;
            font-size: 18px;
            height: 45px;
            border: 0px solid #420c0c;
            border-radius: 5px;            
            margin:1.5px 0; 
            margin-top: 0px;      
        } 
              
        #durationWarning:focus{
            outline: none;
            border-color: #007bff;
            box-shadow: 0 0 0 0.2rem rgba(0, 123, 255, 0.50);
        }
              
        #durationError {
            background-color: #1565c0;
            color: #fff;
            font-weight: 900;
            text-align: center;
            width: 100%;
            outline: none;
            border-radius: 60px;
            padding: 6px 20px;
            font-size: 18px;
            height: 45px;
            border: 0px solid #420c0c;
            border-radius: 5px;            
            margin:1.5px 0; 
            margin-top: 0px;      
        } 
              
        #durationError:focus{
            outline: none;
            border-color: #007bff;
            box-shadow: 0 0 0 0.2rem rgba(0, 123, 255, 0.50);
        }
      
      
      
        :root {
            --transition: all 0.3s ease;
        }
        
        /* زر العائمة الرئيسي */
        .floating-container {
            position: fixed;
            bottom: 30px;
            right: 30px;
            z-index: 1000;
        }
        
        .floating-btn {
            bottom: 42.5px;
            right: -20px;
            width: 47.5px;
            height: 47.5px;
            background: linear-gradient(135deg, #0277bd, #1a237e); /* خلفية متدرجة */
            color: white;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
            transition: var(--transition);
            border: none;
            outline: none;
            position: relative;
            z-index: 1001;
        }
        
        .floating-btn i {
            font-size: 28px;
            transition: var(--transition);
        }
        
        .floating-btn:hover {
            transform: scale(1.1);
            box-shadow: 0 8px 15px rgba(67, 97, 238, 0.3);
        }
        
        .floating-btn.active {
            transform: rotate(135deg);
            background: linear-gradient(135deg, #f72585, #b5179e);
        }
        
        /* تأثير النبض */
        @keyframes pulse {
            0% { box-shadow: 0 0 0 0 rgba(67, 97, 238, 0.7); }
            70% { box-shadow: 0 0 0 15px rgba(67, 97, 238, 0); }
            100% { box-shadow: 0 0 0 0 rgba(67, 97, 238, 0); }
        }
        
        .pulse {
            animation: pulse 2s infinite;
        }
        
        /* القائمة المنبثقة */
        .floating-menu {
            position: absolute;
            bottom: 95px;
            right: -12.5px;
            width: 230px;
            background: linear-gradient(to right, white, #e1f5fe);
            border-radius: 15px;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
            opacity: 0;
            visibility: hidden;
            transform: translateY(20px);
            transition: var(--transition);
            padding: 15px;
            z-index: 1000;
            border: 3px solid #ddd; /* حدود */
        }
        
        .floating-menu.active {
            opacity: 1;
            visibility: visible;
            transform: translateY(0);
        }
      
        /* إضافة هذا لمنع التمرير عند ظهور القائمة */
       .body-no-scroll {
         overflow: hidden;
         position: fixed;
         width: 100%;
         height: 100%;
        }   
      
        .overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.5);
            display: none;
            z-index: 999;
        }      
        
        .menu-header {
            display: flex;
            justify-content: space-between;
            align-items: center;          
            margin-bottom: 15px;
            padding-bottom: 10px;
            border-bottom: 2.5px solid #eee;
        }
        
        .menu-header h3 {
            color: #2b2d42;
            font-size: 18px;
            font-weight: bold;
            text-align: center;
            margin: 0;
        }
        
        .close-btn {
            background: none;
            border: none;
            color: #999;
            font-size: 18px;
            font-weight: bold;
            cursor: pointer;
            transition: var(--transition);
            padding: 0;
            line-height: 1;
        }
        
        .close-btn:hover {
            color: #f72585;
            transform: rotate(90deg);
        }
        
        .menu-items {
            list-style: none;
            padding: 0;
            margin: 0;
        }
        
        .menu-item {
            padding: 10px 8px;
            margin: 2.5px 0;
            border-radius: 8px;
            transition: var(--transition);
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        .menu-item:hover {
            background-color: rgba(67, 97, 238, 0.1);
            transform: translateX(-5px);
        }
        
        .menu-item i {
            width: 25px;
            height: 25px;
            background: linear-gradient(135deg, #4895ef, #4361ee);
            color: white;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 12px;
            flex-shrink: 0;
        }
        
        .menu-item.gold i {
            background: linear-gradient(135deg, #ffb700, #ffd700);
        }
        
        .menu-item a {
            color: #2b2d42;
            text-decoration: none;
            font-weight: 500;
            flex-grow: 1;
            font-size: 16px;
            font-weight: bold;
        }
        
        .menu-item .badge {
            background-color: #f72585;
            color: white;
            border-radius: 10px;
            padding: 2px 8px;
            font-size: 12px;
            font-weight: bold;
            margin-right: 2.5px;
        }
        
        .gold-badge {
            background: gold;
            color: white;
            border-radius: 10px;
            padding: 2px 8px;
            font-size: 12px;
            margin-right: 1.5px;
            font-weight: bold;
        }
        
        /* تأثيرات دخول العناصر */
        @keyframes slideIn {
            from { opacity: 0; transform: translateX(20px); }
            to { opacity: 1; transform: translateX(0); }
        }
        
        .menu-item {
            animation: slideIn 0.3s forwards;
            opacity: 0;
        }
        
        .menu-item:nth-child(1) { animation-delay: 0.1s; }
        .menu-item:nth-child(2) { animation-delay: 0.2s; }
        .menu-item:nth-child(3) { animation-delay: 0.3s; }
        .menu-item:nth-child(4) { animation-delay: 0.4s; }
        .menu-item:nth-child(5) { animation-delay: 0.5s; }
        .menu-item:nth-child(6) { animation-delay: 0.6s; }
        .menu-item:nth-child(7) { animation-delay: 0.7s; }
        .menu-item:nth-child(8) { animation-delay: 0.8s; }      

      
      
    .color-palette {
        display: flex;
        flex-wrap: wrap;
        gap: 10px;
        padding: 12.5px;
        background: #f5f5f5;
        border-radius: 8px;
        margin-left: 0px;
        max-width: 385px;
      margin-top: 2.5px;
      margin-bottom: 2.5px;
      border: 2.5px solid #212121;
    }
    
    .color-option {
        width: 25px;
        height: 25px;
        border-radius: 50%;
        cursor: pointer;
        border: 2px solid transparent;
        transition: all 0.2s ease;
    }
    
    .color-option:hover {
        border-color: #333;
        transform: scale(1.1);
    }
    
    .color-option.selected {
        border-color: #333;
        transform: scale(1.2);
        box-shadow: 0 0 5px rgba(0,0,0,0.3);
    }
    
    #textbox8.highlighted, 
    #textbox6.highlighted, 
    #textbox4.highlighted {
        background-color: var(--tax-highlight-color, #FFFF99);
        transition: background-color 0.3s ease;
    } 
      
      
        .modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0,0,0,0.85); /* خلفية أكثر عتامة */
            z-index: 9999; /* أعلى قيمة لضمان ظهوره فوق كل شيء */
            justify-content: center;
            align-items: center;
            backdrop-filter: blur(5px); /* تأثير ضبابي للخلفية */
        }
        
        .modal-content {
            width: 90%;
            max-width: 900px;
            background-color: transparent; /* خلفية شفافة */
            border-radius: 10px;
            overflow: hidden;
            box-shadow: 0 0 30px rgba(0,0,0,0.7);
            position: relative;
        }
        
        .video-container {
            position: relative;
            padding-bottom: 56.25%; /* نسبة 16:9 */
            height: 0;
            overflow: hidden;
            border-radius: 8px;
        }
        
        .video-container iframe {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            border: none;
        }     
    </style>
    <body>
      
<div class="top-bar">
    <div class="menu-icon" id="menuIcon" onclick="toggleSidebar()">
        <i class="fas fa-arrow-right" onclick="window.location.href='https://taxlawapp.github.io/Tax-calculation/Tax-calculation.html'"></i> <!-- سهم العودة -->
    </div>
    <div class="title">
        حساب ضريبة المرتبات ق 91 لسنة 2005 وتعديلاته
    </div>
</div>

<!-- القائمة السفلية -->
<div class="navbar">
    <a href="https://taxlawapp.github.io/home/Login.html" class="nav-item">
        <i class="fas fa-user icon"></i>
        <span>حسابي</span>
    </a>
    <a href="https://taxlawapp.github.io/home/pro.html" class="nav-item">
        <i class="fas fa-crown icon" style="color: gold;"></i>
        <span>برو</span>
    </a>     
    <a href="https://taxlawapp.github.io/home/home.html" class="nav-item home">
        <i class="fas fa-home icon"></i>
        <span>الرئيسية</span>
    </a>
    <a href="https://youtube.com/@taxlawapp" class="nav-item">
        <i class="fab fa-youtube icon"></i>
        <span>قناتي</span>
    </a>
    <a href="https://taxlawapp.github.io/home/Settings.html" class="nav-item">
        <i class="fas fa-ellipsis-h icon"></i>
        <span>المزيد</span>
    </a>      
</div>


        <div class="form outer">

            <h2>حساب ضريبة المرتبات والأجور وفقا لقانون الضريبة علي الدخل رقم 91 لسنة 2005 وتعديلاته</h2>

          
            <div class="input">
              
                    <div class="row inputbox">
                    <div class="col-md-6">
                                      <label id="textbox31">١ ) البيانات الأساسية</label>                  

                        <div class="col-md-6">
                        <label for="textbox10">السنة الضريبية :</label>
                          
                        <select  class="form-control" id="textbox10" onchange="show3()" placeholder="" type="text">
                        <option>-- اختر من القائمة السنة الضريبية --</option>
                        <option>2025</option>
                        <option>2024</option>
                        <option>2023</option>
                        <option>2022</option>
                        <option>2021</option>
                        <option>2020</option>
                        <option>2019</option>
                        <option>2018</option>
                        <option>2017</option>
                        <option>2016</option>
                        <option>2015</option>
                        <option>2014</option>
                        <option>2013</option>
                        <option>2012</option>
                        <option>2011</option>
                        <option>2010</option>                          
                        <option>2009</option>
                        <option>2008</option>
                        <option>2007</option>
                        <option>2006</option>
                        <option>2005</option>                         
                        </select>
                          
                   
                <div class="row inputbox">
                    <div class="col-md-6">
                    <label id="textbox105" style="display:block;">صافي الوعاء الخاضع للضريبة :</label>
                    <input class="form-control" id="textbox1" style="display:block;" onchange="show2()" placeholder="أدخل صافي الوعاء" required="" type="number" />
                    </div> 
                  
                      <label  style="display:none;" id="textbox102">صافي الوعاء الخاضع للضريبة | الفترة الأولي :</label>  
                      <input class="dete" type="number"  name="hide" id="net1" style="display: none;" placeholder="أدخل صافي وعاء الفترة الأولي">                  
                  
                      <label  style="display:none;" id="textbox103">صافي الوعاء الخاضع للضريبة | الفترة الثانية :</label>  
                      <input class="dete" type="number"  name="hide" id="net2" style="display: none;" placeholder="أدخل صافي وعاء الفترة الثانية">                   
                  
                      <label  style="display:none;" id="textbox104">صافي الوعاء الخاضع للضريبة | الفترة الثالثة :</label>  
                      <input class="dete" type="number"  name="hide" id="net3" style="display: none;" placeholder="أدخل صافي وعاء الفترة الثالثة"> 
                  
                  
                  
                        <label  style="display:none;" id="textbox100">بداية الفترة الضريبية :</label>  
                      <input class="dete" type="hidden"  name="hide" id="dete1" placeholder="أدخل تاريخ بداية الفترة الضريبية">
                          
                        <label  style="display:none;" id="textbox101">نهاية الفترة الضريبية :</label>                            
                      <input class="dete"  type="hidden" name="hide" id="dete2" placeholder="أدخل تاريخ نهاية الفترة الضريبية">
                          
                    <div class="row">
                        <div class="col-md-6">
                        <label for="name">الضريبة المستحقة ( سنوية ) :</label>
                        <input class="form-control" disabled="" id="textbox4" placeholder="" readonly="" type="text" />
                        </div>
                      
                    <div class="row">
                        <div class="col-md-6">
                        <label for="name">الضريبة المستحقة ( شهرية ) :</label>
                        <input class="form-control" disabled="" id="textbox6" placeholder="" readonly="" type="text" />
                        </div>                      

                </div>

                
                <div class="col-md-6">
                    <label for="name"></label>
                
                    
                    
                <!--   <textarea class="form-contro2" disabled="" id="textbox5" readonly=""></textarea> -->
                
                
                </div>
                                                                                                 
                <div class="inputbox row1 ">
                    <div class="col-md-6">
                      
    <a onclick="calculateTaxFromInspection()" id="button2" class="button"><i class="fas fa-check-circle"></i> إحسب الضريبة المستحقة</a> <!-- زر تنفيذي مع أيقونة تحقق -->

           <div id="yearMessage"></div> <!-- هنا يظهر النص المراد تغييره حسب السنة -->
           <div id="yearMessage1"></div> <!-- هنا يظهر النص المراد تغييره حسب السنة -->
                      
                </div>
            </div>                                                   
                          
<table id="taxTable" border="0" width="100%" height="40">
  <tr>
    <th>مـ</th>
    <th>الشريحة</th>
    <th>النسبة</th>
    <th>الضريبة</th>
    <th>الصافي</th>
  </tr>
</table>
           <div id="yearMessage2"></div> <!-- هنا يظهر النص المراد تغييره حسب السنة -->
 
           <div id="yearMessage3"></div> <!-- هنا يظهر النص المراد تغييره حسب السنة -->
           <div id="yearMessage4"></div> <!-- هنا يظهر النص المراد تغييره حسب السنة -->                  
<table id="taxTable2" border="0" width="100%" height="40">
  <tr>
    <th>مـ</th>
    <th>الشريحة</th>
    <th>النسبة</th>
    <th>الضريبة</th>
    <th>الصافي</th>
  </tr>
</table>  

           <div id="yearMessage5"></div> <!-- هنا يظهر النص المراد تغييره حسب السنة -->

           <div id="yearMessage6"></div> <!-- هنا يظهر النص المراد تغييره حسب السنة -->
           <div id="yearMessage7"></div> <!-- هنا يظهر النص المراد تغييره حسب السنة -->                  
<table id="taxTable3" border="0" width="100%" height="40">
  <tr>
    <th>مـ</th>
    <th>الشريحة</th>
    <th>النسبة</th>
    <th>الضريبة</th>
    <th>الصافي</th>
  </tr>
</table> 
                  
           <div id="yearMessage8"></div> <!-- هنا يظهر النص المراد تغييره حسب السنة --> 
                                    
<table id="taxTable1" border="0" width="100%" height="40">
  <tr>
    <th>مـ</th>
    <th>الشريحة</th>
    <th>النسبة</th>
    <th>الخصــم</th>
    <th>الصافي</th>
  </tr>
</table>
                                                   

      
                  
<table id="taxTable4" border="0" width="100%" height="40">
  <tr>
    <th>مـ</th>
    <th>الشريحة</th>
    <th>النسبة</th>
    <th>الخصــم</th>
    <th>الصافي</th>
  </tr>
</table>                          

                         </div>
                    </div>
                    <div class="inputbox row1 ">
                    <div class="col-md-6">                          
       <a onclick="resetButton()" id="button5" class="button"><i class="fas fa-times-circle"></i> إفراغ البيانات</a>
                    </div>
                    </div> 
                    </div>
                    </div>                        
                    </div>
                    </div>
      
                    <!-- كود اضافي هام لعمل الكود السابق -->
<div class="row inputbox"><div class="col-md-6">
<select  style="display:none;" class="form-control" id="textbox13" onchange="show4()" placeholder="" type="text"><option></option></select><div class="col-md-6"><input style="display:none;" class="form-control" id="textbox3" onchange="show5()" type="number" /></div>  <div class="col-md-6"><select style="display:none;" class="form-control" id="textbox9" onchange="show6()" placeholder="" type="text"><option></option></select> <div class="col-md-6"><input style="display:none;" class="form-control" disabled="" id="textbox8" readonly="" type="text" /></div><div class="row"><div class="col-md-6"><input style="display:none;" class="form-control" disabled="" id="textbox6" readonly="" type="text" /></div></div></div></div></div>

                      
                  
    <!-- الخلفية المعتمة -->
    <div class="overlay" id="overlay"></div>                 
                      
    <!-- زر الفعل العائم والقائمة -->
    <div class="floating-container">
        <div class="floating-menu" id="floatingMenu">
            <div class="menu-header">
            <h3>روابط هامة للمستخدم :</h3>
                <button class="close-btn" id="closeMenu">❌</button>    
            </div>
            <ul class="menu-items">
                <li class="menu-item" onclick="openSettings()" style="cursor: pointer;">
                  <i class="fas fa-cog"></i>
                  <a>الإعدادات الخاصة بالشاشة</a>
                </li>
               <li class="menu-item" onclick="openVideoPopup()" style="cursor: pointer;">
                  <i class="fas fa-lightbulb"></i>
                  <a>فيديو إستخدام الشاشة</a>
                </li>              
               <li class="menu-item">
                  <i class="fas fa-lightbulb"></i>
                  <a href="https://taxlawapp.github.io/home/ideas.html">تقديم الإقتراحات للتطوير</a>
                </li>
              <li class="menu-item">
                  <i class="fas fa-exclamation-triangle"></i>
                  <a href="https://taxlawapp.github.io/home/problems.html">الإبلاغ الأخطاء المكتشفة</a>
                </li>              
                <li class="menu-item">
                    <i class="fas fa-share-alt"></i>
                    <a href="https://taxlawapp.github.io/home/Share-app.html">شارك التطبيق لأصدقائك</a>
                </li>
                <li class="menu-item">
                    <i class="fas fa-star-half-alt"></i>
                    <a href="https://play.google.com/store/apps/details?id=com.mrizk.taxlawapp">تقييم التطبيق عـ المتجر</a>
                </li>
            </ul>
        </div>
        
        <button class="floating-btn pulse" id="mainButton">
            <i class="fas fa-plus"></i>
        </button>
    </div>
  
<!-- النص العائم -->
<div class="floating-text" id="floatingText">
    إضغط هنا لعرض المزايا والإعدادات 
</div>                       

    <!-- نافذة الفيديو المنبثقة -->
    <div id="videoModal" class="modal">
        <div class="modal-content">
            <span class="close-btn" onclick="closeVideoPopup()"></span>
            <div class="video-container">
                <iframe id="youtubeVideo" src="" frameborder="0" 
                    allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" 
                    allowfullscreen></iframe>
            </div>
        </div>
    </div>                      
                      
                      
    <!-- طبقة التعتيم -->
    <div id="popupOverlay" class="popup-overlay"></div>
    
    <!-- النافذة المنبثقة -->
    <div id="customPopup" class="popup">
        <div class="popup-icon" id="popupIcon"></div>
        <div class="popup-message" id="popupMessage"></div>
    </div>                      
                      
<!-- زر فتح الإعدادات -->
    <div id="customPopup" class="popup">
        <div class="popup-content">
            <div class="popup-icon" id="popupIcon"></div>
            <div class="popup-message" id="popupMessage"></div>
        </div>
    </div>

    <div id="popupSettings" class="settings-popup">
        <div class="settings-header">
            <h3><i class="fas fa-sliders-h"></i> إعدادات شاشة | ضريبة المرتبات ق 91</h3>
        </div>
        
        <div class="settings-content">
          
<div class="toggle-all">
    <input type="checkbox" class="settings-checkbox" id="defaultSettingsEnabled" onchange="handleDefaultSettingsToggle()" checked>
    <label class="toggle-all-label">
        <i class="fas fa-cog"></i>
        <span>تفعيل عدم إفراغ الحقول الأساسية</span>
    </label>
</div> 
          
<!-- زر تمييز حقول احتساب الضريبة -->
<div class="toggle-all">
    <input type="checkbox" class="settings-checkbox" id="highlightTaxFieldsEnabled" onchange="handleHighlightTaxFieldsToggle()" checked>
    <label class="toggle-all-label">
        <i class="fas fa-highlighter"></i>
        <span>تمييز لون حقول إحتساب الضريبة</span>
    </label>
</div>
          
    <!-- ألوان التمييز (مخفية بشكل افتراضي) -->
    <div class="color-palette" id="taxFieldsColorPalette" style="display: none; margin-top: 10px;">
        <div class="color-option" data-color="#FFFF99" style="background-color: #FFFF99;" onclick="selectTaxHighlightColor(this)" title="أصفر فاتح"></div>      
        <div class="color-option" data-color="#E0FFFF" style="background-color: #E0FFFF;" onclick="selectTaxHighlightColor(this)" title="سماوي فاتح"></div>
        <div class="color-option" data-color="#FFCC99" style="background-color: #FFCC99;" onclick="selectTaxHighlightColor(this)" title="برتقالي فاتح"></div>
        <div class="color-option" data-color="#99CCFF" style="background-color: #99CCFF;" onclick="selectTaxHighlightColor(this)" title="أزرق فاتح"></div>
        <div class="color-option" data-color="#99FF99" style="background-color: #99FF99;" onclick="selectTaxHighlightColor(this)" title="أخضر فاتح"></div>
        <div class="color-option" data-color="#FF99FF" style="background-color: #FF99FF;" onclick="selectTaxHighlightColor(this)" title="وردي فاتح"></div>
        <div class="color-option" data-color="#CC99FF" style="background-color: #CC99FF;" onclick="selectTaxHighlightColor(this)" title="بنفسجي فاتح"></div>
        <div class="color-option" data-color="#FF9999" style="background-color: #FF9999;" onclick="selectTaxHighlightColor(this)" title="أحمر فاتح"></div>      
    </div>          
          
            <div class="toggle-all">
                <input type="checkbox" class="settings-checkbox" id="popupEnabled" onchange="toggleAllMessages()">
                <label class="toggle-all-label">
                    <i class="fas fa-bell"></i>
                    <span>تفعيل إختفاء جميع الرسائل التنبهية</span>
                </label>
            </div>
          
            <div class="toggle-all">
            <input type="checkbox" class="settings-checkbox" id="resetAllDurations" onchange="resetAllDurations()">
                <label class="toggle-all-label">
                    <i class="fas fa-sliders-h"></i>
                    <span>ضبط إختفاء جميع الرسائل التنبهية</span>
                </label>
            </div>          
          
            

          
            <div class="settings-item">
                <label class="settings-label">
                    <i class="fas fa-info-circle info"></i>
                    <span>التحكم فـ ظهور / ومدة إختفاء رسائل المعلومات (Info) :</span>
                </label>
                <div class="settings-controls">
                    <select class="settings-select" id="durationInfo">
                        <option value="1000" selected>1 ثانية</option> <!-- ✅ الافتراضي -->
                        <option value="2500">2.5 ثانية</option>
                        <option value="5000">5 ثواني</option>
                        <option value="10000">10 ثواني</option>
                        <option value="15000">15 ثانية</option>
                        <option value="30000">30 ثانية</option>
                    </select>
                    <input type="checkbox" class="settings-checkbox" id="enableInfo" onchange="updateSettings('info')">
                </div>
            </div>

            <div class="settings-item">
                <label class="settings-label">
                    <i class="fas fa-check-circle success"></i>
                    <span>التحكم فـ ظهور / ومدة إختفاء رسائل النجاح (Success) :</span>
                </label>
                <div class="settings-controls">
                    <select class="settings-select" id="durationSuccess">
                        <option value="1000" selected>1 ثانية</option> <!-- ✅ الافتراضي -->
                        <option value="2500">2.5 ثانية</option>
                        <option value="5000">5 ثواني</option>
                        <option value="10000">10 ثواني</option>
                        <option value="15000">15 ثانية</option>
                        <option value="30000">30 ثانية</option>
                    </select>
                    <input type="checkbox" class="settings-checkbox" id="enableSuccess" onchange="updateSettings('success')">
                </div>
            </div>

            <div class="settings-item">
                <label class="settings-label">
                    <i class="fas fa-exclamation-triangle warning"></i>
                    <span>التحكم فـ ظهور / ومدة إختفاء رسائل التحذير (Warning) :</span>
                </label>
                <div class="settings-controls">
                    <select class="settings-select" id="durationWarning">
                        <option value="1000" selected>1 ثانية</option> <!-- ✅ الافتراضي -->           
                        <option value="2500">2.5 ثانية</option>
                        <option value="5000">5 ثواني</option>
                        <option value="10000">10 ثواني</option>
                        <option value="15000">15 ثانية</option>
                        <option value="30000">30 ثانية</option>
                    </select>
                    <input type="checkbox" class="settings-checkbox" id="enableWarning" onchange="updateSettings('warning')">
                </div>
            </div>

            <div class="settings-item">
                <label class="settings-label">
                    <i class="fas fa-times-circle error"></i>
                    <span>التحكم فـ ظهور / ومدة إختفاء رسائل الخطأ (Error) :</span>
                </label>
                <div class="settings-controls">
                    <select class="settings-select" id="durationError">
                        <option value="1000" selected>1 ثانية</option> <!-- ✅ الافتراضي -->
                        <option value="2500">2.5 ثانية</option>
                        <option value="5000">5 ثواني</option>
                        <option value="10000">10 ثواني</option>
                        <option value="15000">15 ثانية</option>
                        <option value="30000">30 ثانية</option>
                    </select>
                    <input type="checkbox" class="settings-checkbox" id="enableError" onchange="updateSettings('error')">
                </div>
            </div>


  
        </div>

        <div class="settings-footer">
            <a onclick="saveSettings()" class="button"><i class="fas fa-save"></i> حفظ</a>
            <a onclick="closeSettings()" class="button" style="background: linear-gradient(135deg, #e53935, #c62828);"><i class="fas fa-times"></i> إغلاق</a>
        </div>
    </div>


    <script>  
function setDefaultFormValues() {
    // معالجة السنة الضريبية
    const yearSelect = document.getElementById('textbox10');
    if (yearSelect) {
        const currentYear = new Date().getFullYear();
        const previousYear = currentYear - 1;
        let foundYear = null;
        
        // البحث عن السنوات الممكنة
        const availableYears = [];
        for (let i = 0; i < yearSelect.options.length; i++) {
            const optionYear = parseInt(yearSelect.options[i].value || yearSelect.options[i].text);
            if (!isNaN(optionYear)) {
                availableYears.push(optionYear);
                
                // تحديد السنة الحالية إذا وجدت
                if (optionYear === currentYear) {
                    yearSelect.selectedIndex = i;
                    foundYear = currentYear;
                    break;
                }
            }
        }
        
        // إذا لم توجد السنة الحالية، نبحث عن السنة السابقة
        if (!foundYear && availableYears.length > 0) {
            // البحث عن السنة السابقة
            for (let i = 0; i < yearSelect.options.length; i++) {
                const optionYear = parseInt(yearSelect.options[i].value || yearSelect.options[i].text);
                if (optionYear === previousYear) {
                    yearSelect.selectedIndex = i;
                    foundYear = previousYear;
                    break;
                }
            }
            
            // إذا لم توجد السنة السابقة، نحدد آخر سنة متاحة
            if (!foundYear) {
                const lastAvailableYear = Math.max(...availableYears);
                for (let i = 0; i < yearSelect.options.length; i++) {
                    const optionYear = parseInt(yearSelect.options[i].value || yearSelect.options[i].text);
                    if (optionYear === lastAvailableYear) {
                        yearSelect.selectedIndex = i;
                        break;
                    }
                }
            }
        }
    }
}


// استدعاء الدالة عند تحميل الصفحة
document.addEventListener('DOMContentLoaded', setDefaultFormValues);
    
   
 
// دالة للتحكم في تفعيل وإلغاء افراغ الحقول الاساسية
function handleDefaultSettingsToggle() {
    // الحصول على عنصر خانة الاختيار
    const defaultSettingsCheckbox = document.getElementById('defaultSettingsEnabled');
    const isChecked = defaultSettingsCheckbox.checked;
    
    // حفظ الحالة في التخزين المحلي عند التفعيل أو إزالتها عند الإلغاء
    if (isChecked) {
        localStorage.setItem('defaultSettingsEnabled', 'true');
    } else {
        localStorage.removeItem('defaultSettingsEnabled');
    }
    
    // تحضير الرسالة المناسبة حسب الحالة
    const message = isChecked 
        ? "تم تفعيل عدم إفراغ حقول الإدخال الأساسية" 
        : "تم إلغاء تفعيل إفراغ حقول الإدخال الأساسية";
    
    // نوع الرسالة (نجاح للمسح، معلومة للتأكيد)
    const messageType = isChecked ? 'info' : 'success';
    
    // عرض الرسالة المنبثقة
    showPopup(message, messageType, 1000, true);

    // تأخير تنفيذ العمليات لضمان ظهور الرسالة
    setTimeout(() => {
        if (isChecked) {
            setDefaultFormValues(); // تعيين القيم الافتراضية
        } else {
            resetAllSelectsToFirstOption(); // إعادة تعيين الحقول
        }
    }, 300);
}

// دالة لعرض الرسائل المنبثقة
function showPopup(message, type = 'info', duration = 1000, closable = true) {
    // التحقق من وجود عناصر النافذة المنبثقة أو إنشائها
    let popup = document.getElementById('custom-popup');
    let overlay = document.getElementById('custom-overlay');
    
    if (!popup) {
        createPopupElements(); // إنشاء العناصر إذا لم تكن موجودة
        popup = document.getElementById('custom-popup');
        overlay = document.getElementById('custom-overlay');
    }
    
    // تعيين محتوى الرسالة ونوعها
    popup.querySelector('.popup-message').textContent = message;
    popup.className = `popup show popup-${type}`;
    overlay.className = 'overlay show';
    
    // إغلاق تلقائي بعد المدة المحددة
    if (duration > 0) {
        setTimeout(hidePopup, duration);
    }
}

// دالة لإنشاء عناصر النافذة المنبثقة في واجهة المستخدم
function createPopupElements() {
    // إنشاء طبقة التغطية الخلفية
    const overlay = document.createElement('div');
    overlay.id = 'custom-overlay';
    overlay.className = 'overlay';
    
    // إنشاء النافذة المنبثقة الرئيسية
    const popup = document.createElement('div');
    popup.id = 'custom-popup';
    popup.className = 'popup';
    
    // بناء الهيكل الداخلي للنافذة
    popup.innerHTML = `
        <div class="popup-content">
            <span class="popup-message"></span>
            <button class="popup-close">×</button>
        </div>
    `;
    
    // إضافة العناصر إلى الجسم الرئيسي للصفحة
    document.body.appendChild(overlay);
    document.body.appendChild(popup);
    
    // إضافة معالجات أحداث للإغلاق
    popup.querySelector('.popup-close').addEventListener('click', hidePopup);
    overlay.addEventListener('click', hidePopup);
}

// دالة لإخفاء النافذة المنبثقة
function hidePopup() {
    const popup = document.getElementById('custom-popup');
    const overlay = document.getElementById('custom-overlay');
    
    if (popup) popup.classList.remove('show');
    if (overlay) overlay.classList.remove('show');
}

// دالة لتعيين القيم الافتراضية للنموذج
function setDefaultFormValues() {

    // تعيين السنة الضريبية (الحالية أو السابقة)
    setTaxYearValue();
    
}

// العناصر
function setSelectValue(id, searchText) {
    const selectElement = document.getElementById(id);
    if (selectElement) {
        for (let i = 0; i < selectElement.options.length; i++) {
            if (selectElement.options[i].text.includes(searchText)) {
                selectElement.selectedIndex = i;
                break;
            }
        }
    }
}

// دالة خاصة لتعيين السنة الضريبية
function setTaxYearValue() {
    const yearSelect = document.getElementById('textbox10');
    if (!yearSelect) return;
    
    const currentYear = new Date().getFullYear();
    const previousYear = currentYear - 1;
    
    // البحث عن السنة الحالية أولاً
    if (!setYearIfFound(yearSelect, currentYear)) {
        // إذا لم توجد السنة الحالية، البحث عن السنة السابقة
        if (!setYearIfFound(yearSelect, previousYear)) {
            // إذا لم توجد، اختيار آخر سنة متاحة
            setLastAvailableYear(yearSelect);
        }
    }
}

// دالة مساعدة للبحث عن سنة محددة وتعيينها
function setYearIfFound(selectElement, year) {
    for (let i = 0; i < selectElement.options.length; i++) {
        const optionYear = parseInt(selectElement.options[i].value || selectElement.options[i].text);
        if (!isNaN(optionYear) && optionYear === year) {
            selectElement.selectedIndex = i;
            return true;
        }
    }
    return false;
}

// دالة مساعدة لتعيين آخر سنة متاحة
function setLastAvailableYear(selectElement) {
    let maxYear = 0;
    let maxIndex = 0;
    
    for (let i = 0; i < selectElement.options.length; i++) {
        const optionYear = parseInt(selectElement.options[i].value || selectElement.options[i].text);
        if (!isNaN(optionYear) && optionYear > maxYear) {
            maxYear = optionYear;
            maxIndex = i;
        }
    }
    
    if (maxYear > 0) {
        selectElement.selectedIndex = maxIndex;
    }
}

// دالة لإعادة تعيين جميع حقول select إلى الخيار الأول
function resetAllSelectsToFirstOption() {
    const selectIds = ['textbox10'];
    
    selectIds.forEach(id => {
        const selectElement = document.getElementById(id);
        if (selectElement && selectElement.options.length > 0) {
            selectElement.selectedIndex = 0;
        }
    });
}

// تهيئة الصفحة عند التحميل
document.addEventListener('DOMContentLoaded', function() {
    const checkbox = document.getElementById('defaultSettingsEnabled');
    
    if (checkbox) {
        // التحقق من وجود إعدادات محفوظة مسبقاً
        const isDefaultEnabled = localStorage.getItem('defaultSettingsEnabled') === 'true';
        
        // تعيين حالة الخانة حسب التخزين المحلي
        checkbox.checked = isDefaultEnabled;
        
        if (isDefaultEnabled) {
            // إذا كانت مفعلة مسبقاً، تعيين القيم بدون عرض الرسالة
            setDefaultFormValues();
        } else {
            // إذا لم تكن مفعلة، تفعيلها تلقائياً وعرض الرسالة
            checkbox.checked = true;
            localStorage.setItem('defaultSettingsEnabled', 'true');
            showPopup("تم تفعيل عدم إفراغ حقول الإدخال الأساسية", 'info', 1000, true);
            setDefaultFormValues();
        }
    }
});
      
      
// اعدادات الاختفاء الاساسية 
function resetAllDurations(suppressMessage = false) {
    const resetCheckbox = document.getElementById('resetAllDurations');
    const durationSelects = [
        document.getElementById('durationInfo'),
        document.getElementById('durationSuccess'),
        document.getElementById('durationWarning'),
        document.getElementById('durationError')
    ];

    if (resetCheckbox.checked) {
        // ضبط جميع المدد إلى 1 ثانية (الخيار الأول) وإقفالها
        durationSelects.forEach(select => {
            if (select) {
                select.selectedIndex = 0;
                select.disabled = true;
            }
        });
        
        // حفظ الحالة في التخزين المحلي
        localStorage.setItem('resetAllDurations', 'true');
        
        // عرض الرسالة فقط إذا لم يتم كتمها
        if (!suppressMessage) {
            showPopup('تم ضبط اعدادات إختفاء الرسائل بعد 1 ثانية تلقائي', 'success', 1000, true);
        }
    } else {
        // إعادة فتح جميع المدد
        durationSelects.forEach(select => {
            if (select) select.disabled = false;
        });
        
        // حذف الحالة من التخزين المحلي
        localStorage.removeItem('resetAllDurations');
        
        // عرض الرسالة فقط إذا لم يتم كتمها
        if (!suppressMessage) {
            showPopup('تم إلغاء الإختفاء الإفتراضي يمكنك ضبط كل رسالة علي حدة', 'info', 1000, true);
        }
    }
}

// تهيئة العنصر عند تحميل الصفحة (بدون عرض الرسالة)
function initializeResetCheckbox() {
    const resetCheckbox = document.getElementById('resetAllDurations');
    if (localStorage.getItem('resetAllDurations') === 'true') {
        resetCheckbox.checked = true;
        resetAllDurations(true); // نمرر true لكتم الرسالة
    }
}

// استدعاء الدالة عند تحميل الصفحة
window.addEventListener('DOMContentLoaded', initializeResetCheckbox);
      
// دالة عرض الرسائل المنبثقة
function showPopup(message, type = 'info') {
    // إنشاء العناصر إذا لم تكن موجودة
    if (!document.getElementById('popupOverlay')) {
        createPopupElements();
    }

    const popup = document.getElementById('customPopup');
    const overlay = document.getElementById('popupOverlay');
    const icon = document.getElementById('popupIcon');
    const msg = document.getElementById('popupMessage');

    // تعيين محتوى الرسالة
    msg.textContent = message;

    // تعيين النوع والمظهر
    popup.className = `popup ${type}`;

    // تعيين الأيقونة المناسبة
    const icons = {
        'info': 'fas fa-info-circle',
        'success': 'fas fa-check-circle',
        'warning': 'fas fa-exclamation-triangle',
        'error': 'fas fa-times-circle'
    };
    icon.className = `popup-icon ${icons[type] || icons['info']}`;

    // عرض الرسالة
    popup.classList.add('show');
    overlay.classList.add('show');

    // إخفاء تلقائي بعد 1 ثانية
    setTimeout(hidePopup, 1000);
}

// دالة إخفاء الرسالة المنبثقة
function hidePopup() {
    const popup = document.getElementById('customPopup');
    const overlay = document.getElementById('popupOverlay');
    
    if (popup) popup.classList.remove('show');
    if (overlay) overlay.classList.remove('show');
}      
      

      
// اعدادات تلوين حقول احتساب الضريبة      
const taxFieldsIds = ['textbox8', 'textbox6', 'textbox4', 'textbox5'];
    
    // عند تحميل الصفحة، تحميل التفضيلات من التخزين المحلي
    document.addEventListener('DOMContentLoaded', function() {
        loadTaxHighlightSettings();
    });
    
    // تبديل تمييز الحقول
    function handleHighlightTaxFieldsToggle() {
        const checkbox = document.getElementById('highlightTaxFieldsEnabled');
        const colorPalette = document.getElementById('taxFieldsColorPalette');
        
        if (checkbox.checked) {
            colorPalette.style.display = 'flex';
            
            // تطبيق اللون المحفوظ إذا كان موجوداً
            const savedColor = localStorage.getItem('taxHighlightColor');
            if (savedColor) {
                applyHighlightColor(savedColor);
                selectColorOption(savedColor);
            } else {
                // لون افتراضي إذا لم يكن هناك لون محفوظ
                applyHighlightColor('#FFFF99');
                selectColorOption('#FFFF99');
            }
        } else {
            colorPalette.style.display = 'none';
            removeHighlightFromFields();
        }
        
        // حفظ الحالة في التخزين المحلي
        localStorage.setItem('taxHighlightEnabled', checkbox.checked);
    }
    
    // اختيار لون التمييز
    function selectTaxHighlightColor(element) {
        const color = element.getAttribute('data-color');
        applyHighlightColor(color);
        selectColorOption(color);
        
        // حفظ اللون المختار في التخزين المحلي
        localStorage.setItem('taxHighlightColor', color);
    }
    
    // تطبيق لون التمييز على الحقول
    function applyHighlightColor(color) {
        taxFieldsIds.forEach(id => {
            const field = document.getElementById(id);
            if (field) {
                field.style.setProperty('--tax-highlight-color', color);
                field.classList.add('highlighted');
            }
        });
    }
    
    // إزالة التمييز من الحقول
    function removeHighlightFromFields() {
        taxFieldsIds.forEach(id => {
            const field = document.getElementById(id);
            if (field) {
                field.classList.remove('highlighted');
            }
        });
    }
    
    // تحديد خيار اللون في لوحة الألوان
    function selectColorOption(color) {
        const colorOptions = document.querySelectorAll('.color-option');
        colorOptions.forEach(option => {
            if (option.getAttribute('data-color') === color) {
                option.classList.add('selected');
            } else {
                option.classList.remove('selected');
            }
        });
    }
    
    // تحميل إعدادات التمييز من التخزين المحلي
    function loadTaxHighlightSettings() {
        const savedState = localStorage.getItem('taxHighlightEnabled');
        const checkbox = document.getElementById('highlightTaxFieldsEnabled');
        const colorPalette = document.getElementById('taxFieldsColorPalette');
        
        if (savedState !== null) {
            checkbox.checked = savedState === 'true';
            
            if (checkbox.checked) {
                colorPalette.style.display = 'flex';
                
                const savedColor = localStorage.getItem('taxHighlightColor');
                if (savedColor) {
                    applyHighlightColor(savedColor);
                    selectColorOption(savedColor);
                } else {
                    applyHighlightColor('#FFFF99');
                    selectColorOption('#FFFF99');
                }
            }
        } else {
            // الحالة الافتراضية عند عدم وجود إعدادات محفوظة
            checkbox.checked = true;
            colorPalette.style.display = 'flex';
            applyHighlightColor('#FFFF99');
            selectColorOption('#FFFF99');
        }
    }
      

      
// دالة عرض الفيديو المنبثق       
        function openVideoPopup() {
            const modal = document.getElementById('videoModal');
            const videoFrame = document.getElementById('youtubeVideo');
            
            // تعيين رابط فيديو يوتيوب
            videoFrame.src = "https://www.youtube.com/embed/545ze3kQrL4?autoplay=1";
            
            modal.style.display = "flex";
            setTimeout(() => {
                modal.classList.add('active');
            }, 10);
            
            // منع التمرير عند فتح النافذة
            document.body.style.overflow = 'hidden';
           closeFloatingMenu();
        }
        
        function closeVideoPopup() {
            const modal = document.getElementById('videoModal');
            const videoFrame = document.getElementById('youtubeVideo');
            
            modal.classList.remove('active');
            setTimeout(() => {
                videoFrame.src = "";
                modal.style.display = "none";
            }, 300);
            
            // إعادة التمرير عند الإغلاق
            document.body.style.overflow = 'auto';
        }
        
        // إغلاق النافذة عند النقر خارجها
        window.onclick = function(event) {
            const modal = document.getElementById('videoModal');
            if (event.target == modal) {
                closeVideoPopup();
            }
        }
        
        // إغلاق النافذة عند الضغط على زر ESC
        document.onkeydown = function(evt) {
            evt = evt || window.event;
            if (evt.keyCode == 27) {
                closeVideoPopup();
            }
        };  
      

      
        // دالة عرض الرسالة
        function showPopup(message, type = 'info') {
            const popup = document.getElementById('customPopup');
            const overlay = document.getElementById('popupOverlay');
            const icon = document.getElementById('popupIcon');
            const msg = document.getElementById('popupMessage');
            
            // تعيين الرسالة
            msg.textContent = message;
            
            // تعيين النوع والمظهر
            popup.className = 'popup ' + type;
            
            // تعيين الأيقونة المناسبة
            const icons = {
                'info': 'fas fa-info-circle',
                'warning': 'fas fa-exclamation-triangle',
                'error': 'fas fa-times-circle',
                'success': 'fas fa-check-circle'
            };
            icon.className = 'popup-icon ' + (icons[type] || icons['info']);
            
            // عرض الرسالة
            popup.classList.add('show');
            overlay.classList.add('show');
            
            // إخفاء تلقائي بعد 1 ثانية
            setTimeout(hidePopup, 1000);
        }
        
        // دالة إخفاء الرسالة
        function hidePopup() {
            document.getElementById('customPopup').classList.remove('show');
            document.getElementById('popupOverlay').classList.remove('show');
        }
        
            // مثال للاستخدام
            /*
            أنواع الرسائل المتاحة:
            showPopup("تمت العملية بنجاح", 'info');
            showPopup("تمت العملية بنجاح", 'success');
            showPopup("تحذير: هذا الحقل مطلوب", 'warning');
            showPopup("حدث خطأ غير متوقع", 'error');
            */
    </script>
                      
 
    <script>
        let popupSettings = {
            hideAll: false,
            durations: {
                info: 1000,
                success: 1000,
                warning: 1000,
                error: 1000
            },
            hiddenTypes: {
                info: false,
                success: false,
                warning: false,
                error: false
            }
        };

        // تحميل الإعدادات عند بدء التشغيل
        function loadSettings() {
            const savedSettings = localStorage.getItem('popupSettings');
            if (savedSettings) {
                try {
                    const parsedSettings = JSON.parse(savedSettings);
                    
                    popupSettings = {
                        hideAll: parsedSettings.hideAll !== undefined ? parsedSettings.hideAll : false,
                        durations: {
                            info: parsedSettings.durations?.info || 1000,
                            success: parsedSettings.durations?.success || 1000,
                            warning: parsedSettings.durations?.warning || 1000,
                            error: parsedSettings.durations?.error || 1000
                        },
                        hiddenTypes: {
                            info: parsedSettings.hiddenTypes?.info || false,
                            success: parsedSettings.hiddenTypes?.success || false,
                            warning: parsedSettings.hiddenTypes?.warning || false,
                            error: parsedSettings.hiddenTypes?.error || false
                        }
                    };
                    
                    updateUIFromSettings();
                    
                } catch (e) {
                    console.error('Failed to parse saved settings', e);
                    saveSettingsToLocalStorage();
                }
            } else {
                saveSettingsToLocalStorage();
            }
        }

        // تحديث واجهة المستخدم من الإعدادات
        function updateUIFromSettings() {
            document.getElementById('durationInfo').value = popupSettings.durations.info;
            document.getElementById('durationSuccess').value = popupSettings.durations.success;
            document.getElementById('durationWarning').value = popupSettings.durations.warning;
            document.getElementById('durationError').value = popupSettings.durations.error;
            
            document.getElementById('enableInfo').checked = popupSettings.hiddenTypes.info;
            document.getElementById('enableSuccess').checked = popupSettings.hiddenTypes.success;
            document.getElementById('enableWarning').checked = popupSettings.hiddenTypes.warning;
            document.getElementById('enableError').checked = popupSettings.hiddenTypes.error;
            
            document.getElementById('popupEnabled').checked = popupSettings.hideAll;
        }

        // حفظ الإعدادات في التخزين المحلي
        function saveSettingsToLocalStorage() {
            localStorage.setItem('popupSettings', JSON.stringify(popupSettings));
        }

        function showPopup(message, type = 'info', customDuration = null, isSystemMessage = false) {
            // إذا كانت رسالة نظامية، لا تطبق عليها قواعد الإخفاء
            if (!isSystemMessage && (popupSettings.hideAll || popupSettings.hiddenTypes[type])) {
                return;
            }

            const popup = document.getElementById('customPopup');
            const overlay = document.getElementById('popupOverlay');
            const icon = document.getElementById('popupIcon');
            const msg = document.getElementById('popupMessage');

            msg.textContent = message;
            popup.className = 'popup ' + type;

            const icons = {
                'info': 'fas fa-info-circle info',
                'warning': 'fas fa-exclamation-triangle warning',
                'error': 'fas fa-times-circle error',
                'success': 'fas fa-check-circle success'
            };
            icon.className = 'popup-icon ' + (icons[type] || icons['info']);

            popup.classList.add('show');
            overlay.classList.add('show');

            const duration = customDuration !== null ? customDuration : popupSettings.durations[type] || 1000;
setTimeout(() => {
    // إخفاء الرسالة المنبثقة
    document.getElementById('customPopup').classList.remove('show');
    
    // التحقق من حالة نافذة الإعدادات
    const settingsPopup = document.getElementById('popupSettings');
    const overlay = document.getElementById('popupOverlay');
    
    // إخفاء الخلفية فقط إذا كانت نافذة الإعدادات غير ظاهرة
    if (!settingsPopup.classList.contains('show') && settingsPopup.style.display !== 'block') {
        overlay.classList.remove('show');
    }
}, duration);
        }

        function openSettings() {
            document.getElementById('popupSettings').classList.add('show');
            document.getElementById('popupOverlay').classList.add('show');
            loadSettings();
        }

        function closeSettings() {
            document.getElementById('popupSettings').classList.remove('show');
            document.getElementById('popupOverlay').classList.remove('show');
        }

        function saveSettings() {
            popupSettings.durations.info = parseInt(document.getElementById('durationInfo').value) || 1000;
            popupSettings.durations.success = parseInt(document.getElementById('durationSuccess').value) || 1000;
            popupSettings.durations.warning = parseInt(document.getElementById('durationWarning').value) || 1000;
            popupSettings.durations.error = parseInt(document.getElementById('durationError').value) || 1000;
            
            popupSettings.hiddenTypes.info = document.getElementById('enableInfo').checked;
            popupSettings.hiddenTypes.success = document.getElementById('enableSuccess').checked;
            popupSettings.hiddenTypes.warning = document.getElementById('enableWarning').checked;
            popupSettings.hiddenTypes.error = document.getElementById('enableError').checked;
            
            popupSettings.hideAll = document.getElementById('popupEnabled').checked;

            saveSettingsToLocalStorage();
            showPopup("تم حفظ الإعدادات بنجاح", "success", 1000, true);
            
            setTimeout(closeSettings, 1000);
            closeFloatingMenu();
        }

        function updateSettings(type) {
            const checkbox = document.getElementById('enable' + capitalize(type));
            const isChecked = checkbox.checked;
            
            popupSettings.hiddenTypes[type] = isChecked;
            
            updateHideAllCheckbox();
            
            saveSettingsToLocalStorage();
            
            const typeInArabic = getTypeInArabic(type);
            const message = isChecked ? "تم تفعيل إخفاء رسائل " + typeInArabic : "تم إلغاء إخفاء رسائل " + typeInArabic;
            showPopup(message, isChecked ? 'info' : type, 1000, true);
        }

        function toggleAllMessages() {
            const isChecked = document.getElementById('popupEnabled').checked;
            
            // عرض الرسالة أولاً قبل تطبيق الإعدادات
            const message = isChecked ? "تم تفعيل إخفاء كافة أنواع الرسائل" : "تم إلغاء إخفاء كافة أنواع الرسائل";
            showPopup(message, isChecked ? 'info' : 'success', 1000, true);
            
            // تطبيق الإعدادات بعد عرض الرسالة
            popupSettings.hideAll = isChecked;
            
            if (isChecked) {
                popupSettings.hiddenTypes.info = true;
                popupSettings.hiddenTypes.success = true;
                popupSettings.hiddenTypes.warning = true;
                popupSettings.hiddenTypes.error = true;
            } else {
                popupSettings.hiddenTypes.info = false;
                popupSettings.hiddenTypes.success = false;
                popupSettings.hiddenTypes.warning = false;
                popupSettings.hiddenTypes.error = false;
            }
            
            updateUIFromSettings();
            saveSettingsToLocalStorage();
        }

        function updateHideAllCheckbox() {
            const allChecked = popupSettings.hiddenTypes.info && 
                              popupSettings.hiddenTypes.success && 
                              popupSettings.hiddenTypes.warning && 
                              popupSettings.hiddenTypes.error;
            
            document.getElementById('popupEnabled').checked = allChecked;
            popupSettings.hideAll = allChecked;
            
            if (allChecked) {
                showPopup("تم تفعيل إخفاء كافة أنواع الرسائل تلقائياً", "info", 1000, true);
            }
        }

        function getTypeInArabic(type) {
            const types = {
                'info': 'المعلومات',
                'success': 'النجاح',
                'warning': 'التحذير',
                'error': 'الخطأ'
            };
            return types[type] || type;
        }

        function capitalize(txt) {
            return txt.charAt(0).toUpperCase() + txt.slice(1);
        }

        // تحميل الإعدادات عند بدء التشغيل
        window.addEventListener('DOMContentLoaded', loadSettings);

// إغلاق النافذة عند النقر خارجها
document.addEventListener('click', function(event) {
    const settingsPopup = document.getElementById('popupSettings');
    const overlay = document.getElementById('popupOverlay');
    
    // تحقق مما إذا كانت النافذة ظاهرة (بأي طريقة عرض)
    const isPopupVisible = settingsPopup.classList.contains('show') || 
                         settingsPopup.style.display === 'block';
    
    // تحقق من النقر خارج النافذة وخارج أي عناصر متعلقة بها
    if (isPopupVisible && 
        !event.target.closest('#popupSettings') && 
        !event.target.closest('[onclick*="openSettings"]') &&
        event.target !== settingsPopup) {
        
        closeSettings();
    }
});
   
      
      
function openSettings() {
document.getElementById("popupSettings").style.display = "block";
  
  setTimeout(function() {
    document.getElementById("popupOverlay").classList.add("show");
  }, 50);
}

function closeSettings() {
  document.getElementById("popupSettings").style.display = "none";
  document.getElementById("popupOverlay").classList.remove("show");
}      
    </script>               
                      
    <script>
        // عناصر DOM
        const mainButton = document.getElementById('mainButton');
        const floatingMenu = document.getElementById('floatingMenu');
        const closeMenu = document.getElementById('closeMenu');
        const overlay = document.getElementById('overlay');

        // تبديل القائمة المنبثقة
        mainButton.addEventListener('click', function(e) {
            e.stopPropagation();
            this.classList.toggle('active');
            floatingMenu.classList.toggle('active');
            
            if (floatingMenu.classList.contains('active')) {
                // إظهار الخلفية المعتمة ومنع التمرير
                overlay.style.display = 'block';
                document.body.classList.add('body-no-scroll');
                document.addEventListener('click', closeMenuOutside);
            } else {
                // إخفاء الخلفية المعتمة وتمكين التمرير
                overlay.style.display = 'none';
                document.body.classList.remove('body-no-scroll');
                document.removeEventListener('click', closeMenuOutside);
            }
        });
        
        // إغلاق القائمة عند النقر على الزر المغلق
        closeMenu.addEventListener('click', function() {
            closeFloatingMenu();
        });
        
function closeMenuOutside(e) {
    const settingsPopup = document.getElementById('popupSettings');
    const videoModal = document.getElementById('videoModal');
    
    const isSettingsVisible = settingsPopup.classList.contains('show') || 
                            settingsPopup.style.display === 'block';
    
    const isVideoVisible = videoModal.style.display === 'block' || 
                         getComputedStyle(videoModal).display === 'block';

    // حالة خاصة: إذا كانت نافذة الفيديو ظاهرة، أغلق القائمة فوراً
    if (isVideoVisible) {
        closeFloatingMenu();
        return; // نخرج من الدالة فوراً بعد الإغلاق
    }
    
    // الحالة العامة: لا تغلق القائمة إذا كانت نافذة الإعدادات ظاهرة
    if (!isSettingsVisible && !floatingMenu.contains(e.target) && e.target !== mainButton) {
        closeFloatingMenu();
    }
}
        
        function closeFloatingMenu() {
            mainButton.classList.remove('active');
            floatingMenu.classList.remove('active');
            overlay.style.display = 'none';
            document.body.classList.remove('body-no-scroll');
            document.removeEventListener('click', closeMenuOutside);
        }


        // إزالة تأثير النبض بعد 5 ثواني
        setTimeout(() => {
            mainButton.classList.remove('pulse');
        }, 5000);

document.addEventListener("DOMContentLoaded", function () {
    showFloatingText(); // استدعاء الدالة عند تحميل الصفحة

    // تكرار إظهار النص العائم كل 30 ثانية
    setInterval(function() {
        showFloatingText();
    }, 30000);
});

// دالة لإظهار النص العائم
function showFloatingText() {
    var floatingText = document.getElementById("floatingText");
    floatingText.style.display = "block";

    // إخفاء النص العائم بعد 5 ثواني
    setTimeout(function() {
        floatingText.style.display = "none";
    }, 5000);
}    
 </script>                      
     
  
          
<script> 
function show2() {
    var textbox11 = document.getElementById("textbox11");
    var textbox1 = document.getElementById("textbox1");   
    const textbox4 = document.getElementById("textbox4");  
    const textbox6 = document.getElementById("textbox6");  
    
  
    var messageDiv = document.getElementById("yearMessage");          
    var messageDiv1 = document.getElementById("yearMessage1");
    var messageDiv2 = document.getElementById("yearMessage2");
    var messageDiv3 = document.getElementById("yearMessage3");
    var messageDiv4 = document.getElementById("yearMessage4");
    var messageDiv5 = document.getElementById("yearMessage5");
    var messageDiv6 = document.getElementById("yearMessage6");
    var messageDiv7 = document.getElementById("yearMessage7");
    var messageDiv8 = document.getElementById("yearMessage8");

  
  // إخفاء جميع الجداول المعرفة بـ #taxTable1 إلى #taxTable4
  document.querySelectorAll("#taxTable2, #taxTable3, #taxTable4").forEach(table => {
    table.style.display = "none";
  });    
  
    let caption = "";
  
    if ( textbox1.value === "" ) {

      
    messageDiv.style.display = "none";   
    messageDiv1.style.display = "none"; 
    messageDiv2.style.display = "none"; 
    messageDiv3.style.display = "none";
    messageDiv4.style.display = "none"; 
    messageDiv5.style.display = "none"; 
    messageDiv6.style.display = "none";
    messageDiv7.style.display = "none"; 
    messageDiv8.style.display = "none";
      
      
    textbox4.value = "";
// Function to populate tax table
    const table = document.getElementById("taxTable");

    const table1 = document.getElementById("taxTable1");  
 
    const table2 = document.getElementById("taxTable2");  

    const table3 = document.getElementById("taxTable3");  
      
    // Clear the table data (excluding header row)
    while (table.rows.length > 1) {
        table.deleteRow(1);
    }
    while (table1.rows.length > 1) {
        table1.deleteRow(1);
    } 
    while (table2.rows.length > 1) {
        table2.deleteRow(1);
    }
    while (table3.rows.length > 1) {
        table3.deleteRow(1);
    }      
                  
    } else  if ( textbox1.value ==="0" ) { 

    messageDiv.style.display = "none";   
    messageDiv1.style.display = "none"; 
    messageDiv2.style.display = "none"; 
    messageDiv3.style.display = "none";      
    messageDiv4.style.display = "none"; 
    messageDiv5.style.display = "none"; 
    messageDiv6.style.display = "none";
    messageDiv7.style.display = "none"; 
    messageDiv8.style.display = "none";
      
      
    textbox4.value = "";
// Function to populate tax table
    const table = document.getElementById("taxTable");

    const table1 = document.getElementById("taxTable1");  
 
    const table2 = document.getElementById("taxTable2");  

    const table3 = document.getElementById("taxTable3");  
      
    // Clear the table data (excluding header row)
    while (table.rows.length > 1) {
        table.deleteRow(1);
    }
    while (table1.rows.length > 1) {
        table1.deleteRow(1);
    } 
    while (table2.rows.length > 1) {
        table2.deleteRow(1);
    }
    while (table3.rows.length > 1) {
        table3.deleteRow(1);
    }                     
                  
                  
                  
} 
  
// ------------------------------
      
    textbox5.value = caption; 
  
       }           
        
</script>                  
                  
                  
                  
<script> 
function show3() {
    var textbox1 = document.getElementById("textbox1");   
    var textbox10 = document.getElementById("textbox10");
    const textbox4 = document.getElementById("textbox4");    
    const textbox6 = document.getElementById("textbox6");  

    var textbox102 = document.getElementById("textbox102");
    var textbox103 = document.getElementById("textbox103");
    var textbox104 = document.getElementById("textbox104");  
    const net1 = document.getElementById("net1"); 
    const net2 = document.getElementById("net2");  
    const net3 = document.getElementById("net3");

    var textbox105 = document.getElementById("textbox105");
    var textbox1 = document.getElementById("textbox1");
  
    var messageDiv = document.getElementById("yearMessage");          
    var messageDiv1 = document.getElementById("yearMessage1");
    var messageDiv2 = document.getElementById("yearMessage2");
    var messageDiv3 = document.getElementById("yearMessage3");  
    var messageDiv4 = document.getElementById("yearMessage4");  
    var messageDiv5 = document.getElementById("yearMessage5");
    var messageDiv6 = document.getElementById("yearMessage6");  
    var messageDiv7 = document.getElementById("yearMessage7"); 
    var messageDiv8 = document.getElementById("yearMessage8"); 
  
    let caption = "";

  
  // إخفاء جميع الجداول المعرفة بـ #taxTable1 إلى #taxTable4
  document.querySelectorAll("#taxTable2, #taxTable3, #taxTable4").forEach(table => {
    table.style.display = "none";
  });   
  
    if ( textbox10.value === "-- اختر من القائمة السنة الضريبية --" ) {
    textbox105.style.display = "block";       
    textbox1.style.display = "block";
    textbox1.value = "";      
    textbox102.style.display = "none";   
    textbox103.style.display = "none"; 
    textbox104.style.display = "none";
    net1.style.display = "none";   
    net2.style.display = "none"; 
    net3.style.display = "none";           
    net1.value = "";
    net2.value = "";
    net3.value = "";
      
      
    messageDiv.style.display = "none";   
    messageDiv1.style.display = "none"; 
    messageDiv2.style.display = "none"; 
    messageDiv3.style.display = "none"; 
    messageDiv4.style.display = "none";
    messageDiv5.style.display = "none"; 
    messageDiv6.style.display = "none";
    messageDiv7.style.display = "none"; 
    messageDiv8.style.display = "none";
      
      
    textbox4.value = "";
    textbox6.value = "";       
// Function to populate tax table
    const table = document.getElementById("taxTable");

    const table1 = document.getElementById("taxTable1");  
 
    const table2 = document.getElementById("taxTable2");  

    const table3 = document.getElementById("taxTable3");  
      
    // Clear the table data (excluding header row)
    while (table.rows.length > 1) {
        table.deleteRow(1);
    }
    while (table1.rows.length > 1) {
        table1.deleteRow(1);
    } 
    while (table2.rows.length > 1) {
        table2.deleteRow(1);
    }
    while (table3.rows.length > 1) {
        table3.deleteRow(1);
    }  
      
    } else  if ( textbox10.value <=2012 ) {
    textbox105.style.display = "block";       
    textbox1.style.display = "block";
    textbox1.value = "";            
    textbox102.style.display = "none";   
    textbox103.style.display = "none"; 
    textbox104.style.display = "none"; 
    net1.style.display = "none";   
    net2.style.display = "none"; 
    net3.style.display = "none";       
    net1.value = "";
    net2.value = "";
    net3.value = "";      
      
        
    messageDiv.style.display = "none";   
    messageDiv1.style.display = "none"; 
    messageDiv2.style.display = "none"; 
    messageDiv3.style.display = "none";      
    messageDiv4.style.display = "none"; 
    messageDiv5.style.display = "none"; 
    messageDiv6.style.display = "none";
    messageDiv7.style.display = "none"; 
    messageDiv8.style.display = "none";
            
    textbox4.value = "";
    textbox6.value = "";             
// Function to populate tax table
    const table = document.getElementById("taxTable");

    const table1 = document.getElementById("taxTable1");  
 
    const table2 = document.getElementById("taxTable2");  

    const table3 = document.getElementById("taxTable3");  
      
    // Clear the table data (excluding header row)
    while (table.rows.length > 1) {
        table.deleteRow(1);
    }
    while (table1.rows.length > 1) {
        table1.deleteRow(1);
    } 
    while (table2.rows.length > 1) {
        table2.deleteRow(1);
    }
    while (table3.rows.length > 1) {
        table3.deleteRow(1);
    }         
      
                    
    } else  if ( textbox10.value ==="2013" ) {
    textbox105.style.display = "none";       
    textbox1.style.display = "none";
    textbox1.value = "";            
    textbox102.style.display = "block";   
    textbox103.style.display = "block"; 
    textbox104.style.display = "block"; 
    net1.style.display = "block";   
    net2.style.display = "block"; 
    net3.style.display = "block";    
    net1.value = "";
    net2.value = "";
    net3.value = "";      
      
        
    messageDiv.style.display = "none";   
    messageDiv1.style.display = "none"; 
    messageDiv2.style.display = "none"; 
    messageDiv3.style.display = "none";      
    messageDiv4.style.display = "none"; 
    messageDiv5.style.display = "none"; 
    messageDiv6.style.display = "none";
    messageDiv7.style.display = "none"; 
    messageDiv8.style.display = "none";
      
      
    textbox4.value = "";
    textbox6.value = "";             
// Function to populate tax table
    const table = document.getElementById("taxTable");

    const table1 = document.getElementById("taxTable1");  
 
    const table2 = document.getElementById("taxTable2");  

    const table3 = document.getElementById("taxTable3");  
      
    // Clear the table data (excluding header row)
    while (table.rows.length > 1) {
        table.deleteRow(1);
    }
    while (table1.rows.length > 1) {
        table1.deleteRow(1);
    } 
    while (table2.rows.length > 1) {
        table2.deleteRow(1);
    }
    while (table3.rows.length > 1) {
        table3.deleteRow(1);
    }         
      
    } else  if ( textbox10.value <=2019 ) {
    textbox105.style.display = "block";       
    textbox1.style.display = "block";
    textbox1.value = "";            
    textbox102.style.display = "none";   
    textbox103.style.display = "none"; 
    textbox104.style.display = "none"; 
    net1.style.display = "none";   
    net2.style.display = "none"; 
    net3.style.display = "none";        
    net1.value = "";
    net2.value = "";
    net3.value = "";      
      
        
    messageDiv.style.display = "none";   
    messageDiv1.style.display = "none"; 
    messageDiv2.style.display = "none"; 
    messageDiv3.style.display = "none";      
    messageDiv4.style.display = "none"; 
    messageDiv5.style.display = "none"; 
    messageDiv6.style.display = "none";
    messageDiv7.style.display = "none"; 
    messageDiv8.style.display = "none";
      
      
    textbox4.value = "";
    textbox6.value = "";             
// Function to populate tax table
    const table = document.getElementById("taxTable");

    const table1 = document.getElementById("taxTable1");  
 
    const table2 = document.getElementById("taxTable2");  

    const table3 = document.getElementById("taxTable3");  
      
    // Clear the table data (excluding header row)
    while (table.rows.length > 1) {
        table.deleteRow(1);
    }
    while (table1.rows.length > 1) {
        table1.deleteRow(1);
    } 
    while (table2.rows.length > 1) {
        table2.deleteRow(1);
    }
    while (table3.rows.length > 1) {
        table3.deleteRow(1);
    }         
                         

    } else  if ( textbox10.value ==="2020" ) {
    textbox105.style.display = "none";       
    textbox1.style.display = "none";
    textbox1.value = "";            
    textbox102.style.display = "block";   
    textbox103.style.display = "block"; 
    textbox104.style.display = "none"; 
    net1.style.display = "block";   
    net2.style.display = "block"; 
    net3.style.display = "none";     
    net1.value = "";
    net2.value = "";
    net3.value = "";      
      

    messageDiv.style.display = "none";   
    messageDiv1.style.display = "none"; 
    messageDiv2.style.display = "none"; 
    messageDiv3.style.display = "none";      
    messageDiv4.style.display = "none";       
    messageDiv5.style.display = "none"; 
    messageDiv6.style.display = "none";
    messageDiv7.style.display = "none"; 
    messageDiv8.style.display = "none";
      
      
    textbox4.value = "";
    textbox6.value = "";             
// Function to populate tax table
    const table = document.getElementById("taxTable");

    const table1 = document.getElementById("taxTable1");  
 
    const table2 = document.getElementById("taxTable2");  

    const table3 = document.getElementById("taxTable3");  
      
    // Clear the table data (excluding header row)
    while (table.rows.length > 1) {
        table.deleteRow(1);
    }
    while (table1.rows.length > 1) {
        table1.deleteRow(1);
    } 
    while (table2.rows.length > 1) {
        table2.deleteRow(1);
    }
    while (table3.rows.length > 1) {
        table3.deleteRow(1);
    }         
      
    } else  if ( textbox10.value <=2022 ) {
    textbox105.style.display = "block";       
    textbox1.style.display = "block";
    textbox1.value = "";            
    textbox102.style.display = "none";   
    textbox103.style.display = "none"; 
    textbox104.style.display = "none"; 
    net1.style.display = "none";   
    net2.style.display = "none"; 
    net3.style.display = "none";        
    net1.value = "";
    net2.value = "";
    net3.value = "";      
      

    messageDiv.style.display = "none";   
    messageDiv1.style.display = "none"; 
    messageDiv2.style.display = "none"; 
    messageDiv3.style.display = "none";      
    messageDiv4.style.display = "none";       
    messageDiv5.style.display = "none"; 
    messageDiv6.style.display = "none";
    messageDiv7.style.display = "none"; 
    messageDiv8.style.display = "none";
      
      
    textbox4.value = "";
    textbox6.value = "";             
// Function to populate tax table
    const table = document.getElementById("taxTable");

    const table1 = document.getElementById("taxTable1");  
 
    const table2 = document.getElementById("taxTable2");  

    const table3 = document.getElementById("taxTable3");  
      
    // Clear the table data (excluding header row)
    while (table.rows.length > 1) {
        table.deleteRow(1);
    }
    while (table1.rows.length > 1) {
        table1.deleteRow(1);
    } 
    while (table2.rows.length > 1) {
        table2.deleteRow(1);
    }
    while (table3.rows.length > 1) {
        table3.deleteRow(1);
    }   
      

    } else  if ( textbox10.value ==="2023" ) {
    textbox105.style.display = "none";       
    textbox1.style.display = "none";
    textbox1.value = "";            
    textbox102.style.display = "block";   
    textbox103.style.display = "block"; 
    textbox104.style.display = "block"; 
    net1.style.display = "block";   
    net2.style.display = "block"; 
    net3.style.display = "block";     
    net1.value = "";
    net2.value = "";
    net3.value = "";      
      
        
    messageDiv.style.display = "none";   
    messageDiv1.style.display = "none"; 
    messageDiv2.style.display = "none"; 
    messageDiv3.style.display = "none";      
    messageDiv4.style.display = "none"; 
    messageDiv5.style.display = "none"; 
    messageDiv6.style.display = "none";
    messageDiv7.style.display = "none"; 
    messageDiv8.style.display = "none";
      
      
    textbox4.value = "";
    textbox6.value = "";             
// Function to populate tax table
    const table = document.getElementById("taxTable");

    const table1 = document.getElementById("taxTable1");  
 
    const table2 = document.getElementById("taxTable2");  

    const table3 = document.getElementById("taxTable3");  
      
    // Clear the table data (excluding header row)
    while (table.rows.length > 1) {
        table.deleteRow(1);
    }
    while (table1.rows.length > 1) {
        table1.deleteRow(1);
    } 
    while (table2.rows.length > 1) {
        table2.deleteRow(1);
    }
    while (table3.rows.length > 1) {
        table3.deleteRow(1);
    }           
      
      
    } else  if ( textbox10.value ==="2024" ) {
    textbox105.style.display = "none";       
    textbox1.style.display = "none";
    textbox1.value = "";            
    textbox102.style.display = "block";   
    textbox103.style.display = "block"; 
    textbox104.style.display = "none"; 
    net1.style.display = "block";   
    net2.style.display = "block"; 
    net3.style.display = "none";    
    net1.value = "";
    net2.value = "";
    net3.value = "";      
      
        
    messageDiv.style.display = "none";   
    messageDiv1.style.display = "none"; 
    messageDiv2.style.display = "none"; 
    messageDiv3.style.display = "none";      
    messageDiv4.style.display = "none"; 
    messageDiv5.style.display = "none"; 
    messageDiv6.style.display = "none";
    messageDiv7.style.display = "none"; 
    messageDiv8.style.display = "none";
      
     
    textbox4.value = "";
    textbox6.value = "";             
// Function to populate tax table
    const table = document.getElementById("taxTable");

    const table1 = document.getElementById("taxTable1");  
 
    const table2 = document.getElementById("taxTable2");  

    const table3 = document.getElementById("taxTable3");  
      
    // Clear the table data (excluding header row)
    while (table.rows.length > 1) {
        table.deleteRow(1);
    }
    while (table1.rows.length > 1) {
        table1.deleteRow(1);
    } 
    while (table2.rows.length > 1) {
        table2.deleteRow(1);
    }
    while (table3.rows.length > 1) {
        table3.deleteRow(1);
    }          
      
    } else  if ( textbox10.value ==="2025" ) {
    textbox105.style.display = "block";       
    textbox1.style.display = "block";
    textbox1.value = "";            
    textbox102.style.display = "none";   
    textbox103.style.display = "none"; 
    textbox104.style.display = "none"; 
    net1.style.display = "none";   
    net2.style.display = "none"; 
    net3.style.display = "none";    
    net1.value = "";
    net2.value = "";
    net3.value = "";      
      
        
    messageDiv.style.display = "none";   
    messageDiv1.style.display = "none"; 
    messageDiv2.style.display = "none"; 
    messageDiv3.style.display = "none";      
    messageDiv4.style.display = "none"; 
    messageDiv5.style.display = "none"; 
    messageDiv6.style.display = "none";
    messageDiv7.style.display = "none"; 
    messageDiv8.style.display = "none";
      
     
    textbox4.value = "";
    textbox6.value = "";             
// Function to populate tax table
    const table = document.getElementById("taxTable");

    const table1 = document.getElementById("taxTable1");  
 
    const table2 = document.getElementById("taxTable2");  

    const table3 = document.getElementById("taxTable3");  
      
    // Clear the table data (excluding header row)
    while (table.rows.length > 1) {
        table.deleteRow(1);
    }
    while (table1.rows.length > 1) {
        table1.deleteRow(1);
    } 
    while (table2.rows.length > 1) {
        table2.deleteRow(1);
    }
    while (table3.rows.length > 1) {
        table3.deleteRow(1);
    }      
      
                 
} 
  
// ------------------------------
      
    textbox5.value = caption; 

}           
        
</script> 
                  
                  
                  
    <script>
        function calculateTaxFromInspection() {
          
    const textbox1 = document.getElementById("textbox1");
    const textbox10 = document.getElementById("textbox10");
    const textbox6 = document.getElementById("textbox6");                      
    const dete1 = document.getElementById("dete1"); 
    const dete2 = document.getElementById("dete2");    
    const textbox12 = document.getElementById("textbox12");
          
    const textbox100 = document.getElementById("textbox100");
    const textbox101 = document.getElementById("textbox101");  

    const net1 = document.getElementById("net1"); 
    const net2 = document.getElementById("net2");  
    const net3 = document.getElementById("net3");          
          
    var selectBox = document.getElementById("textbox10");
    var selectedYear = selectBox.options[selectBox.selectedIndex].text;
    var messageDiv = document.getElementById("yearMessage");          
    var messageDiv1 = document.getElementById("yearMessage1");
    var messageDiv2 = document.getElementById("yearMessage2");
    var messageDiv3 = document.getElementById("yearMessage3");
    var messageDiv4 = document.getElementById("yearMessage4");
    var messageDiv5 = document.getElementById("yearMessage5");
    var messageDiv6 = document.getElementById("yearMessage6");
    var messageDiv7 = document.getElementById("yearMessage7");                    
    var messageDiv8 = document.getElementById("yearMessage8");                    
          
    let income = parseFloat(textbox1.value);         

    let income5 = parseFloat(net1.value);         
    let income10 = parseFloat(net2.value);           
    let income15 = parseFloat(net3.value); 
          
    if (textbox10.value === "-- اختر من القائمة السنة الضريبية --") {
    let caption = "يرجي إختيار السنة الضرييبة";
    showPopup(caption, 'error');       
    textbox10.focus();
    return;
      
    }          
          

    if (net1.value === "" && textbox1.style.display !== "block"  ) {      
    let caption = "يرجي إدخال صافي وعاء الفترة الأولي ( إدخال الأرقام باللغة الإنجليزية )";
    showPopup(caption, 'error');       
    net1.value = "";               
    net1.focus();
    return;

    }
 
    if (net2.value === "" && textbox1.style.display !== "block"  ) {      
    let caption = "يرجي إدخال صافي وعاء الفترة الثانية ( إدخال الأرقام باللغة الإنجليزية )";
    showPopup(caption, 'error');       
    net2.value = "";               
    net2.focus();
    return;

    }          

          
    if (net3.value === "" && textbox1.style.display !== "block" && textbox10.value !=="2020" && textbox10.value !=="2024" ) {      
    let caption = "يرجي إدخال صافي وعاء الفترة الثالثة ( إدخال الأرقام باللغة الإنجليزية )";
    showPopup(caption, 'error');       
    net3.value = "";               
    net3.focus();
    return;

    }
          
    if (textbox1.value === "" && textbox1.style.display !== "none" ) {      
    let caption = "يرجي إدخال صافي الوعاء الخاضع للضريبة ( إدخال الأرقام باللغة الإنجليزية )";
    showPopup(caption, 'error');       
    textbox1.value = "";               
    textbox1.focus();
    return;

    }
          
          
  // إخفاء جميع الجداول المعرفة بـ #taxTable1 إلى #taxTable4
  document.querySelectorAll("#taxTable2, #taxTable3, #taxTable4").forEach(table => {
    table.style.display = "none";
  });          
          
    let tax = 0;
    let tax0 = 0;
    let caption = "";
          
function populateTaxTable() {
    const table = document.getElementById("taxTable");
    if (table) {
        table.parentNode.removeChild(table); // Remove the table from its parent node
    }
}
          
function populateTaxTable1() {
    const table1 = document.getElementById("taxTable1");
    if (table1) {
        table1.parentNode.removeChild(table1); // Remove the table from its parent node
    }
}
          
function populateTaxTable2() {
    const table2 = document.getElementById("taxTable2");
    if (table2) {
        table2.parentNode.removeChild(table2); // Remove the table from its parent node
    }
}          

function populateTaxTable3() {
    const table3 = document.getElementById("taxTable3");
    if (table3) {
        table3.parentNode.removeChild(table3); // Remove the table from its parent node
    }
}          
          
      
   if ( textbox1.value >=0 && textbox10.value <=2005 ) {
  
    messageDiv.style.display = "block";   
    messageDiv1.style.display = "block"; 
    messageDiv2.style.display = "block"; 
    messageDiv3.style.display = "none";  
    messageDiv4.style.display = "none"; 
    messageDiv5.style.display = "none"; 
    messageDiv6.style.display = "none";
    messageDiv7.style.display = "none"; 
    messageDiv8.style.display = "none"; 
  

    let income0 = income - ( 4000 * 6 / 12 ); //الإعفاء الشخصي السنوي للممول
    let income1 = income0 * 2; //رد الوعاء الي سنة كاملة 
  
  messageDiv.textContent = "الإعفاء الشخصي السنوي للممول  : 4000 جنية الفترة الثانية |" + " " +" سنة : "+" "+ selectedYear + " " + "يخص الفترة من 01/07 حتي 31/12" + " " + "مبلغ :" + " " + ( 4000 * 6 / 12 ) + " " + "جنية";
  
  messageDiv1.textContent = "وعاء الفترة بعد خصم الإعفاء السنوي :" + " " + income0 + " " + " يرد الوعاء إلي سنة : " + income1 + " " + "جنية الصافي قبل خصم الشريحة المعفاة";
  
    if (income1 <= 5000) {
    tax = income1 * 0;
    } else if (income1 <= 20000) {
    tax = (((income1 - 5000) * 10 / 100) / 2).toFixed(0);
    } else if (income1 <= 40000) {
    tax = ((1500 + (income1 - 20000) * 15 / 100) / 2).toFixed(0);
    } else {
    tax = ((1500 + 3000 + (income1 - 40000) * 20 / 100) / 2).toFixed(0);    
    }

   // تحديث قيمة tax0 بعد حساب الضريبة وتحويل النتيجة إلى عدد صحيح
   tax0 = ( tax / 6 ).toFixed(0);

  // عرض القيمة الجديدة في textbox6
  textbox6.value = tax0;
     
    messageDiv2.textContent = "ضريبة الفترة الثانية : من 01/07 حتي 31/12/2005" + " " + ""+" هي : " + tax + " " + "جنية";    
  
   let caption = "يرجي العلم أن هذه السنة : 2005 الفترة من 01/01 حتي 30/06 يتم إحتساب الضريبة وفقا لقانون 162 لسنة 1997 والفترة من 01/07 حتي 31/12 يتم إحتساب الضريبة وفقا لقانون 91 لسنة 2005 ";
    showPopup( caption, 'warning');  
     
setTimeout(function() {  
   let caption = "تم حساب الضريبة بنجاح ! " + " صافي الوعاء الخاضع للضريبة : " + ( textbox1.value ) + " جنية " + " " + "السنة الضريبية : " + ( textbox10.value ) + " " + " الضريبة المستحقة : " + ( tax ) + " جنية " + "" + " الضريبة الشهرية : " + ( tax0 ) + " جنية ";
    showPopup( caption, 'info'); 
    }, 1500);     
     
  
// Define tax brackets
let netIncome = income0; // هذا مبلغ الدخل الصافي الذي ترغب في حساب الضريبة عليه

let taxBrackets;

if (netIncome <= 5000) {
  taxBrackets = [
    { minIncome: 1, maxIncome: income1, taxRate: 0, fixedTax: 0 }
  ];
} else if (netIncome <= 20000) {
  taxBrackets = [
    { minIncome: 1, maxIncome: 5000, taxRate: 0, fixedTax: 0 },
    { minIncome: 2, maxIncome: income1 - 5000, taxRate: 10, fixedTax: (income1 - 5000) * 10 / 100 }
  ];
} else if (netIncome <= 40000) {
  taxBrackets = [
    { minIncome: 1, maxIncome: 5000, taxRate: 0, fixedTax: 0 },
    { minIncome: 2, maxIncome: 15000, taxRate: 10, fixedTax: 15000 * 10 / 100 },
    { minIncome: 3, maxIncome: income1 - 20000, taxRate: 15, fixedTax: (income1 - 20000) * 15 / 100 }
  ];
} else {
  taxBrackets = [
    { minIncome: 1, maxIncome: 5000, taxRate: 0, fixedTax: 0 },
    { minIncome: 2, maxIncome: 15000, taxRate: 10, fixedTax: 15000 * 10 / 100 },
    { minIncome: 3, maxIncome: 20000, taxRate: 15, fixedTax: 20000 * 15 / 100 },
    { minIncome: 4, maxIncome: income1 - 40000, taxRate: 20, fixedTax: (income1 - 40000) * 20 / 100 }
  ];
}
  
console.log(taxBrackets);
// Function to populate tax table
function populateTaxTable() {
    const table = document.getElementById("taxTable");

    const table1 = document.getElementById("taxTable1");  
  
    // Clear the table data (excluding header row)
    while (table.rows.length > 1) {
        table.deleteRow(1);
    }
    while (table1.rows.length > 1) {
        table1.deleteRow(1);
    }

    // Populate the table with new data
    taxBrackets.forEach(bracket => {
        const row = table.insertRow(-1);
        const minIncomeCell = row.insertCell(0);
        const maxIncomeCell = row.insertCell(1);
        const taxRateCell = row.insertCell(2);
        const taxDueCell = row.insertCell(3);
        const remainingIncomeCell = row.insertCell(4); // Added cell for remaining income
        
        minIncomeCell.textContent = bracket.minIncome.toLocaleString(); // Display minimum income
        maxIncomeCell.textContent = bracket.maxIncome === Infinity ? "Infinity" : bracket.maxIncome.toLocaleString(); // Display maximum income
        taxRateCell.textContent = bracket.taxRate + "%"; // Display tax rate
        taxDueCell.textContent = bracket.fixedTax.toLocaleString(); // Display fixed tax amount
        const remainingIncome = bracket.maxIncome === Infinity ? 0 : bracket.maxIncome - bracket.fixedTax; // Calculate remaining income
        remainingIncomeCell.textContent = remainingIncome.toLocaleString(); // Display remaining income
    });
}


// Call the function to populate the tax table
populateTaxTable();        
      
      
      
} else  if ( textbox1.value >=0 && textbox10.value <=2010 ) {
    
    messageDiv.style.display = "block";  
    messageDiv1.style.display = "none"; 
    messageDiv2.style.display = "block"; 
    messageDiv3.style.display = "none"; 
    messageDiv4.style.display = "none"; 
    messageDiv5.style.display = "none"; 
    messageDiv6.style.display = "none";
    messageDiv7.style.display = "none"; 
    messageDiv8.style.display = "none";   
  
    let income0 = income - 4000; //الإعفاء الشخصي السنوي للممول
    messageDiv.textContent = "الإعفاء الشخصي السنوي للممول  : 4000 جنية" + " " +" سنة : "+" "+ selectedYear + " " + "الصافي قبل خصم الشريحة المعفاة :" + " " + income0 + " " + "جنية"; 
    if (income0 <= 5000) {
    tax = income0 * 0;
    } else if (income0 <= 20000) {
    tax = ((income0 - 5000) * 10 / 100).toFixed(0);
    } else if (income0 <= 40000) {
    tax = (1500 + (income0 - 20000) * 15 / 100).toFixed(0);
    } else {
    tax = (1500 + 3000 + (income0 - 40000) * 20 / 100).toFixed(0);
    } 
  
   // تحديث قيمة tax0 بعد حساب الضريبة وتحويل النتيجة إلى عدد صحيح
   tax0 = ( tax / 12 ).toFixed(0);

  // عرض القيمة الجديدة في textbox6
  textbox6.value = tax0;
  
    messageDiv2.textContent = "الضريبة السنوية : من 01/01 حتي 31/12" + " " + ""+" هي : " + tax + " " + "جنية";    
       
   let caption = "تم حساب الضريبة بنجاح ! " + " صافي الوعاء الخاضع للضريبة : " + ( textbox1.value ) + " جنية " + " " + "السنة الضريبية : " + ( textbox10.value ) + " " + " الضريبة المستحقة : " + ( tax ) + " جنية " + "" + " الضريبة الشهرية : " + ( tax0 ) + " جنية ";
    showPopup( caption, 'info'); 
  
// Define tax brackets
let netIncome = income0; // هذا مبلغ الدخل الصافي الذي ترغب في حساب الضريبة عليه

let taxBrackets;

if (netIncome <= 5000) {
  taxBrackets = [
    { minIncome: 1, maxIncome: income0, taxRate: 0, fixedTax: 0 }
  ];
} else if (netIncome <= 20000) {
  taxBrackets = [
    { minIncome: 1, maxIncome: 5000, taxRate: 0, fixedTax: 0 },
    { minIncome: 2, maxIncome: income0 - 5000, taxRate: 10, fixedTax: (income0 - 5000) * 10 / 100 }
  ];
} else if (netIncome <= 40000) {
  taxBrackets = [
    { minIncome: 1, maxIncome: 5000, taxRate: 0, fixedTax: 0 },
    { minIncome: 2, maxIncome: 15000, taxRate: 10, fixedTax: 15000 * 10 / 100 },
    { minIncome: 3, maxIncome: income0 - 20000, taxRate: 15, fixedTax: (income0 - 20000) * 15 / 100 }
  ];
} else {
  taxBrackets = [
    { minIncome: 1, maxIncome: 5000, taxRate: 0, fixedTax: 0 },
    { minIncome: 2, maxIncome: 15000, taxRate: 10, fixedTax: 15000 * 10 / 100 },
    { minIncome: 3, maxIncome: 20000, taxRate: 15, fixedTax: 20000 * 15 / 100 },
    { minIncome: 4, maxIncome: income0 - 40000, taxRate: 20, fixedTax: (income0 - 40000) * 20 / 100 }
  ];
}
  
console.log(taxBrackets);
// Function to populate tax table
function populateTaxTable() {
    const table = document.getElementById("taxTable");

    const table1 = document.getElementById("taxTable1");  
  
    // Clear the table data (excluding header row)
    while (table.rows.length > 1) {
        table.deleteRow(1);
    }
    while (table1.rows.length > 1) {
        table1.deleteRow(1);
    }

    // Populate the table with new data
    taxBrackets.forEach(bracket => {
        const row = table.insertRow(-1);
        const minIncomeCell = row.insertCell(0);
        const maxIncomeCell = row.insertCell(1);
        const taxRateCell = row.insertCell(2);
        const taxDueCell = row.insertCell(3);
        const remainingIncomeCell = row.insertCell(4); // Added cell for remaining income
        
        minIncomeCell.textContent = bracket.minIncome.toLocaleString(); // Display minimum income
        maxIncomeCell.textContent = bracket.maxIncome === Infinity ? "Infinity" : bracket.maxIncome.toLocaleString(); // Display maximum income
        taxRateCell.textContent = bracket.taxRate + "%"; // Display tax rate
        taxDueCell.textContent = bracket.fixedTax.toLocaleString(); // Display fixed tax amount
        const remainingIncome = bracket.maxIncome === Infinity ? 0 : bracket.maxIncome - bracket.fixedTax; // Calculate remaining income
        remainingIncomeCell.textContent = remainingIncome.toLocaleString(); // Display remaining income
    });
}


// Call the function to populate the tax table
populateTaxTable();        


   
  
} else  if ( textbox1.value >=0 && textbox10.value === "2011" ) {
  
    messageDiv.style.display = "block";  
    messageDiv1.style.display = "none"; 
    messageDiv2.style.display = "block"; 
    messageDiv3.style.display = "none"; 
    messageDiv4.style.display = "none"; 
    messageDiv5.style.display = "none"; 
    messageDiv6.style.display = "none";
    messageDiv7.style.display = "none"; 
    messageDiv8.style.display = "none";  
  

    let income0 = income - 4000; //الإعفاء الشخصي السنوي للممول
    messageDiv.textContent = "الإعفاء الشخصي السنوي للممول  : 4000 جنية" + " " +" سنة : "+" "+ selectedYear + " " + "الصافي قبل خصم الشريحة المعفاة :" + " " + income0 + " " + "جنية";
    if (income0 <= 5000) {
    tax = income0 * 0;
    } else if (income0 <= 20000) {
    tax = ((income0 - 5000) * 10 / 100).toFixed(0);
    } else if (income0 <= 40000) {
    tax = (1500 + (income0 - 20000) * 15 / 100).toFixed(0);
    } else if (income0 <= 10000000) {
    tax = (1500 + 3000 + (income0 - 40000) * 20 / 100).toFixed(0);      
    } else {
    tax = (1500 + 3000 + 1992000 + (income0 - 10000000) * 25 / 100).toFixed(0);
    }    

   // تحديث قيمة tax0 بعد حساب الضريبة وتحويل النتيجة إلى عدد صحيح
   tax0 = ( tax / 12 ).toFixed(0);

  // عرض القيمة الجديدة في textbox6
  textbox6.value = tax0;  
  
    messageDiv2.textContent = "الضريبة السنوية : من 01/01 حتي 31/12" + " " + ""+" هي : " + tax + " " + "جنية";      
  
   let caption = "تم حساب الضريبة بنجاح ! " + " صافي الوعاء الخاضع للضريبة : " + ( textbox1.value ) + " جنية " + " " + "السنة الضريبية : " + ( textbox10.value ) + " " + " الضريبة المستحقة : " + ( tax ) + " جنية " + "" + " الضريبة الشهرية : " + ( tax0 ) + " جنية ";
    showPopup( caption, 'info');   
  
// Define tax brackets
let netIncome = income0; // هذا مبلغ الدخل الصافي الذي ترغب في حساب الضريبة عليه

let taxBrackets;

if (netIncome <= 5000) {
  taxBrackets = [
    { minIncome: 1, maxIncome: income0, taxRate: 0, fixedTax: 0 }
  ];
} else if (netIncome <= 20000) {
  taxBrackets = [
    { minIncome: 1, maxIncome: 5000, taxRate: 0, fixedTax: 0 },
    { minIncome: 2, maxIncome: income0 - 5000, taxRate: 10, fixedTax: (income0 - 5000) * 10 / 100 }
  ];
} else if (netIncome <= 40000) {
  taxBrackets = [
    { minIncome: 1, maxIncome: 5000, taxRate: 0, fixedTax: 0 },
    { minIncome: 2, maxIncome: 15000, taxRate: 10, fixedTax: 15000 * 10 / 100 },
    { minIncome: 3, maxIncome: income0 - 20000, taxRate: 15, fixedTax: (income0 - 20000) * 15 / 100 }
  ];
} else if (netIncome <= 10000000) {
  taxBrackets = [
    { minIncome: 1, maxIncome: 5000, taxRate: 0, fixedTax: 0 },
    { minIncome: 2, maxIncome: 15000, taxRate: 10, fixedTax: 15000 * 10 / 100 },
    { minIncome: 3, maxIncome: 20000, taxRate: 15, fixedTax: 20000 * 15 / 100 },    
    { minIncome: 4, maxIncome: income0 - 40000, taxRate: 20, fixedTax: (income0 - 40000) * 20 / 100 }
  ];  
  
} else {
  taxBrackets = [
    { minIncome: 1, maxIncome: 5000, taxRate: 0, fixedTax: 0 },
    { minIncome: 2, maxIncome: 15000, taxRate: 10, fixedTax: 15000 * 10 / 100 },
    { minIncome: 3, maxIncome: 20000, taxRate: 15, fixedTax: 20000 * 15 / 100 },
    { minIncome: 4, maxIncome: 9960000, taxRate: 20, fixedTax: 9960000 * 20 / 100 },    
    { minIncome: 5, maxIncome: income0 - 10000000, taxRate: 25, fixedTax: (income0 - 10000000) * 25 / 100 }
  ];
}

console.log(taxBrackets);
// Function to populate tax table
function populateTaxTable() {
    const table = document.getElementById("taxTable");

    const table1 = document.getElementById("taxTable1");  
  
    // Clear the table data (excluding header row)
    while (table.rows.length > 1) {
        table.deleteRow(1);
    }
    while (table1.rows.length > 1) {
        table1.deleteRow(1);
    }

    // Populate the table with new data
    taxBrackets.forEach(bracket => {
        const row = table.insertRow(-1);
        const minIncomeCell = row.insertCell(0);
        const maxIncomeCell = row.insertCell(1);
        const taxRateCell = row.insertCell(2);
        const taxDueCell = row.insertCell(3);
        const remainingIncomeCell = row.insertCell(4); // Added cell for remaining income
        
        minIncomeCell.textContent = bracket.minIncome.toLocaleString(); // Display minimum income
        maxIncomeCell.textContent = bracket.maxIncome === Infinity ? "Infinity" : bracket.maxIncome.toLocaleString(); // Display maximum income
        taxRateCell.textContent = bracket.taxRate + "%"; // Display tax rate
        taxDueCell.textContent = bracket.fixedTax.toLocaleString(); // Display fixed tax amount
        const remainingIncome = bracket.maxIncome === Infinity ? 0 : bracket.maxIncome - bracket.fixedTax; // Calculate remaining income
        remainingIncomeCell.textContent = remainingIncome.toLocaleString(); // Display remaining income
    });
}


// Call the function to populate the tax table
populateTaxTable();  
  

  
} else  if ( textbox1.value >=0 && textbox10.value === "2012" ) {
  
    messageDiv.style.display = "block";  
    messageDiv1.style.display = "none"; 
    messageDiv2.style.display = "block"; 
    messageDiv3.style.display = "none"; 
    messageDiv4.style.display = "none"; 
    messageDiv5.style.display = "none"; 
    messageDiv6.style.display = "none";
    messageDiv7.style.display = "none"; 
    messageDiv8.style.display = "none";  
  

    let income0 = income - 4000; //الإعفاء الشخصي السنوي للممول
    messageDiv.textContent = "الإعفاء الشخصي السنوي للممول  : 4000 جنية" + " " +" سنة : "+" "+ selectedYear + " " + "الصافي قبل خصم الشريحة المعفاة :" + " " + income0 + " " + "جنية";
    if (income0 <= 5000) {
    tax = income0 * 0;
    } else if (income0 <= 30000) {
    tax = ((income0 - 5000) * 10 / 100).toFixed(0);
    } else if (income0 <= 45000) {
    tax = (2500 + (income0 - 30000) * 15 / 100).toFixed(0);
    } else if (income0 <= 1000000) {
    tax = (2500 + 2250 + (income0 - 45000) * 20 / 100).toFixed(0);      
    } else {
    tax = (2500 + 2250 + 191000 + (income0 - 1000000) * 25 / 100).toFixed(0);
    }    

   // تحديث قيمة tax0 بعد حساب الضريبة وتحويل النتيجة إلى عدد صحيح
   tax0 = ( tax / 12 ).toFixed(0);

  // عرض القيمة الجديدة في textbox6
  textbox6.value = tax0;  
  
    messageDiv2.textContent = "الضريبة السنوية : من 01/01 حتي 31/12" + " " + ""+" هي : " + tax + " " + "جنية";      
  
   let caption = "تم حساب الضريبة بنجاح ! " + " صافي الوعاء الخاضع للضريبة : " + ( textbox1.value ) + " جنية " + " " + "السنة الضريبية : " + ( textbox10.value ) + " " + " الضريبة المستحقة : " + ( tax ) + " جنية " + "" + " الضريبة الشهرية : " + ( tax0 ) + " جنية ";
    showPopup( caption, 'info'); 
  
  
// Define tax brackets
let netIncome = income0; // هذا مبلغ الدخل الصافي الذي ترغب في حساب الضريبة عليه

let taxBrackets;

if (netIncome <= 5000) {
  taxBrackets = [
    { minIncome: 1, maxIncome: income0, taxRate: 0, fixedTax: 0 }
  ];
} else if (netIncome <= 30000) {
  taxBrackets = [
    { minIncome: 1, maxIncome: 5000, taxRate: 0, fixedTax: 0 },
    { minIncome: 2, maxIncome: income0 - 5000, taxRate: 10, fixedTax: (income0 - 5000) * 10 / 100 }
  ];
} else if (netIncome <= 45000) {
  taxBrackets = [
    { minIncome: 1, maxIncome: 5000, taxRate: 0, fixedTax: 0 },
    { minIncome: 2, maxIncome: 25000, taxRate: 10, fixedTax: 25000 * 10 / 100 },
    { minIncome: 3, maxIncome: income0 - 30000, taxRate: 15, fixedTax: (income0 - 30000) * 15 / 100 }
  ];
} else if (netIncome <= 1000000) {
  taxBrackets = [
    { minIncome: 1, maxIncome: 5000, taxRate: 0, fixedTax: 0 },
    { minIncome: 2, maxIncome: 25000, taxRate: 10, fixedTax: 25000 * 10 / 100 },
    { minIncome: 3, maxIncome: 15000, taxRate: 15, fixedTax: 15000 * 15 / 100 },    
    { minIncome: 4, maxIncome: income0 - 45000, taxRate: 20, fixedTax: (income0 - 45000) * 20 / 100 }
  ];  
  
} else {
  taxBrackets = [
    { minIncome: 1, maxIncome: 5000, taxRate: 0, fixedTax: 0 },
    { minIncome: 2, maxIncome: 25000, taxRate: 10, fixedTax: 25000 * 10 / 100 },
    { minIncome: 3, maxIncome: 15000, taxRate: 15, fixedTax: 15000 * 15 / 100 },
    { minIncome: 4, maxIncome: 955000, taxRate: 20, fixedTax: 955000 * 20 / 100 },    
    { minIncome: 5, maxIncome: income0 - 1000000, taxRate: 25, fixedTax: (income0 - 1000000) * 25 / 100 }
  ];
}

console.log(taxBrackets);
// Function to populate tax table
function populateTaxTable() {
    const table = document.getElementById("taxTable");

    const table1 = document.getElementById("taxTable1");  
  
    // Clear the table data (excluding header row)
    while (table.rows.length > 1) {
        table.deleteRow(1);
    }
    while (table1.rows.length > 1) {
        table1.deleteRow(1);
    }

    // Populate the table with new data
    taxBrackets.forEach(bracket => {
        const row = table.insertRow(-1);
        const minIncomeCell = row.insertCell(0);
        const maxIncomeCell = row.insertCell(1);
        const taxRateCell = row.insertCell(2);
        const taxDueCell = row.insertCell(3);
        const remainingIncomeCell = row.insertCell(4); // Added cell for remaining income
        
        minIncomeCell.textContent = bracket.minIncome.toLocaleString(); // Display minimum income
        maxIncomeCell.textContent = bracket.maxIncome === Infinity ? "Infinity" : bracket.maxIncome.toLocaleString(); // Display maximum income
        taxRateCell.textContent = bracket.taxRate + "%"; // Display tax rate
        taxDueCell.textContent = bracket.fixedTax.toLocaleString(); // Display fixed tax amount
        const remainingIncome = bracket.maxIncome === Infinity ? 0 : bracket.maxIncome - bracket.fixedTax; // Calculate remaining income
        remainingIncomeCell.textContent = remainingIncome.toLocaleString(); // Display remaining income
    });
}


// Call the function to populate the tax table
populateTaxTable();   
  
  
  
} else  if ( net1.value >=0 && net2.value >=0 && net3.value >=0 && textbox10.value === "2013" ) {

    messageDiv.style.display = "block";   
    messageDiv1.style.display = "block"; 
    messageDiv2.style.display = "block"; 
    messageDiv3.style.display = "block";  
    messageDiv4.style.display = "block"; 
    messageDiv5.style.display = "block"; 
    messageDiv6.style.display = "block";
    messageDiv7.style.display = "block"; 
    messageDiv8.style.display = "block";  
  
// الفترة الأولي  
    let income6 = income5 - ( 4000 * 5 / 12 ).toFixed(0); // (الفترة الأولي) الإعفاء الشخصي السنوي للممول
    let income7 = (income6 / 5 * 12).toFixed(0); //رد الوعاء الي سنة كاملة 
  
  messageDiv.textContent = "الإعفاء الشخصي السنوي للممول  : 4000 جنية الفترة الأولي |" + " " +" سنة : "+" "+ selectedYear + " " + "يخص الفترة من 01/01 حتي 31/05" + " " + "مبلغ :" + " " + ( 4000 * 5 / 12 ).toFixed(0) + " " + "جنية";
  
  messageDiv1.textContent = "وعاء الفترة بعد خصم الإعفاء السنوي :" + " " + income6 + " " + " يرد الوعاء إلي سنة : " + income7 + " " + "جنية الصافي قبل خصم الشريحة المعفاة";
     
  
let tax1 = 0;  
if (income7 <= 5000) {
    tax1 = income7 * 0;
} else if (income7 <= 30000) {
    tax1 = ((income7 - 5000) * 10 / 100) * 5 / 12;
} else if (income7 <= 45000) {
    tax1 = (2500 + (income7 - 30000) * 15 / 100) * 5 / 12;
} else if (income7 <= 250000) {
    tax1 = (2500 + 2250 + (income7 - 45000) * 20 / 100) * 5 / 12;
} else {
    tax1 = ((2500 + 2250 + 41000 + (income7 - 250000) * 25 / 100 )) * 5 / 12;
} 

    messageDiv2.textContent = "ضريبة الفترة الأولي : من 01/01 حتي 31/05/2013" + " " + ""+" هي : " + tax1.toFixed(0) + " " + "جنية";      
  

// Define tax brackets
let netIncome = income7; // هذا مبلغ الدخل الصافي الذي ترغب في حساب الضريبة عليه
let name = " 📢 " + "سنة : " + selectedYear + " " + "الفترة الأولي : من 01/01 حتي 31/05/2013" + " | " + "وفقا للمادة الثامنة المعدلة بالمرسوم العسكري بالقانون رقم ( 51 ) لسنة 2011" + " 👌 ";

let taxBrackets;

if (netIncome <= 5000) {
  taxBrackets = [
    { minIncome: 1, maxIncome: income7, taxRate: 0, fixedTax: 0 }
  ];
showPopup( name, 'success');  
} else if (netIncome <= 30000) {
  taxBrackets = [
    { minIncome: 1, maxIncome: 5000, taxRate: 0, fixedTax: 0 },
    { minIncome: 2, maxIncome: income7 - 5000, taxRate: 10, fixedTax: (income7 - 5000) * 10 / 100 }
  ];
showPopup( name, 'success');  
} else if (netIncome <= 45000) {
  taxBrackets = [
    { minIncome: 1, maxIncome: 5000, taxRate: 0, fixedTax: 0 },
    { minIncome: 2, maxIncome: 25000, taxRate: 10, fixedTax: 25000 * 10 / 100 },
    { minIncome: 3, maxIncome: income7 - 30000, taxRate: 15, fixedTax: (income7 - 30000) * 15 / 100 }
  ];
showPopup( name, 'success');    
} else if (netIncome <= 250000) {
  taxBrackets = [
    { minIncome: 1, maxIncome: 5000, taxRate: 0, fixedTax: 0 },
    { minIncome: 2, maxIncome: 25000, taxRate: 10, fixedTax: 25000 * 10 / 100 },
    { minIncome: 3, maxIncome: 15000, taxRate: 15, fixedTax: 15000 * 15 / 100 },     
    { minIncome: 4, maxIncome: income7 - 45000, taxRate: 20, fixedTax: (income7 - 45000) * 20 / 100 }
  ];
showPopup( name, 'success');    
} else {
  taxBrackets = [
    { minIncome: 1, maxIncome: 5000, taxRate: 0, fixedTax: 0 },
    { minIncome: 2, maxIncome: 25000, taxRate: 10, fixedTax: 25000 * 10 / 100 },
    { minIncome: 3, maxIncome: 15000, taxRate: 15, fixedTax: 15000 * 15 / 100 },
    { minIncome: 4, maxIncome: 205000, taxRate: 20, fixedTax: 205000 * 20 / 100 },    
    { minIncome: 5, maxIncome: income7 - 250000, taxRate: 25, fixedTax: (income7 - 250000) * 25 / 100 }
  ];
showPopup( name, 'success');    
}

console.log(taxBrackets);
// Function to populate tax table
function populateTaxTable() {
  
// إظهار الجداول   
      document.getElementById("taxTable2").style.display = "table";
      document.getElementById("taxTable3").style.display = "table";

 
  
  const table = document.getElementById("taxTable");

  // Clear the table data (excluding header row)
  while (table.rows.length > 1) {
    table.deleteRow(1);
  }

  // Populate the table with new data
  taxBrackets.forEach(bracket => {
    const row = table.insertRow(-1);
    const minIncomeCell = row.insertCell(0);
    const maxIncomeCell = row.insertCell(1);
    const taxRateCell = row.insertCell(2);
    const taxDueCell = row.insertCell(3);
    const remainingIncomeCell = row.insertCell(4); // Added cell for remaining income

    minIncomeCell.textContent = bracket.minIncome.toLocaleString(); // Display minimum income
    maxIncomeCell.textContent = bracket.maxIncome === Infinity ? "Infinity" : bracket.maxIncome.toLocaleString(); // Display maximum income
    taxRateCell.textContent = bracket.taxRate + "%"; // Display tax rate
    taxDueCell.textContent = bracket.fixedTax.toLocaleString(); // Display fixed tax amount
    const remainingIncome = bracket.maxIncome === Infinity ? 0 : bracket.maxIncome - bracket.fixedTax; // Calculate remaining income
    remainingIncomeCell.textContent = remainingIncome.toLocaleString(); // Display remaining income
  });
}

// Call the function to populate the tax table
populateTaxTable(); 
  
  
//جدول الفترة الثانية  
let income11 = income10 - (4000 * 3 / 12).toFixed(0); //الاعفاء الشخصي السنوي (الفترة الثانية)
let income12 = (income11 / 3 * 12).toFixed(0); //رد الوعاء الي سنة كاملة 

messageDiv3.textContent = "الإعفاء الشخصي السنوي للممول  : 4000 جنية الفترة الثانية |" + " " + " سنة : " + " " + selectedYear + " " + "يخص الفترة من 01/06 حتي 31/08" + " " + "مبلغ :" + " " + (4000 * 3 / 12).toFixed(0) + " " + "جنية";

messageDiv4.textContent = "وعاء الفترة بعد خصم الإعفاء السنوي :" + " " + income11 + " " + " يرد الوعاء إلي سنة : " + income12 + " " + "جنية الصافي قبل خصم الشريحة المعفاة";
    let tax2 =0;
if (income12 <= 5000) {
  tax2 = income12 * 0;
} else if (income12 <= 30000) {
  tax2 = ((income12 - 5000) * 10 / 100) * 3 / 12;
} else if (income12 <= 45000) {
  tax2 = (2500 + (income12 - 30000) * 15 / 100) * 3 / 12;
} else if (income12 <= 250000) {
  tax2 = (2500 + 2250 + (income12 - 45000) * 20 / 100) * 3 / 12;
} else {
  tax2 = ((2500 + 2250 + 41000 + (income12 - 250000) * 25 / 100)) * 3 / 12;
}

messageDiv5.textContent = "ضريبة الفترة الثانية : من 01/06 حتي 31/08/2013" + " " + "" + " هي : " + tax2.toFixed(0) + " " + "جنية";


// Define tax brackets
let netIncome2 = income12; // هذا مبلغ الدخل الصافي الذي ترغب في حساب الضريبة عليه
let name1 = " 📢 " + "سنة : " + selectedYear + " " + "الفترة الثانية : من 01/06 حتي 31/08/2013" + " | " + "وفقا للمادة الثامنة المعدلة بالقانون رقم ( 101 ) لسنة 2012" + " 👌 ";
let taxBrackets2;

if (netIncome2 <= 5000) {
  taxBrackets2 = [
    { minIncome: 1, maxIncome: income12, taxRate: 0, fixedTax: 0 }
  ];
setTimeout(function() {  
showPopup( name1, 'success');
}, 1500);  
} else if (netIncome2 <= 30000) {
  taxBrackets2 = [
    { minIncome: 1, maxIncome: 5000, taxRate: 0, fixedTax: 0 },
    { minIncome: 2, maxIncome: income12 - 5000, taxRate: 10, fixedTax: (income12 - 5000) * 10 / 100 }
  ];
setTimeout(function() {  
showPopup( name1, 'success');
}, 1500);   
} else if (netIncome2 <= 45000) {
  taxBrackets2 = [
    { minIncome: 1, maxIncome: 5000, taxRate: 0, fixedTax: 0 },
    { minIncome: 2, maxIncome: 25000, taxRate: 10, fixedTax: 25000 * 10 / 100 },
    { minIncome: 3, maxIncome: income12 - 30000, taxRate: 15, fixedTax: (income12 - 30000) * 15 / 100 }
  ];
setTimeout(function() {  
showPopup( name1, 'success');
}, 1500);   
} else if (netIncome2 <= 250000) {
  taxBrackets2 = [
    { minIncome: 1, maxIncome: 5000, taxRate: 0, fixedTax: 0 },
    { minIncome: 2, maxIncome: 25000, taxRate: 10, fixedTax: 25000 * 10 / 100 },
    { minIncome: 3, maxIncome: 15000, taxRate: 15, fixedTax: 15000 * 15 / 100 },
    { minIncome: 4, maxIncome: income12 - 45000, taxRate: 20, fixedTax: (income12 - 45000) * 20 / 100 }
  ];
setTimeout(function() {  
showPopup( name1, 'success');
}, 1500);   
} else {
  taxBrackets2 = [
    { minIncome: 1, maxIncome: 5000, taxRate: 0, fixedTax: 0 },
    { minIncome: 2, maxIncome: 25000, taxRate: 10, fixedTax: 25000 * 10 / 100 },
    { minIncome: 3, maxIncome: 15000, taxRate: 15, fixedTax: 15000 * 15 / 100 },
    { minIncome: 4, maxIncome: 205000, taxRate: 20, fixedTax: 205000 * 20 / 100 },
    { minIncome: 5, maxIncome: income12 - 250000, taxRate: 25, fixedTax: (income12 - 250000) * 25 / 100 }
  ];
setTimeout(function() {  
showPopup( name1, 'success');
}, 1500);   
}

console.log(taxBrackets2);
// Function to populate tax table 2
function populateTaxTable2() {
  const table2 = document.getElementById("taxTable2");

  // Clear the table data (excluding header row)
  while (table2.rows.length > 1) {
    table2.deleteRow(1);
  }

  // Populate the table with new data
  taxBrackets2.forEach(bracket2 => {
    const row = table2.insertRow(-1);
    const minIncomeCell = row.insertCell(0);
    const maxIncomeCell = row.insertCell(1);
    const taxRateCell = row.insertCell(2);
    const taxDueCell = row.insertCell(3);
    const remainingIncomeCell = row.insertCell(4); // Added cell for remaining income

    minIncomeCell.textContent = bracket2.minIncome.toLocaleString(); // Display minimum income
    maxIncomeCell.textContent = bracket2.maxIncome === Infinity ? "Infinity" : bracket2.maxIncome.toLocaleString(); // Display maximum income
    taxRateCell.textContent = bracket2.taxRate + "%"; // Display tax rate
    taxDueCell.textContent = bracket2.fixedTax.toLocaleString(); // Display fixed tax amount
    const remainingIncome = bracket2.maxIncome === Infinity ? 0 : bracket2.maxIncome - bracket2.fixedTax; // Calculate remaining income
    remainingIncomeCell.textContent = remainingIncome.toLocaleString(); // Display remaining income
  });
}

// Call the function to populate the tax table 2
populateTaxTable2(); 
  


//جدول الفترة الثالثة  
let income16 = income15 - (7000 * 4 / 12).toFixed(0); //الاعفاء الشخصي السنوي (الفترة الثانية)
let income17 = (income16 / 4 * 12 ).toFixed(0); //رد الوعاء الي سنة كاملة 

  messageDiv6.textContent = "الإعفاء الشخصي السنوي للممول  : 7000 جنية  الفترة الثالثة |" + " " + " سنة : " + " " + selectedYear + " " + "يخص الفترة من 01/01 حتي 31/12" + " " + "مبلغ :" + " " + (7000 * 4 / 12).toFixed(0) + " " + "جنية";

messageDiv7.textContent = "وعاء الفترة بعد خصم الإعفاء السنوي :" + " " + income16 + " " + " يرد الوعاء إلي سنة : " + income17 + " " + "جنية الصافي قبل خصم الشريحة المعفاة";

    let tax3 =0;  
if (income17 <= 5000) {
  tax3 = income17 * 0;
} else if (income17 <= 30000) {
  tax3 = ((income17 - 5000) * 10 / 100) * 4 / 12;
} else if (income17 <= 45000) {
  tax3 = (2500 + (income17 - 30000) * 15 / 100) * 4 / 12;
} else if (income17 <= 250000) {
  tax3 = (2500 + 2250 + (income17 - 45000) * 20 / 100) * 4 / 12;
} else {
  tax3 = ((2500 + 2250 + 41000 + (income17 - 250000) * 25 / 100)) * 4 / 12;
}

messageDiv8.textContent = "ضريبة الفترة الثالثة : من 01/09 حتي 31/12/2013" + " " + "" + " هي : " + tax3.toFixed(0) + " " + "جنية";

  
// إجمالي ضريبة الفترات الثلاثة  
tax = (tax1 + tax2 + tax3).toFixed(0);

   // تحديث قيمة tax0 بعد حساب الضريبة وتحويل النتيجة إلى عدد صحيح
   tax0 = ( tax / 12 ).toFixed(0);

  // عرض القيمة الجديدة في textbox6
  textbox6.value = tax0;  
  
// Define tax brackets
let netIncome3 = income17; // هذا مبلغ الدخل الصافي الذي ترغب في حساب الضريبة عليه
let name2 = " 📢 " + "سنة : " + selectedYear + " " + "الفترة الثالثة : من 01/09 حتي 31/12/2013" + " | " + "وفقا للمادة الثامنة المعدلة بالقانون رقم ( 11 ) لسنة 2013" + " 👌 ";

let taxBrackets3;

if (netIncome3 <= 5000) {
  taxBrackets3 = [
    { minIncome: 1, maxIncome: income17, taxRate: 0, fixedTax: 0 }
  ];
setTimeout(function() {  
showPopup( name2, 'success');
}, 3000);  
} else if (netIncome3 <= 30000) {
  taxBrackets3 = [
    { minIncome: 1, maxIncome: 5000, taxRate: 0, fixedTax: 0 },
    { minIncome: 2, maxIncome: income17 - 5000, taxRate: 10, fixedTax: (income17 - 5000) * 10 / 100 }
  ];
setTimeout(function() {  
showPopup( name2, 'success');
}, 3000);   
} else if (netIncome3 <= 45000) {
  taxBrackets3 = [
    { minIncome: 1, maxIncome: 5000, taxRate: 0, fixedTax: 0 },
    { minIncome: 2, maxIncome: 25000, taxRate: 10, fixedTax: 25000 * 10 / 100 },
    { minIncome: 3, maxIncome: income17 - 30000, taxRate: 15, fixedTax: (income17 - 30000) * 15 / 100 }
  ];
setTimeout(function() {  
showPopup( name2, 'success');
}, 3000);   
} else if (netIncome3 <= 250000) {
  taxBrackets3 = [
    { minIncome: 1, maxIncome: 5000, taxRate: 0, fixedTax: 0 },
    { minIncome: 2, maxIncome: 25000, taxRate: 10, fixedTax: 25000 * 10 / 100 },
    { minIncome: 3, maxIncome: 15000, taxRate: 15, fixedTax: 15000 * 15 / 100 },
    { minIncome: 4, maxIncome: income17 - 45000, taxRate: 20, fixedTax: (income17 - 45000) * 20 / 100 }
  ];
setTimeout(function() {  
showPopup( name2, 'success');
}, 3000);   
} else {
  taxBrackets3 = [
    { minIncome: 1, maxIncome: 5000, taxRate: 0, fixedTax: 0 },
    { minIncome: 2, maxIncome: 25000, taxRate: 10, fixedTax: 25000 * 10 / 100 },
    { minIncome: 3, maxIncome: 15000, taxRate: 15, fixedTax: 15000 * 15 / 100 },
    { minIncome: 4, maxIncome: 205000, taxRate: 20, fixedTax: 205000 * 20 / 100 },
    { minIncome: 5, maxIncome: income17 - 250000, taxRate: 25, fixedTax: (income17 - 250000) * 25 / 100 }
  ];
setTimeout(function() {  
showPopup( name2, 'success');
}, 3000);   
}

setTimeout(function() {  
   let caption = "تم حساب الضريبة بنجاح ! " + " صافي الوعاء الخاضع للضريبة : " + ( textbox1.value ) + " جنية " + " " + "السنة الضريبية : " + ( textbox10.value ) + " " + " الضريبة المستحقة : " + ( tax ) + " جنية " + "" + " الضريبة الشهرية : " + ( tax0 ) + " جنية ";
    showPopup( caption, 'info'); 
    }, 3750);  
  
console.log(taxBrackets3);
// Function to populate tax table 3
function populateTaxTable3() {
  const table3 = document.getElementById("taxTable3");

  // Clear the table data (excluding header row)
  while (table3.rows.length > 1) {
    table3.deleteRow(1);
  }

  // Populate the table with new data
  taxBrackets3.forEach(bracket3 => {
    const row = table3.insertRow(-1);
    const minIncomeCell = row.insertCell(0);
    const maxIncomeCell = row.insertCell(1);
    const taxRateCell = row.insertCell(2);
    const taxDueCell = row.insertCell(3);
    const remainingIncomeCell = row.insertCell(4); // Added cell for remaining income

    minIncomeCell.textContent = bracket3.minIncome.toLocaleString(); // Display minimum income
    maxIncomeCell.textContent = bracket3.maxIncome === Infinity ? "Infinity" : bracket3.maxIncome.toLocaleString(); // Display maximum income
    taxRateCell.textContent = bracket3.taxRate + "%"; // Display tax rate
    taxDueCell.textContent = bracket3.fixedTax.toLocaleString(); // Display fixed tax amount
    const remainingIncome = bracket3.maxIncome === Infinity ? 0 : bracket3.maxIncome - bracket3.fixedTax; // Calculate remaining income
    remainingIncomeCell.textContent = remainingIncome.toLocaleString(); // Display remaining income
  });
}

// Call the function to populate the tax table 3
populateTaxTable3();  
  
  
  
  
  
} else  if ( textbox1.value >=0 && textbox10.value === "2014" ) {

    messageDiv.style.display = "block";  
    messageDiv1.style.display = "none"; 
    messageDiv2.style.display = "block"; 
    messageDiv3.style.display = "none"; 
    messageDiv4.style.display = "none"; 
    messageDiv5.style.display = "none"; 
    messageDiv6.style.display = "none";
    messageDiv7.style.display = "none"; 
    messageDiv8.style.display = "none";   
  
  
    let income0 = income - 7000; //الإعفاء الشخصي السنوي للممول
    messageDiv.textContent = "الإعفاء الشخصي السنوي للممول  : 7000 جنية" + " " +" سنة : "+" "+ selectedYear + " " + "الصافي قبل خصم الشريحة المعفاة :" + " " + income0 + " " + "جنية";  
    if (income0 <= 5000) {
    tax = income0 * 0;
    } else if (income0 <= 30000) {
    tax = ((income0 - 5000) * 10 / 100).toFixed(0);
    } else if (income0 <= 45000) {
    tax = (2500 + (income0 - 30000) * 15 / 100).toFixed(0);
    } else if (income0 <= 250000) {
    tax = (2500 + 2250 + (income0 - 45000) * 20 / 100).toFixed(0);
    } else if (income0 <= 1000000) {
    tax = (2500 + 2250 + 41000 + (income0 - 250000) * 25 / 100).toFixed(0);      
    } else {
    tax = (2500 + 2250 + 41000 + 187500 + (income0 - 1000000) * 30 / 100).toFixed(0);
    }   

   // تحديث قيمة tax0 بعد حساب الضريبة وتحويل النتيجة إلى عدد صحيح
   tax0 = ( tax / 12 ).toFixed(0);

  // عرض القيمة الجديدة في textbox6
  textbox6.value = tax0;   
  
    messageDiv2.textContent = "الضريبة السنوية : من 01/01 حتي 31/12" + " " + ""+" هي : " + tax + " " + "جنية";        
  
   let caption = "تم حساب الضريبة بنجاح ! " + " صافي الوعاء الخاضع للضريبة : " + ( textbox1.value ) + " جنية " + " " + "السنة الضريبية : " + ( textbox10.value ) + " " + " الضريبة المستحقة : " + ( tax ) + " جنية " + "" + " الضريبة الشهرية : " + ( tax0 ) + " جنية ";
    showPopup( caption, 'info');   

// Define tax brackets
let netIncome = income0; // هذا مبلغ الدخل الصافي الذي ترغب في حساب الضريبة عليه

let taxBrackets;

if (netIncome <= 5000) {
  taxBrackets = [
    { minIncome: 1, maxIncome: income0, taxRate: 0, fixedTax: 0 }
  ];
} else if (netIncome <= 30000) {
  taxBrackets = [
    { minIncome: 1, maxIncome: 5000, taxRate: 0, fixedTax: 0 },
    { minIncome: 2, maxIncome: income0 - 5000, taxRate: 10, fixedTax: (income0 - 5000) * 10 / 100 }
  ];
} else if (netIncome <= 45000) {
  taxBrackets = [
    { minIncome: 1, maxIncome: 5000, taxRate: 0, fixedTax: 0 },
    { minIncome: 2, maxIncome: 25000, taxRate: 10, fixedTax: 25000 * 10 / 100 },
    { minIncome: 3, maxIncome: income0 - 30000, taxRate: 15, fixedTax: (income0 - 30000) * 15 / 100 }
  ];
} else if (netIncome <= 250000) {
  taxBrackets = [
    { minIncome: 1, maxIncome: 5000, taxRate: 0, fixedTax: 0 },
    { minIncome: 2, maxIncome: 25000, taxRate: 10, fixedTax: 25000 * 10 / 100 },
    { minIncome: 3, maxIncome: 15000, taxRate: 15, fixedTax: 15000 * 15 / 100 },     
    { minIncome: 4, maxIncome: income0 - 45000, taxRate: 20, fixedTax: (income0 - 45000) * 20 / 100 }
  ];
} else if (netIncome <= 1000000) {
  taxBrackets = [
    { minIncome: 1, maxIncome: 5000, taxRate: 0, fixedTax: 0 },
    { minIncome: 2, maxIncome: 25000, taxRate: 10, fixedTax: 25000 * 10 / 100 },
    { minIncome: 3, maxIncome: 15000, taxRate: 15, fixedTax: 15000 * 15 / 100 },  
    { minIncome: 4, maxIncome: 205000, taxRate: 20, fixedTax: 205000 * 20 / 100 }, 
    { minIncome: 5, maxIncome: income0 - 250000, taxRate: 25, fixedTax: (income0 - 250000) * 25 / 100 }
  ];
} else {
  taxBrackets = [
    { minIncome: 1, maxIncome: 5000, taxRate: 0, fixedTax: 0 },
    { minIncome: 2, maxIncome: 25000, taxRate: 10, fixedTax: 25000 * 10 / 100 },
    { minIncome: 3, maxIncome: 15000, taxRate: 15, fixedTax: 15000 * 15 / 100 },
    { minIncome: 4, maxIncome: 205000, taxRate: 20, fixedTax: 205000 * 20 / 100 },
    { minIncome: 5, maxIncome: 750000, taxRate: 25, fixedTax: 750000 * 25 / 100 }, 
    { minIncome: 6, maxIncome: income0 - 1000000, taxRate: 30, fixedTax: (income0 - 1000000) * 30 / 100 }
  ];
}

console.log(taxBrackets);
// Function to populate tax table
function populateTaxTable() {
    const table = document.getElementById("taxTable");

    const table1 = document.getElementById("taxTable1");  
  
    // Clear the table data (excluding header row)
    while (table.rows.length > 1) {
        table.deleteRow(1);
    }
    while (table1.rows.length > 1) {
        table1.deleteRow(1);
    }

    // Populate the table with new data
    taxBrackets.forEach(bracket => {
        const row = table.insertRow(-1);
        const minIncomeCell = row.insertCell(0);
        const maxIncomeCell = row.insertCell(1);
        const taxRateCell = row.insertCell(2);
        const taxDueCell = row.insertCell(3);
        const remainingIncomeCell = row.insertCell(4); // Added cell for remaining income
        
        minIncomeCell.textContent = bracket.minIncome.toLocaleString(); // Display minimum income
        maxIncomeCell.textContent = bracket.maxIncome === Infinity ? "Infinity" : bracket.maxIncome.toLocaleString(); // Display maximum income
        taxRateCell.textContent = bracket.taxRate + "%"; // Display tax rate
        taxDueCell.textContent = bracket.fixedTax.toLocaleString(); // Display fixed tax amount
        const remainingIncome = bracket.maxIncome === Infinity ? 0 : bracket.maxIncome - bracket.fixedTax; // Calculate remaining income
        remainingIncomeCell.textContent = remainingIncome.toLocaleString(); // Display remaining income
    });
}


// Call the function to populate the tax table
populateTaxTable();    
     
  
} else  if ( textbox1.value >=0 && textbox10.value <=2016 ) {

    messageDiv.style.display = "block";  
    messageDiv1.style.display = "none"; 
    messageDiv2.style.display = "block"; 
    messageDiv3.style.display = "none"; 
    messageDiv4.style.display = "none"; 
    messageDiv5.style.display = "none"; 
    messageDiv6.style.display = "none";
    messageDiv7.style.display = "none"; 
    messageDiv8.style.display = "none";     
  
    let income0 = income - 7000; //الإعفاء الشخصي السنوي للممول
    messageDiv.textContent = "الإعفاء الشخصي السنوي للممول  : 7000 جنية" + " " +" سنة : "+" "+ selectedYear + " " + "الصافي قبل خصم الشريحة المعفاة :" + " " + income0 + " " + "جنية"; 
    if (income0 <= 6500) {
    tax = income0 * 0;
    } else if (income0 <= 30000) {
    tax = ((income0 - 6500) * 10 / 100).toFixed(0);
    } else if (income0 <= 45000) {
    tax = (2350 + (income0 - 30000) * 15 / 100).toFixed(0);
    } else if (income0 <= 200000) {
    tax = (2350 + 2250 + (income0 - 45000) * 20 / 100).toFixed(0);
    } else {
    tax = (2350 + 2250 + 31000 + (income0 - 200000) * 22.5 / 100).toFixed(0);
    } 
  
   // تحديث قيمة tax0 بعد حساب الضريبة وتحويل النتيجة إلى عدد صحيح
   tax0 = ( tax / 12 ).toFixed(0);

  // عرض القيمة الجديدة في textbox6
  textbox6.value = tax0; 
  
    messageDiv2.textContent = "الضريبة السنوية : من 01/01 حتي 31/12" + " " + ""+" هي : " + tax + " " + "جنية";        
  
   let caption = "تم حساب الضريبة بنجاح ! " + " صافي الوعاء الخاضع للضريبة : " + ( textbox1.value ) + " جنية " + " " + "السنة الضريبية : " + ( textbox10.value ) + " " + " الضريبة المستحقة : " + ( tax ) + " جنية " + "" + " الضريبة الشهرية : " + ( tax0 ) + " جنية ";
    showPopup( caption, 'info');  

  
// Define tax brackets
let netIncome = income0; // هذا مبلغ الدخل الصافي الذي ترغب في حساب الضريبة عليه

let taxBrackets;

if (netIncome <= 6500) {
  taxBrackets = [
    { minIncome: 1, maxIncome: income0, taxRate: 0, fixedTax: 0 }
  ];
} else if (netIncome <= 30000) {
  taxBrackets = [
    { minIncome: 1, maxIncome: 6500, taxRate: 0, fixedTax: 0 },
    { minIncome: 2, maxIncome: income0 - 6500, taxRate: 10, fixedTax: (income0 - 6500) * 10 / 100 }
  ];
} else if (netIncome <= 45000) {
  taxBrackets = [
    { minIncome: 1, maxIncome: 6500, taxRate: 0, fixedTax: 0 },
    { minIncome: 2, maxIncome: 23500, taxRate: 10, fixedTax: 23500 * 10 / 100 },
    { minIncome: 3, maxIncome: income0 - 30000, taxRate: 15, fixedTax: (income0 - 30000) * 15 / 100 }
  ];
} else if (netIncome <= 200000) {
  taxBrackets = [
    { minIncome: 1, maxIncome: 6500, taxRate: 0, fixedTax: 0 },
    { minIncome: 2, maxIncome: 23500, taxRate: 10, fixedTax: 23500 * 10 / 100 },
    { minIncome: 3, maxIncome: 15000, taxRate: 15, fixedTax: 15000 * 15 / 100 },
    { minIncome: 4, maxIncome: income0 - 45000, taxRate: 20, fixedTax: (income0 - 45000) * 20 / 100 }    
  ];
} else {
  taxBrackets = [
    { minIncome: 1, maxIncome: 6500, taxRate: 0, fixedTax: 0 },
    { minIncome: 2, maxIncome: 23500, taxRate: 10, fixedTax: 23500 * 10 / 100 },
    { minIncome: 3, maxIncome: 15000, taxRate: 15, fixedTax: 15000 * 15 / 100 },
    { minIncome: 4, maxIncome: 155000, taxRate: 20, fixedTax: 155000 * 20 / 100 },    
    { minIncome: 5, maxIncome: income0 - 200000, taxRate: 22.5, fixedTax: (income0 - 200000) * 22.5 / 100 }
  ];
}

console.log(taxBrackets);
// Function to populate tax table
function populateTaxTable() {
    const table = document.getElementById("taxTable");

    const table1 = document.getElementById("taxTable1");  
  
    // Clear the table data (excluding header row)
    while (table.rows.length > 1) {
        table.deleteRow(1);
    }
    while (table1.rows.length > 1) {
        table1.deleteRow(1);
    }

    // Populate the table with new data
    taxBrackets.forEach(bracket => {
        const row = table.insertRow(-1);
        const minIncomeCell = row.insertCell(0);
        const maxIncomeCell = row.insertCell(1);
        const taxRateCell = row.insertCell(2);
        const taxDueCell = row.insertCell(3);
        const remainingIncomeCell = row.insertCell(4); // Added cell for remaining income
        
        minIncomeCell.textContent = bracket.minIncome.toLocaleString(); // Display minimum income
        maxIncomeCell.textContent = bracket.maxIncome === Infinity ? "Infinity" : bracket.maxIncome.toLocaleString(); // Display maximum income
        taxRateCell.textContent = bracket.taxRate + "%"; // Display tax rate
        taxDueCell.textContent = bracket.fixedTax.toLocaleString(); // Display fixed tax amount
        const remainingIncome = bracket.maxIncome === Infinity ? 0 : bracket.maxIncome - bracket.fixedTax; // Calculate remaining income
        remainingIncomeCell.textContent = remainingIncome.toLocaleString(); // Display remaining income
    });
}


// Call the function to populate the tax table
populateTaxTable();   
  
  
} else  if ( textbox1.value >=0 && textbox10.value === "2017" ) {  

    messageDiv.style.display = "block";   
    messageDiv1.style.display = "none"; 
    messageDiv2.style.display = "block"; 
    messageDiv3.style.display = "none";  
    messageDiv4.style.display = "none"; 
    messageDiv5.style.display = "block"; 
    messageDiv6.style.display = "none";
    messageDiv7.style.display = "none"; 
    messageDiv8.style.display = "block";   
  
    let income0 = income - 7000; //الإعفاء الشخصي السنوي للممول
    messageDiv.textContent = "الإعفاء الشخصي السنوي للممول  : 7000 جنية" + " " +" سنة : "+" "+ selectedYear + " " + "الصافي قبل خصم الشريحة المعفاة :" + " " + income0 + " " + "جنية";
    if (income0 <= 7200) {
    tax = income0 * 0;

      
    } else if (income0 <= 30000) {
    tax = (((income0 - 7200) * 10 / 100 / 2) + ((income0 - 7200) * 10 / 100 / 2) * (20 / 100)).toFixed(0);

      
    } else if (income0 <= 45000) {
    tax = (((2280 + (income0 - 30000) * 15 / 100 )) /2  + (((2280 + (income0 - 30000) * 15 / 100)) /2) * (60 / 100)).toFixed(0);
      
      
    } else if (income0 <= 200000) {
    tax = (((2280 + 2250 + (income0 - 45000) * 20 / 100 )) /2 + ((2280 + 2250 + (income0 - 45000) * 20 / 100)) /2 * (95 / 100)).toFixed(0);
    
      
    } else {
    tax = (((2280 + 2250 + 31000 + (income0 - 200000) * 22.5 / 100 )) /2 + ((2280 + 2250 + 31000 + (income0 - 200000) * 22.5 / 100)) /2).toFixed(0);
    }  

  
   // تحديث قيمة tax0 بعد حساب الضريبة وتحويل النتيجة إلى عدد صحيح
   tax0 = ( tax / 12 ).toFixed(0);

  // عرض القيمة الجديدة في textbox6
  textbox6.value = tax0;   

// Define tax brackets
let netIncome = income0; // هذا مبلغ الدخل الصافي الذي ترغب في حساب الضريبة عليه

let taxBrackets;

if (netIncome <= 7200) {
  taxBrackets = [
    { minIncome: 1, maxIncome: income0, taxRate: 0, fixedTax: 0 }
  ];
  
    messageDiv2.textContent = "ضريبة الفترة الأولي : من 01/01 حتي 30/06/2017" + " " + ""+" هي : " + ((income0) * 0/2) + " " + "جنية";       
  
} else if (netIncome <= 30000) {
  taxBrackets = [
    { minIncome: 1, maxIncome: 7200, taxRate: 0, fixedTax: 0 },
    { minIncome: 2, maxIncome: income0 - 7200, taxRate: 10, fixedTax: (income0 - 7200) * 10 / 100 }
  ];
  
    messageDiv2.textContent = "ضريبة الفترة الأولي : من 01/01 حتي 30/06/2017" + " " + ""+" هي : " + (((income0 - 7200) * 10 / 100 ) /2 ).toFixed(0) + " " + "جنية";    
 
  
} else if (netIncome <= 45000) {
  taxBrackets = [
    { minIncome: 1, maxIncome: 7200, taxRate: 0, fixedTax: 0 },
    { minIncome: 2, maxIncome: 22800, taxRate: 10, fixedTax: 22800 * 10 / 100 },
    { minIncome: 3, maxIncome: income0 - 30000, taxRate: 15, fixedTax: (income0 - 30000) * 15 / 100 }
  ];

  
    messageDiv2.textContent = "ضريبة الفترة الأولي : من 01/01 حتي 30/06/2017" + " " + ""+" هي : " + (((2280 + (income0 - 30000) * 15 / 100 )) /2 ).toFixed(0) + " " + "جنية";    
  
  
} else if (netIncome <= 200000) {
  taxBrackets = [
    { minIncome: 1, maxIncome: 7200, taxRate: 0, fixedTax: 0 },
    { minIncome: 2, maxIncome: 22800, taxRate: 10, fixedTax: 22800 * 10 / 100 },
    { minIncome: 3, maxIncome: 15000, taxRate: 15, fixedTax: 15000 * 15 / 100 },
    { minIncome: 4, maxIncome: income0 - 45000, taxRate: 20, fixedTax: (income0 - 45000) * 20 / 100 }    
  ];

  
    messageDiv2.textContent = "ضريبة الفترة الأولي : من 01/01 حتي 30/06/2017" + " " + ""+" هي : " + (((2280 + 2250 + (income0 - 45000) * 20 / 100 )) /2 ).toFixed(0) + " " + "جنية";    
    
  
} else {
  taxBrackets = [
    { minIncome: 1, maxIncome: 7200, taxRate: 0, fixedTax: 0 },
    { minIncome: 2, maxIncome: 22800, taxRate: 10, fixedTax: 22800 * 10 / 100 },
    { minIncome: 3, maxIncome: 15000, taxRate: 15, fixedTax: 15000 * 15 / 100 },
    { minIncome: 4, maxIncome: 155000, taxRate: 20, fixedTax: 155000 * 20 / 100 },    
    { minIncome: 5, maxIncome: income0 - 200000, taxRate: 22.5, fixedTax: (income0 - 200000) * 22.5 / 100 }
  ];
  
  
    messageDiv2.textContent = "ضريبة الفترة الأولي : من 01/01 حتي 30/06/2017" + " " + ""+" هي : " + (((2280 + 2250 + 31000 + (income0 - 200000) * 22.5 / 100 )) /2).toFixed(0) + " " + "جنية";    
  
  
}

console.log(taxBrackets);
// Function to populate tax table
function populateTaxTable() {

// إظهار جدول الخصم   
     document.getElementById("taxTable1").style.display = "table"; 
  
    const table = document.getElementById("taxTable");

    const table1 = document.getElementById("taxTable1");  
  
    // Clear the table data (excluding header row)
    while (table.rows.length > 1) {
        table.deleteRow(1);
    }
    while (table1.rows.length > 1) {
        table1.deleteRow(1);
    }

    // Populate the table with new data
    taxBrackets.forEach(bracket => {
        const row = table.insertRow(-1);
        const minIncomeCell = row.insertCell(0);
        const maxIncomeCell = row.insertCell(1);
        const taxRateCell = row.insertCell(2);
        const taxDueCell = row.insertCell(3);
        const remainingIncomeCell = row.insertCell(4); // Added cell for remaining income
        
        minIncomeCell.textContent = bracket.minIncome.toLocaleString(); // Display minimum income
        maxIncomeCell.textContent = bracket.maxIncome === Infinity ? "Infinity" : bracket.maxIncome.toLocaleString(); // Display maximum income
        taxRateCell.textContent = bracket.taxRate + "%"; // Display tax rate
        taxDueCell.textContent = bracket.fixedTax.toLocaleString(); // Display fixed tax amount
        const remainingIncome = bracket.maxIncome === Infinity ? 0 : bracket.maxIncome - bracket.fixedTax; // Calculate remaining income
        remainingIncomeCell.textContent = remainingIncome.toLocaleString(); // Display remaining income
    });
}


// Call the function to populate the tax table
populateTaxTable();
  
  
  
  
  
  
// جدول الخصم الضريبي  
// Define tax brackets
let netIncome1 = income0; // هذا مبلغ الدخل الصافي الذي ترغب في حساب الضريبة عليه

let taxBrackets1;

if (netIncome1 <= 7200) {
  taxBrackets1 = [
    { minIncome: 1, maxIncome: "-", taxRate: "", fixedTax: "-" }
  ];
  
    messageDiv5.textContent = "ضريبة الفترة الثانية : من 01/07 حتي 31/12/2017" + " " + ""+" هي : " + ((income0) * 0/2) + " " + "جنية"; 
    messageDiv8.textContent = "ضريبة الفترة الأولي + الفترة الثانية ( سنة كاملة )" + " " + ""+" هي : " + (income0 * 0 / 100) + " " + "جنية";  
  
} else if (netIncome1 <= 30000) {
  taxBrackets1 = [
    { minIncome: 1, maxIncome: "الثانية", taxRate: 80, fixedTax: ((income0 - 7200) * 10 / 100/2) * (-80 / 100) }
  ];
  
    messageDiv5.textContent = "ضريبة الفترة الثانية : من 01/07 حتي 31/12/2017" + " " + ""+" هي : " + (((income0 - 7200) * 10 / 100/2) * (20 / 100)).toFixed(0) + " " + "جنية بعد الخصم الضريبي"; 
    messageDiv8.textContent = "ضريبة الفترة الأولي + الفترة الثانية بدون الخصم الضريبي ( سنة كاملة )" + " " + ""+" هي : " + (income0 - 7200) * 10 / 100 + " " + "جنية";
  
  
} else if (netIncome1 <= 45000) {
  taxBrackets1 = [
    { minIncome: 1, maxIncome: "الثالثة", taxRate: 40, fixedTax: ((2280 + (income0 - 30000) * 15 / 100) /2  * (-40 / 100)) }
  ];
  
    messageDiv5.textContent = "ضريبة الفترة الثانية : من 01/07 حتي 31/12/2017" + " " + ""+" هي : " + (((2280 + (income0 - 30000) * 15 / 100)) /2 * (60 / 100)).toFixed(0) + " " + "جنية بعد الخصم الضريبي"; 
    messageDiv8.textContent = "ضريبة الفترة الأولي + الفترة الثانية بدون الخصم الضريبي ( سنة كاملة )" + " " + ""+" هي : " + ( 2280 + (income0 - 30000) * 15 / 100 ) + " " + "جنية";
  
} else if (netIncome1 <= 200000) {
  taxBrackets1 = [
    { minIncome: 1, maxIncome: "الرابعة", taxRate: 5, fixedTax: ((2280 + 2250 + (income0 - 45000) * 20 / 100) /2  * (-5 / 100)) }    
  ];

    messageDiv5.textContent = "ضريبة الفترة الثانية : من 01/07 حتي 31/12/2017" + " " + ""+" هي : " + (((2280 + 2250 + (income0 - 45000) * 20 / 100)) /2 * (95 / 100)).toFixed(0) + " " + "جنية بعد الخصم الضريبي"; 
    messageDiv8.textContent = "ضريبة الفترة الأولي + الفترة الثانية بدون الخصم الضريبي ( سنة كاملة )" + " " + ""+" هي : " + ( 2280 + 2250 + (income0 - 45000) * 20 / 100 ) + " " + "جنية";  
  
} else {
  taxBrackets1 = [
    { minIncome: 1, maxIncome: "الخامسة", taxRate: 0, fixedTax: 0 }
  ];
  
    messageDiv5.textContent = "ضريبة الفترة الثانية : من 01/07 حتي 31/12/2017" + " " + ""+" هي : " + (((2280 + 2250 + 31000 + (income0 - 200000) * 22.5 / 100)) /2 * (100 / 100)).toFixed(0) + " " + "جنية ( لا يوجد خصم ضريبي )"; 
    messageDiv8.textContent = "ضريبة الفترة الأولي + الفترة الثانية بدون الخصم الضريبي ( سنة كاملة )" + " " + ""+" هي : " + ( 2280 + 2250 + 31000 +(income0 - 200000) * 22.5 / 100 ) + " " + "جنية";    
  
}

   let caption = "تم حساب الضريبة بنجاح ! " + " صافي الوعاء الخاضع للضريبة : " + ( textbox1.value ) + " جنية " + " " + "السنة الضريبية : " + ( textbox10.value ) + " " + " الضريبة المستحقة : " + ( tax ) + " جنية " + "" + " الضريبة الشهرية : " + ( tax0 ) + " جنية ";
    showPopup( caption, 'info');  
  
console.log(taxBrackets1);
// Function to populate tax table
function populateTaxTable1() {

    const table1 = document.getElementById("taxTable1");  
  
    // Clear the table data (excluding header row)
    while (table1.rows.length > 1) {
        table1.deleteRow(1);
    }

    // Populate the table with new data
    taxBrackets1.forEach(bracket1 => {
        const row = table1.insertRow(-1);
        const minIncomeCell = row.insertCell(0);
        const maxIncomeCell = row.insertCell(1);
        const taxRateCell = row.insertCell(2);
        const taxDueCell = row.insertCell(3);
        const remainingIncomeCell = row.insertCell(4); // Added cell for remaining income
        
        minIncomeCell.textContent = bracket1.minIncome.toLocaleString(); // Display minimum income
        maxIncomeCell.textContent = bracket1.maxIncome === Infinity ? "Infinity" : bracket1.maxIncome.toLocaleString(); // Display maximum income
        taxRateCell.textContent = bracket1.taxRate + "%"; // Display tax rate
        taxDueCell.textContent = bracket1.fixedTax.toLocaleString(); // Display fixed tax amount
        const remainingIncome = bracket1.maxIncome === Infinity ? 0 : bracket1.maxIncome - bracket1.fixedTax; // Calculate remaining income
        remainingIncomeCell.textContent = "-"; // Display remaining income
    });
}


// Call the function to populate the tax table
populateTaxTable1();  
  

  
  
} else  if ( textbox1.value >=0 && textbox10.value ==="2018" ) {

    messageDiv.style.display = "block";   
    messageDiv1.style.display = "none"; 
    messageDiv2.style.display = "block"; 
    messageDiv3.style.display = "none";  
    messageDiv4.style.display = "none"; 
    messageDiv5.style.display = "block"; 
    messageDiv6.style.display = "none";
    messageDiv7.style.display = "none"; 
    messageDiv8.style.display = "block";   
  
    let income0 = income - 7000; //الإعفاء الشخصي السنوي للممول
    messageDiv.textContent = "الإعفاء الشخصي السنوي للممول  : 7000 جنية" + " " +" سنة : "+" "+ selectedYear + " " + "الصافي قبل خصم الشريحة المعفاة :" + " " + income0 + " " + "جنية";
    if (income0 <= 8000) {
    tax = income * 0;

      
    } else if (income0 <= 30000) {
    tax = (((income0 - 8000) * 10 / 100 / 2) * 20 / 100 + ((income0 - 8000) * 10 / 100/2) * (15 / 100)).toFixed(0);
      
      
    } else if (income0 <= 45000) {
    tax = (((2200 + (income0 - 30000) * 15 / 100 ) / 2 ) * 60 / 100 + ((2200 + (income0 - 30000) * 15 / 100)) /2 * (55 / 100)).toFixed(0);
       
      
    } else if (income0 <= 200000) {
    tax = ((2200 + 2250 + (income0 - 45000) * 20 / 100 ) / 2 * ( 95 / 100 ) + ((2200 + 2250 + (income0 - 45000) * 20 / 100)) /2 * (92.5 / 100)).toFixed(0);
        
      
    } else {
    tax = ((2200 + 2250 + 31000 + (income0 - 200000) * 22.5 / 100 ) / 2 * 100 / 100 + ((2200 + 2250 + 31000 + (income0 - 200000) * 22.5 / 100)) /2 * (100 / 100)).toFixed(0);
    }  


   // تحديث قيمة tax0 بعد حساب الضريبة وتحويل النتيجة إلى عدد صحيح
   tax0 = ( tax / 12 ).toFixed(0);

  // عرض القيمة الجديدة في textbox6
  textbox6.value = tax0; 
  
  
// Define tax brackets
let netIncome = income0; // هذا مبلغ الدخل الصافي الذي ترغب في حساب الضريبة عليه

let taxBrackets;

if (netIncome <= 8000) {
  taxBrackets = [
    { minIncome: 1, maxIncome: income0, taxRate: 0, fixedTax: 0 }
  ];

    messageDiv2.textContent = "ضريبة الفترة الأولي : من 01/01 حتي 30/06/2018" + " " + ""+" هي : " + ((income0) * 0/2) + " " + "جنية بعد الخصم الضريبي";  
  
  
} else if (netIncome <= 30000) {
  taxBrackets = [
    { minIncome: 1, maxIncome: 8000, taxRate: 0, fixedTax: 0 },
    { minIncome: 2, maxIncome: income0 - 8000, taxRate: 10, fixedTax: (income0 - 8000) * 10 / 100 }
  ];
  
  
    messageDiv2.textContent = "ضريبة الفترة الأولي : من 01/01 حتي 30/06/2018" + " " + ""+" هي : " + (((income0 - 8000) * 10 / 100 / 2) * 20 / 100).toFixed(0) + " " + "جنية بعد الخصم الضريبي";    
  
  
} else if (netIncome <= 45000) {
  taxBrackets = [
    { minIncome: 1, maxIncome: 8000, taxRate: 0, fixedTax: 0 },
    { minIncome: 2, maxIncome: 22000, taxRate: 10, fixedTax: 22000 * 10 / 100 },
    { minIncome: 3, maxIncome: income0 - 30000, taxRate: 15, fixedTax: (income0 - 30000) * 15 / 100 }
  ];

    messageDiv2.textContent = "ضريبة الفترة الأولي : من 01/01 حتي 30/06/2018" + " " + ""+" هي : " + ((2200 + (income0 - 30000) * 15 / 100 ) / 2 * 60 / 100).toFixed(0) + " " + "جنية بعد الخصم الضريبي";    
  
} else if (netIncome <= 200000) {
  taxBrackets = [
    { minIncome: 1, maxIncome: 8000, taxRate: 0, fixedTax: 0 },
    { minIncome: 2, maxIncome: 22000, taxRate: 10, fixedTax: 22000 * 10 / 100 },
    { minIncome: 3, maxIncome: 15000, taxRate: 15, fixedTax: 15000 * 15 / 100 },
    { minIncome: 4, maxIncome: income0 - 45000, taxRate: 20, fixedTax: (income0 - 45000) * 20 / 100 }    
  ];

  
      messageDiv2.textContent = "ضريبة الفترة الأولي : من 01/01 حتي 30/06/2018" + " " + ""+" هي : " + ((2200 + 2250 + (income0 - 45000) * 20 / 100 ) / 2 * ( 95 / 100 )).toFixed(0) + " " + "جنية بعد الخصم الضريبي";    

  
} else {
  taxBrackets = [
    { minIncome: 1, maxIncome: 8000, taxRate: 0, fixedTax: 0 },
    { minIncome: 2, maxIncome: 22000, taxRate: 10, fixedTax: 22000 * 10 / 100 },
    { minIncome: 3, maxIncome: 15000, taxRate: 15, fixedTax: 15000 * 15 / 100 },
    { minIncome: 4, maxIncome: 155000, taxRate: 20, fixedTax: 155000 * 20 / 100 },    
    { minIncome: 5, maxIncome: income0 - 200000, taxRate: 22.5, fixedTax: (income0 - 200000) * 22.5 / 100 }
  ];

      messageDiv2.textContent = "ضريبة الفترة الأولي : من 01/01 حتي 30/06/2018" + " " + ""+" هي : " + ((2200 + 2250 + 31000 + (income0 - 200000) * 22.5 / 100 ) / 2 * 100 / 100).toFixed(0) + " " + "جنية ( لا يوجد خصم ضريبي )";     
  
}

   let caption = "تم حساب الضريبة بنجاح ! " + " صافي الوعاء الخاضع للضريبة : " + ( textbox1.value ) + " جنية " + " " + "السنة الضريبية : " + ( textbox10.value ) + " " + " الضريبة المستحقة : " + ( tax ) + " جنية " + "" + " الضريبة الشهرية : " + ( tax0 ) + " جنية ";
    showPopup( caption, 'info');   
  
console.log(taxBrackets);
// Function to populate tax table
function populateTaxTable() {
  
// اظهار جداول الخصم
      document.getElementById("taxTable1").style.display = "table";
      document.getElementById("taxTable4").style.display = "table";
  
    const table = document.getElementById("taxTable");

    const table1 = document.getElementById("taxTable1");  
  
    // Clear the table data (excluding header row)
    while (table.rows.length > 1) {
        table.deleteRow(1);
    }
    while (table1.rows.length > 1) {
        table1.deleteRow(1);
    }

    // Populate the table with new data
    taxBrackets.forEach(bracket => {
        const row = table.insertRow(-1);
        const minIncomeCell = row.insertCell(0);
        const maxIncomeCell = row.insertCell(1);
        const taxRateCell = row.insertCell(2);
        const taxDueCell = row.insertCell(3);
        const remainingIncomeCell = row.insertCell(4); // Added cell for remaining income
        
        minIncomeCell.textContent = bracket.minIncome.toLocaleString(); // Display minimum income
        maxIncomeCell.textContent = bracket.maxIncome === Infinity ? "Infinity" : bracket.maxIncome.toLocaleString(); // Display maximum income
        taxRateCell.textContent = bracket.taxRate + "%"; // Display tax rate
        taxDueCell.textContent = bracket.fixedTax.toLocaleString(); // Display fixed tax amount
        const remainingIncome = bracket.maxIncome === Infinity ? 0 : bracket.maxIncome - bracket.fixedTax; // Calculate remaining income
        remainingIncomeCell.textContent = remainingIncome.toLocaleString(); // Display remaining income
    });
}


// Call the function to populate the tax table
populateTaxTable();
  
  
  
  
  
  
// 1 جدول الخصم الضريبي  
// Define tax brackets
let netIncome1 = income0; // هذا مبلغ الدخل الصافي الذي ترغب في حساب الضريبة عليه

let taxBrackets1;

if (netIncome1 <= 8000) {
  taxBrackets1 = [
    { minIncome: 1, maxIncome: "-", taxRate: "", fixedTax: "-" }
  ];
  
 
  
} else if (netIncome1 <= 30000) {
  taxBrackets1 = [
    { minIncome: 1, maxIncome: "الثانية", taxRate: 80, fixedTax: ((income0 - 8000) * 10 / 100/2) * (-80 / 100) }
  ];
  
  
  
} else if (netIncome1 <= 45000) {
  taxBrackets1 = [
    { minIncome: 1, maxIncome: "الثالثة", taxRate: 40, fixedTax: ((2200 + (income0 - 30000) * 15 / 100) /2  * (-40 / 100)) }
  ];
  

  
} else if (netIncome1 <= 200000) {
  taxBrackets1 = [
    { minIncome: 1, maxIncome: "الرابعة", taxRate: 5, fixedTax: ((2200 + 2250 + (income0 - 45000) * 20 / 100) /2  * (-5 / 100)) }    
  ];

 
  
} else {
  taxBrackets1 = [
    { minIncome: 1, maxIncome: "الخامسة", taxRate: 0, fixedTax: 0 }
  ];
  
  
  
}

console.log(taxBrackets1);
// Function to populate tax table
function populateTaxTable1() {

    const table1 = document.getElementById("taxTable1");  
  
    // Clear the table data (excluding header row)
    while (table1.rows.length > 1) {
        table1.deleteRow(1);
    }

    // Populate the table with new data
    taxBrackets1.forEach(bracket1 => {
        const row = table1.insertRow(-1);
        const minIncomeCell = row.insertCell(0);
        const maxIncomeCell = row.insertCell(1);
        const taxRateCell = row.insertCell(2);
        const taxDueCell = row.insertCell(3);
        const remainingIncomeCell = row.insertCell(4); // Added cell for remaining income
        
        minIncomeCell.textContent = bracket1.minIncome.toLocaleString(); // Display minimum income
        maxIncomeCell.textContent = bracket1.maxIncome === Infinity ? "Infinity" : bracket1.maxIncome.toLocaleString(); // Display maximum income
        taxRateCell.textContent = bracket1.taxRate + "%"; // Display tax rate
        taxDueCell.textContent = bracket1.fixedTax.toLocaleString(); // Display fixed tax amount
        const remainingIncome = bracket1.maxIncome === Infinity ? 0 : bracket1.maxIncome - bracket1.fixedTax; // Calculate remaining income
        remainingIncomeCell.textContent = "-"; // Display remaining income
    });
}


// Call the function to populate the tax table
populateTaxTable1();  
  

  
  
  
  
// 2 جدول الخصم الضريبي  
// Define tax brackets
let netIncome2 = income0; // هذا مبلغ الدخل الصافي الذي ترغب في حساب الضريبة عليه

let taxBrackets2;

if (netIncome2 <= 8000) {
  taxBrackets2 = [
    { minIncome: 1, maxIncome: "-", taxRate: "", fixedTax: "-" }
  ];
  
 
  
} else if (netIncome2 <= 30000) {
  taxBrackets2 = [
    { minIncome: 1, maxIncome: "الثانية", taxRate: 85, fixedTax: ((income0 - 8000) * 10 / 100/2) * (-85 / 100) }
  ];
  
    messageDiv5.textContent = "ضريبة الفترة الثانية : من 01/07 حتي 31/12/2018" + " " + ""+" هي : " + (((income0 - 8000) * 10 / 100/2) * (15 / 100)).toFixed(0) + " " + "جنية بعد الخصم الضريبي"; 
    messageDiv8.textContent = "ضريبة الفترة الأولي + الفترة الثانية بدون الخصم الضريبي ( سنة كاملة )" + " " + ""+" هي : " + (income0 - 8000) * 10 / 100 + " " + "جنية";  
  
} else if (netIncome2 <= 45000) {
  taxBrackets2 = [
    { minIncome: 1, maxIncome: "الثالثة", taxRate: 45, fixedTax: ((2200 + (income0 - 30000) * 15 / 100) /2  * (-45 / 100)) }
  ];

  messageDiv5.textContent = "ضريبة الفترة الثانية : من 01/07 حتي 31/12/2018" + " " + ""+" هي : " + (((2200 + (income0 - 30000) * 15 / 100)) /2 * (55 / 100)).toFixed(0) + " " + "جنية بعد الخصم الضريبي"; 
    messageDiv8.textContent = "ضريبة الفترة الأولي + الفترة الثانية بدون الخصم الضريبي ( سنة كاملة )" + " " + ""+" هي : " + ( 2200 + (income0 - 30000) * 15 / 100 ) + " " + "جنية";
  
} else if (netIncome2 <= 200000) {
  taxBrackets2 = [
    { minIncome: 1, maxIncome: "الرابعة", taxRate: 7.5, fixedTax: ((2200 + 2250 + (income0 - 45000) * 20 / 100) /2  * (-7.5 / 100)) }    
  ];

    messageDiv5.textContent = "ضريبة الفترة الثانية : من 01/07 حتي 31/12/2018" + " " + ""+" هي : " + (((2200 + 2250 + (income0 - 45000) * 20 / 100)) /2 * (92.5 / 100)).toFixed(0) + " " + "جنية بعد الخصم الضريبي"; 
    messageDiv8.textContent = "ضريبة الفترة الأولي + الفترة الثانية بدون الخصم الضريبي ( سنة كاملة )" + " " + ""+" هي : " + ( 2200 + 2250 + (income0 - 45000) * 20 / 100 ) + " " + "جنية";  
  
} else {
  taxBrackets2 = [
    { minIncome: 1, maxIncome: "الخامسة", taxRate: 0, fixedTax: 0 }
  ];
  
    messageDiv5.textContent = "ضريبة الفترة الثانية : من 01/07 حتي 31/12/2018" + " " + ""+" هي : " + (((2200 + 2250 + 31000 + (income0 - 200000) * 22.5 / 100)) /2 * (100 / 100)).toFixed(0) + " " + "جنية ( لا يوجد خصم ضريبي )"; 
    messageDiv8.textContent = "ضريبة الفترة الأولي + الفترة الثانية بدون الخصم الضريبي ( سنة كاملة )" + " " + ""+" هي : " + ( 2200 + 2250 + 31000 +(income0 - 200000) * 22.5 / 100 ) + " " + "جنية";   
  
}

console.log(taxBrackets2);
// Function to populate tax table
function populateTaxTable2() {

    const table4 = document.getElementById("taxTable4");  
  
    // Clear the table data (excluding header row)
    while (table4.rows.length > 1) {
        table4.deleteRow(1);
    }

    // Populate the table with new data
    taxBrackets2.forEach(bracket2 => {
        const row = table4.insertRow(-1);
        const minIncomeCell = row.insertCell(0);
        const maxIncomeCell = row.insertCell(1);
        const taxRateCell = row.insertCell(2);
        const taxDueCell = row.insertCell(3);
        const remainingIncomeCell = row.insertCell(4); // Added cell for remaining income
        
        minIncomeCell.textContent = bracket2.minIncome.toLocaleString(); // Display minimum income
        maxIncomeCell.textContent = bracket2.maxIncome === Infinity ? "Infinity" : bracket2.maxIncome.toLocaleString(); // Display maximum income
        taxRateCell.textContent = bracket2.taxRate + "%"; // Display tax rate
        taxDueCell.textContent = bracket2.fixedTax.toLocaleString(); // Display fixed tax amount
        const remainingIncome = bracket2.maxIncome === Infinity ? 0 : bracket2.maxIncome - bracket2.fixedTax; // Calculate remaining income
        remainingIncomeCell.textContent = "-"; // Display remaining income
    });
}


// Call the function to populate the tax table
populateTaxTable2();  
  
  
  
  
  
} else  if ( textbox1.value >=0 && textbox10.value ==="2019" ) {

    messageDiv.style.display = "block";   
    messageDiv1.style.display = "none"; 
    messageDiv2.style.display = "block"; 
    messageDiv3.style.display = "none";  
    messageDiv4.style.display = "none"; 
    messageDiv5.style.display = "block"; 
    messageDiv6.style.display = "none";
    messageDiv7.style.display = "none"; 
    messageDiv8.style.display = "none";  
  
    let income0 = income - 7000; //الإعفاء الشخصي السنوي للممول
    messageDiv.textContent = "الإعفاء الشخصي السنوي للممول  : 7000 جنية" + " " +" سنة : "+" "+ selectedYear + " " + "الصافي قبل خصم الشريحة المعفاة :" + " " + income0 + " " + "جنية";
    if (income0 <= 8000) {
    tax = income * 0;

      
    } else if (income0 <= 30000) {
    tax = (((income0 - 8000) * 10 / 100 ) * (15 / 100)).toFixed(0);
      
      
    } else if (income0 <= 45000) {
    tax = (((2200 + (income0 - 30000) * 15 / 100)) * (55 / 100)).toFixed(0);
       
      
    } else if (income0 <= 200000) {
    tax = (((2200 + 2250 + (income0 - 45000) * 20 / 100)) * (92.5 / 100)).toFixed(0);
        
      
    } else {
    tax = (((2200 + 2250 + 31000 + (income0 - 200000) * 22.5 / 100)) * (100 / 100)).toFixed(0);
    }  

   // تحديث قيمة tax0 بعد حساب الضريبة وتحويل النتيجة إلى عدد صحيح
   tax0 = ( tax / 12 ).toFixed(0);

  // عرض القيمة الجديدة في textbox6
  textbox6.value = tax0
  
  
// Define tax brackets
let netIncome = income0; // هذا مبلغ الدخل الصافي الذي ترغب في حساب الضريبة عليه

let taxBrackets;

if (netIncome <= 8000) {
  taxBrackets = [
    { minIncome: 1, maxIncome: income0, taxRate: 0, fixedTax: 0 }
  ];

    messageDiv2.textContent = "الضريبة السنوية : من 01/01 حتي 31/12/2019" + " " + ""+" هي : " + ((income0) * 0) + " " + "جنية بعد الخصم الضريبي";  
 
  
} else if (netIncome <= 30000) {
  taxBrackets = [
    { minIncome: 1, maxIncome: 8000, taxRate: 0, fixedTax: 0 },
    { minIncome: 2, maxIncome: income0 - 8000, taxRate: 10, fixedTax: (income0 - 8000) * 10 / 100 }
  ];
  
  
    messageDiv2.textContent = "الضريبة السنوية : من 01/01 حتي 31/12/2019" + " " + ""+" هي : " + (((income0 - 8000) * 10 / 100 ) * 15 / 100).toFixed(0) + " " + "جنية بعد الخصم الضريبي";
  
    messageDiv5.textContent = "الضريبة السنوية بدون الخصم الضريبي ( سنة كاملة )" + " " + ""+" هي : " + ((income0 - 8000) * 10 / 100).toFixed(0) + " " + "جنية";  
  
  
  
} else if (netIncome <= 45000) {
  taxBrackets = [
    { minIncome: 1, maxIncome: 8000, taxRate: 0, fixedTax: 0 },
    { minIncome: 2, maxIncome: 22000, taxRate: 10, fixedTax: 22000 * 10 / 100 },
    { minIncome: 3, maxIncome: income0 - 30000, taxRate: 15, fixedTax: (income0 - 30000) * 15 / 100 }
  ];

    messageDiv2.textContent = "الضريبة السنوية : من 01/01 حتي 31/12/2019" + " " + ""+" هي : " + ((2200 + (income0 - 30000) * 15 / 100 ) * 55 / 100).toFixed(0) + " " + "جنية بعد الخصم الضريبي";  
  
    messageDiv5.textContent = "الضريبة السنوية بدون الخصم الضريبي ( سنة كاملة )" + " " + ""+" هي : " + ((2200 + (income0 - 30000) * 15 / 100 ) * 100 / 100).toFixed(0) + " " + "جنية";  
  

  
} else if (netIncome <= 200000) {
  taxBrackets = [
    { minIncome: 1, maxIncome: 8000, taxRate: 0, fixedTax: 0 },
    { minIncome: 2, maxIncome: 22000, taxRate: 10, fixedTax: 22000 * 10 / 100 },
    { minIncome: 3, maxIncome: 15000, taxRate: 15, fixedTax: 15000 * 15 / 100 },
    { minIncome: 4, maxIncome: income0 - 45000, taxRate: 20, fixedTax: (income0 - 45000) * 20 / 100 }    
  ];

  
      messageDiv2.textContent = "الضريبة السنوية : من 01/01 حتي 31/12/2019" + " " + ""+" هي : " + ((2200 + 2250 + (income0 - 45000) * 20 / 100 ) * ( 92.5 / 100 )).toFixed(0) + " " + "جنية بعد الخصم الضريبي";
  
    messageDiv5.textContent = "الضريبة السنوية بدون الخصم الضريبي ( سنة كاملة )" + " " + ""+" هي : " + ((2200 + 2250 + (income0 - 45000) * 20 / 100 ) * ( 100 / 100 )).toFixed(0) + " " + "جنية";    
  

  
} else {
  taxBrackets = [
    { minIncome: 1, maxIncome: 8000, taxRate: 0, fixedTax: 0 },
    { minIncome: 2, maxIncome: 22000, taxRate: 10, fixedTax: 22000 * 10 / 100 },
    { minIncome: 3, maxIncome: 15000, taxRate: 15, fixedTax: 15000 * 15 / 100 },
    { minIncome: 4, maxIncome: 155000, taxRate: 20, fixedTax: 155000 * 20 / 100 },    
    { minIncome: 5, maxIncome: income0 - 200000, taxRate: 22.5, fixedTax: (income0 - 200000) * 22.5 / 100 }
  ];

      messageDiv2.textContent = "الضريبة السنوية : من 01/01 حتي 31/12/2019" + " " + ""+" هي : " + ((2200 + 2250 + 31000 + (income0 - 200000) * 22.5 / 100 ) * 100 / 100).toFixed(0) + " " + "جنية ( لا يوجد خصم ضريبي )";
  

    messageDiv5.textContent = "الضريبة السنوية بدون الخصم الضريبي ( سنة كاملة )" + " " + ""+" هي : " + ((2200 + 2250 + 31000 + (income0 - 200000) * 22.5 / 100 ) * 100 / 100).toFixed(0) + " " + "جنية";    
  
     
  
}
    
   let caption = "تم حساب الضريبة بنجاح ! " + " صافي الوعاء الخاضع للضريبة : " + ( textbox1.value ) + " جنية " + " " + "السنة الضريبية : " + ( textbox10.value ) + " " + " الضريبة المستحقة : " + ( tax ) + " جنية " + "" + " الضريبة الشهرية : " + ( tax0 ) + " جنية ";
    showPopup( caption, 'info');  
  
console.log(taxBrackets);
// Function to populate tax table
function populateTaxTable() {
  
// اظهار جدول الخصم
      document.getElementById("taxTable1").style.display = "table";
  
    const table = document.getElementById("taxTable");

    const table1 = document.getElementById("taxTable1");  
  
    // Clear the table data (excluding header row)
    while (table.rows.length > 1) {
        table.deleteRow(1);
    }
    while (table1.rows.length > 1) {
        table1.deleteRow(1);
    }

    // Populate the table with new data
    taxBrackets.forEach(bracket => {
        const row = table.insertRow(-1);
        const minIncomeCell = row.insertCell(0);
        const maxIncomeCell = row.insertCell(1);
        const taxRateCell = row.insertCell(2);
        const taxDueCell = row.insertCell(3);
        const remainingIncomeCell = row.insertCell(4); // Added cell for remaining income
        
        minIncomeCell.textContent = bracket.minIncome.toLocaleString(); // Display minimum income
        maxIncomeCell.textContent = bracket.maxIncome === Infinity ? "Infinity" : bracket.maxIncome.toLocaleString(); // Display maximum income
        taxRateCell.textContent = bracket.taxRate + "%"; // Display tax rate
        taxDueCell.textContent = bracket.fixedTax.toLocaleString(); // Display fixed tax amount
        const remainingIncome = bracket.maxIncome === Infinity ? 0 : bracket.maxIncome - bracket.fixedTax; // Calculate remaining income
        remainingIncomeCell.textContent = remainingIncome.toLocaleString(); // Display remaining income
    });
}


// Call the function to populate the tax table
populateTaxTable();
  
  
  
  
  
  
// 1 جدول الخصم الضريبي  
// Define tax brackets
let netIncome1 = income0; // هذا مبلغ الدخل الصافي الذي ترغب في حساب الضريبة عليه

let taxBrackets1;

if (netIncome1 <= 8000) {
  taxBrackets1 = [
    { minIncome: 1, maxIncome: "-", taxRate: "", fixedTax: "-" }
  ];
  
 
  
} else if (netIncome1 <= 30000) {
  taxBrackets1 = [
    { minIncome: 1, maxIncome: "الثانية", taxRate: 85, fixedTax: ((income0 - 8000) * 10 / 100 ) * (-85 / 100) }
  ];
  
  
} else if (netIncome1 <= 45000) {
  taxBrackets1 = [
    { minIncome: 1, maxIncome: "الثالثة", taxRate: 45, fixedTax: ((2200 + (income0 - 30000) * 15 / 100) * (-45 / 100)) }
  ];

  
} else if (netIncome1 <= 200000) {
  taxBrackets1 = [
    { minIncome: 1, maxIncome: "الرابعة", taxRate: 7.5, fixedTax: ((2200 + 2250 + (income0 - 45000) * 20 / 100) * (-7.5 / 100)) }    
  ];

  
} else {
  taxBrackets1 = [
    { minIncome: 1, maxIncome: "الخامسة", taxRate: 0, fixedTax: 0 }
  ];
  
  
}

console.log(taxBrackets1);
// Function to populate tax table
function populateTaxTable1() {

    const table1 = document.getElementById("taxTable1");  
  
    // Clear the table data (excluding header row)
    while (table1.rows.length > 1) {
        table1.deleteRow(1);
    }

    // Populate the table with new data
    taxBrackets1.forEach(bracket1 => {
        const row = table1.insertRow(-1);
        const minIncomeCell = row.insertCell(0);
        const maxIncomeCell = row.insertCell(1);
        const taxRateCell = row.insertCell(2);
        const taxDueCell = row.insertCell(3);
        const remainingIncomeCell = row.insertCell(4); // Added cell for remaining income
        
        minIncomeCell.textContent = bracket1.minIncome.toLocaleString(); // Display minimum income
        maxIncomeCell.textContent = bracket1.maxIncome === Infinity ? "Infinity" : bracket1.maxIncome.toLocaleString(); // Display maximum income
        taxRateCell.textContent = bracket1.taxRate + "%"; // Display tax rate
        taxDueCell.textContent = bracket1.fixedTax.toLocaleString(); // Display fixed tax amount
        const remainingIncome = bracket1.maxIncome === Infinity ? 0 : bracket1.maxIncome - bracket1.fixedTax; // Calculate remaining income
        remainingIncomeCell.textContent = "-"; // Display remaining income
    });
}


// Call the function to populate the tax table
populateTaxTable1();  
  
    
  
} else  if ( net1.value >=0 && net2.value >=0 && textbox10.value ==="2020" ) {

    messageDiv.style.display = "block";   
    messageDiv1.style.display = "block"; 
    messageDiv2.style.display = "block"; 
    messageDiv3.style.display = "block";  
    messageDiv4.style.display = "block"; 
    messageDiv5.style.display = "block"; 
    messageDiv6.style.display = "block";
    messageDiv7.style.display = "none"; 
    messageDiv8.style.display = "none"    
  
// الفترة الأولي  
    let income6 = income5 - ( 7000 * 6 / 12 ).toFixed(0); // (الفترة الأولي) الإعفاء الشخصي السنوي للممول
    let income7 = (income6 / 6 * 12).toFixed(0); //رد الوعاء الي سنة كاملة 
  
  messageDiv.textContent = "الإعفاء الشخصي السنوي للممول  : 7000 جنية الفترة الأولي |" + " " +" سنة : "+" "+ selectedYear + " " + "يخص الفترة من 01/01 حتي 30/06" + " " + "مبلغ :" + " " + ( 7000 * 6 / 12 ).toFixed(0) + " " + "جنية";
  
  messageDiv1.textContent = "وعاء الفترة بعد خصم الإعفاء السنوي :" + " " + income6 + " " + " يرد الوعاء إلي سنة : " + income7 + " " + "جنية الصافي قبل خصم الشريحة المعفاة";
    let tax1 = 0; 
    let tax3 = 0; 
  
    if (income7 <= 8000) {
    tax1 = income7 * 0;
    tax3 = income7 * 0;
     
    } else if (income7 <= 30000) {
    tax1 = (((income7 - 8000) * 10 / 100 ) * (15 / 100)) * 6 / 12;
    tax3 = ((income7 - 8000) * 10 / 100 ) * 6 / 12;
      
      
    } else if (income7 <= 45000) {
    tax1 = (((2200 + (income7 - 30000) * 15 / 100)) * (55 / 100)) * 6 / 12;
    tax3 = ((2200 + (income7 - 30000) * 15 / 100)) * 6 / 12;
       
      
    } else if (income7 <= 200000) {
    tax1 = (((2200 + 2250 + (income7 - 45000) * 20 / 100)) * (92.5 / 100)) * 6 / 12;
    tax3 = ((2200 + 2250 + (income7 - 45000) * 20 / 100)) * 6 / 12;        
      
    } else {
    tax1 = (((2200 + 2250 + 31000 + (income7 - 200000) * 22.5 / 100)) * (100 / 100)) * 6 / 12;
    tax3 = ((2200 + 2250 + 31000 + (income7 - 200000) * 22.5 / 100)) * 6 / 12;
      
    } 
    

   
// Define tax brackets
let netIncome = income7; // هذا مبلغ الدخل الصافي الذي ترغب في حساب الضريبة عليه
let name = " 📢 " + "سنة : " + selectedYear + " " + "الفترة الأولي : من 01/01 حتي 30/06/2020" + " | " + "وفقا للمادة الثامنة المعدلة بالقانون رقم ( 97 ) لسنة 2018" + " 👌 ";  

let taxBrackets;

if (netIncome <= 8000) {
  taxBrackets = [
    { minIncome: 1, maxIncome: income7, taxRate: 0, fixedTax: 0 }
  ];
  showPopup( name, 'success');

    messageDiv2.textContent = "ضريبة الفترة الأولي : من 01/01 حتي 30/06/2020" + " " + ""+" هي : " + ((income7) * 0).toFixed(0) + " " + "جنية بعد الخصم الضريبي"; 
  
  
  
} else if (netIncome <= 30000) {
  taxBrackets = [
    { minIncome: 1, maxIncome: 8000, taxRate: 0, fixedTax: 0 },
    { minIncome: 2, maxIncome: income7 - 8000, taxRate: 10, fixedTax: (income7 - 8000) * 10 / 100 }
  ];
  showPopup( name, 'success');  
  
    messageDiv2.textContent = "ضريبة الفترة الأولي : من 01/01 حتي 30/06/2020" + " " + ""+" هي : " + ((((income7 - 8000) * 10 / 100 ) / 2 ) * (15 / 100)).toFixed(0) + " " + "جنية بعد الخصم الضريبي";  
    
  
} else if (netIncome <= 45000) {
  taxBrackets = [
    { minIncome: 1, maxIncome: 8000, taxRate: 0, fixedTax: 0 },
    { minIncome: 2, maxIncome: 22000, taxRate: 10, fixedTax: 22000 * 10 / 100 },
    { minIncome: 3, maxIncome: income7 - 30000, taxRate: 15, fixedTax: (income7 - 30000) * 15 / 100 }
  ];
  showPopup( name, 'success');

    messageDiv2.textContent = "ضريبة الفترة الأولي  : من 01/01 حتي 30/06/2020" + " " + ""+" هي : " + (((2200 + (income7 - 30000) * 15 / 100 ) /2 ) * 55 / 100).toFixed(0) + " " + "جنية بعد الخصم الضريبي";    
  
} else if (netIncome <= 200000) {
  taxBrackets = [
    { minIncome: 1, maxIncome: 8000, taxRate: 0, fixedTax: 0 },
    { minIncome: 2, maxIncome: 22000, taxRate: 10, fixedTax: 22000 * 10 / 100 },
    { minIncome: 3, maxIncome: 15000, taxRate: 15, fixedTax: 15000 * 15 / 100 },
    { minIncome: 4, maxIncome: income7 - 45000, taxRate: 20, fixedTax: (income7 - 45000) * 20 / 100 }    
  ];
  showPopup( name, 'success');

  
      messageDiv2.textContent = "ضريبة الفترة الأولي : من 01/01 حتي 30/06/2020" + " " + ""+" هي : " + ((( 2200 + 2250 + (income7 - 45000) * 20 / 100 ) /2 ) * 92.5 / 100 ).toFixed(0) + " " + "جنية بعد الخصم الضريبي";
  
    
} else {
  taxBrackets = [
    { minIncome: 1, maxIncome: 8000, taxRate: 0, fixedTax: 0 },
    { minIncome: 2, maxIncome: 22000, taxRate: 10, fixedTax: 22000 * 10 / 100 },
    { minIncome: 3, maxIncome: 15000, taxRate: 15, fixedTax: 15000 * 15 / 100 },
    { minIncome: 4, maxIncome: 155000, taxRate: 20, fixedTax: 155000 * 20 / 100 },    
    { minIncome: 5, maxIncome: income7 - 200000, taxRate: 22.5, fixedTax: (income7 - 200000) * 22.5 / 100 }
  ];
  showPopup( name, 'success');

      messageDiv2.textContent = "ضريبة الفترة الأولي : من 01/01 حتي 30/06/2020" + " " + ""+" هي : " + ((2200 + 2250 + 31000 + (income7 - 200000) * 22.5 / 100 ) / 2).toFixed(0) + " " + "جنية ( لا يوجد خصم ضريبي )";  
   
  
}

console.log(taxBrackets);
// Function to populate tax table
function populateTaxTable() {
  
// اظهار جدول الخصم
      document.getElementById("taxTable1").style.display = "table";
      document.getElementById("taxTable2").style.display = "table";
  
    const table = document.getElementById("taxTable");

    const table1 = document.getElementById("taxTable1"); 
  
    const table2 = document.getElementById("taxTable2");   
  
    // Clear the table data (excluding header row)
    while (table.rows.length > 1) {
        table.deleteRow(1);
    }
    while (table1.rows.length > 1) {
        table1.deleteRow(1);
    }
  
    while (table2.rows.length > 1) {
        table2.deleteRow(1);
    }  

    // Populate the table with new data
    taxBrackets.forEach(bracket => {
        const row = table.insertRow(-1);
        const minIncomeCell = row.insertCell(0);
        const maxIncomeCell = row.insertCell(1);
        const taxRateCell = row.insertCell(2);
        const taxDueCell = row.insertCell(3);
        const remainingIncomeCell = row.insertCell(4); // Added cell for remaining income
        
        minIncomeCell.textContent = bracket.minIncome.toLocaleString(); // Display minimum income
        maxIncomeCell.textContent = bracket.maxIncome === Infinity ? "Infinity" : bracket.maxIncome.toLocaleString(); // Display maximum income
        taxRateCell.textContent = bracket.taxRate + "%"; // Display tax rate
        taxDueCell.textContent = bracket.fixedTax.toLocaleString(); // Display fixed tax amount
        const remainingIncome = bracket.maxIncome === Infinity ? 0 : bracket.maxIncome - bracket.fixedTax; // Calculate remaining income
        remainingIncomeCell.textContent = remainingIncome.toLocaleString(); // Display remaining income
    });
}


// Call the function to populate the tax table
populateTaxTable();
  
// 1 جدول الخصم الضريبي  
// Define tax brackets
let netIncome1 = income7; // هذا مبلغ الدخل الصافي الذي ترغب في حساب الضريبة عليه

let taxBrackets1;

if (netIncome1 <= 8000) {
  taxBrackets1 = [
    { minIncome: 1, maxIncome: "-", taxRate: "", fixedTax: "-" }
  ];
  
 
  
} else if (netIncome1 <= 30000) {
  taxBrackets1 = [
    { minIncome: 1, maxIncome: "الثانية", taxRate: 85, fixedTax: (((income7 - 8000) * 10 / 100 ) / 2 ) * (-85 / 100) }
  ];
  
  
} else if (netIncome1 <= 45000) {
  taxBrackets1 = [
    { minIncome: 1, maxIncome: "الثالثة", taxRate: 45, fixedTax: (((2200 + (income7 - 30000) * 15 / 100) / 2 ) * (-45 / 100)) }
  ];

  
} else if (netIncome1 <= 200000) {
  taxBrackets1 = [
    { minIncome: 1, maxIncome: "الرابعة", taxRate: 7.5, fixedTax: (((2200 + 2250 + (income7 - 45000) * 20 / 100) / 2 ) * (-7.5 / 100)) }    
  ];

  
} else {
  taxBrackets1 = [
    { minIncome: 1, maxIncome: "الخامسة", taxRate: 0, fixedTax: 0 }
  ];
  
  
}

console.log(taxBrackets1);
// Function to populate tax table
function populateTaxTable1() {

    const table1 = document.getElementById("taxTable1");  
  
    // Clear the table data (excluding header row)
    while (table1.rows.length > 1) {
        table1.deleteRow(1);
    }

    // Populate the table with new data
    taxBrackets1.forEach(bracket1 => {
        const row = table1.insertRow(-1);
        const minIncomeCell = row.insertCell(0);
        const maxIncomeCell = row.insertCell(1);
        const taxRateCell = row.insertCell(2);
        const taxDueCell = row.insertCell(3);
        const remainingIncomeCell = row.insertCell(4); // Added cell for remaining income
        
        minIncomeCell.textContent = bracket1.minIncome.toLocaleString(); // Display minimum income
        maxIncomeCell.textContent = bracket1.maxIncome === Infinity ? "Infinity" : bracket1.maxIncome.toLocaleString(); // Display maximum income
        taxRateCell.textContent = bracket1.taxRate + "%"; // Display tax rate
        taxDueCell.textContent = bracket1.fixedTax.toLocaleString(); // Display fixed tax amount
        const remainingIncome = bracket1.maxIncome === Infinity ? 0 : bracket1.maxIncome - bracket1.fixedTax; // Calculate remaining income
        remainingIncomeCell.textContent = "-"; // Display remaining income
    });
}


// Call the function to populate the tax table
populateTaxTable1();   
  
  
  
  
  
  
  
// الفترة الثانية  
    let income11 = income10 - ( 9000 * 6 / 12 ).toFixed(0); // الإعفاء الشخصي السنوي للممول ( الفترة الثانية ) 
    let income12 = (income11 / 6 * 12).toFixed(0); //رد الوعاء الي سنة كاملة 
  
  messageDiv3.textContent = "الإعفاء الشخصي السنوي للممول  : 9000 جنية الفترة الثانية |" + " " +" سنة : "+" "+ selectedYear + " " + "يخص الفترة من 01/07 حتي 31/12" + " " + "مبلغ :" + " " + ( 9000 * 6 / 12 ).toFixed(0) + " " + "جنية";
  
  messageDiv4.textContent = "وعاء الفترة بعد خصم الإعفاء السنوي :" + " " + income11 + " " + " يرد الوعاء إلي سنة : " + income12 + " " + "جنية الصافي قبل خصم الشريحة المعفاة";
    let tax2 = 0;     
  
    if (income12 <= 15000) {
    tax2 = income12 * 0;
    } else if (income12 <= 30000) {
    tax2 = ((income12 * 2.5 / 100) - 375 ) * 6 / 12;
    } else if (income12 <= 45000) {
    tax2 = ((income12 * 10 / 100) - 2625 ) * 6 / 12;
    } else if (income12 <= 60000) {
    tax2 = ((income12 * 15 / 100) - 4875 ) * 6 / 12;
    } else if (income12 <= 200000) {
    tax2 = ((income12 * 20 / 100) - 7875 ) * 6 / 12;
    } else if (income12 <= 400000) {
    tax2 = ((income12 * 22.5 / 100) - 12875 ) * 6 / 12;
    } else if (income12 <= 600000) {
    tax2 = ((income12 * 25 / 100) - 22875 ) * 6 / 12;
    } else if (income12 <= 700000) {
    tax2 = ((income12 * 25 / 100) - 22500 ) * 6 / 12;
    } else if (income <= 800000) {
    tax2 = ((income12 * 25 / 100) - 20250 ) * 6 / 12;
    } else if (income12 <= 900000) {
    tax2 = ((income12 * 25 / 100) - 18000 ) * 6 / 12;
    } else if (income12 <= 1000000) {
    tax2 = ((income12 * 25 / 100) - 15000 ) * 6 / 12;
    } else {
    tax2 = ((income12 * 25 / 100) - 10000 ) * 6 / 12;
    } 
  
  
// إجمالي ضريبة الفترات   
tax = (tax1 + tax2).toFixed(0);

   // تحديث قيمة tax0 بعد حساب الضريبة وتحويل النتيجة إلى عدد صحيح
   tax0 = ( tax / 12 ).toFixed(0);

  // عرض القيمة الجديدة في textbox6
  textbox6.value = tax0  
  
      messageDiv5.textContent = "ضريبة الفترة الثانية : من 01/07 حتي 31/12/2020" + " " + ""+" هي : " + (tax2).toFixed(0) + " " + "جنية"; 
  
    messageDiv6.textContent = "الضريبة السنوية بدون الخصم الضريبي ( سنة كاملة ) من 01/01 حتي 31/12/2020" + " " + ""+" هي : " + (tax3 + tax2).toFixed(0) + " " + "جنية";    
  
  
// Define tax brackets
let netIncome2 = income12; // هذا مبلغ الدخل الصافي الذي ترغب في حساب الضريبة عليه
let name1 = " 📢 " + "سنة : " + selectedYear + " " + "الفترة الثانية : من 01/07 حتي 31/12/2020" + " | " + "وفقا للمادة الثامنة المعدلة بالقانون رقم ( 26 ) لسنة 2020" + " 👌 ";  

let taxBrackets2;

if (netIncome2 <= 15000) {
  taxBrackets2 = [
    { minIncome: 1, maxIncome: income12, taxRate: 0, fixedTax: 0 }
  ];
setTimeout(function() {   
  showPopup( name1, 'success');
}, 1500);  
} else if (netIncome2 <= 30000) {
  taxBrackets2 = [
    { minIncome: 1, maxIncome: 15000, taxRate: 0, fixedTax: 0 },
    { minIncome: 2, maxIncome: income12 - 15000, taxRate: 2.5, fixedTax: (income12 - 15000) * 2.5 / 100 }
  ];
setTimeout(function() {   
  showPopup( name1, 'success');
}, 1500);  
} else if (netIncome2 <= 45000) {
  taxBrackets2 = [
    { minIncome: 1, maxIncome: 15000, taxRate: 0, fixedTax: 0 },
    { minIncome: 2, maxIncome: 15000, taxRate: 2.5, fixedTax: 15000 * 2.5 / 100 },
    { minIncome: 3, maxIncome: income12 - 30000, taxRate: 10, fixedTax: (income12 - 30000) * 10 / 100 }
  ];
setTimeout(function() {   
  showPopup( name1, 'success');
}, 1500);  
} else if (netIncome2 <= 60000) {
  taxBrackets2 = [
    { minIncome: 1, maxIncome: 15000, taxRate: 0, fixedTax: 0 },
    { minIncome: 2, maxIncome: 15000, taxRate: 2.5, fixedTax: 15000 * 2.5 / 100 },
    { minIncome: 3, maxIncome: 15000, taxRate: 10, fixedTax: 15000 * 10 / 100 },
    { minIncome: 4, maxIncome: income12 - 45000, taxRate: 15, fixedTax: (income12 - 45000) * 15 / 100 }    
  ];
setTimeout(function() {   
  showPopup( name1, 'success');
}, 1500);  
} else if (netIncome2 <= 200000) {
  taxBrackets2 = [
    { minIncome: 1, maxIncome: 15000, taxRate: 0, fixedTax: 0 },
    { minIncome: 2, maxIncome: 15000, taxRate: 2.5, fixedTax: 15000 * 2.5 / 100 },
    { minIncome: 3, maxIncome: 15000, taxRate: 10, fixedTax: 15000 * 10 / 100 },
    { minIncome: 4, maxIncome: 15000, taxRate: 15, fixedTax: 15000 * 15 / 100 },    
    { minIncome: 5, maxIncome: income12 - 60000, taxRate: 20, fixedTax: (income12 - 60000) * 20 / 100 }    
  ];
setTimeout(function() {   
  showPopup( name1, 'success');
}, 1500);  
} else if (netIncome2 <= 400000) {
  taxBrackets2 = [
    { minIncome: 1, maxIncome: 15000, taxRate: 0, fixedTax: 0 },
    { minIncome: 2, maxIncome: 15000, taxRate: 2.5, fixedTax: 15000 * 2.5 / 100 },
    { minIncome: 3, maxIncome: 15000, taxRate: 10, fixedTax: 15000 * 10 / 100 },
    { minIncome: 4, maxIncome: 15000, taxRate: 15, fixedTax: 15000 * 15 / 100 },
    { minIncome: 5, maxIncome: 140000, taxRate: 20, fixedTax: 140000 * 20 / 100 }, 
    { minIncome: 6, maxIncome: income12 - 200000, taxRate: 22.5, fixedTax: (income12 - 200000) * 22.5 / 100 }    
  ];
setTimeout(function() {   
  showPopup( name1, 'success');
}, 1500);  
} else if (netIncome2 <= 600000) {
  taxBrackets2 = [
    { minIncome: 1, maxIncome: 15000, taxRate: 0, fixedTax: 0 },
    { minIncome: 2, maxIncome: 15000, taxRate: 2.5, fixedTax: 15000 * 2.5 / 100 },
    { minIncome: 3, maxIncome: 15000, taxRate: 10, fixedTax: 15000 * 10 / 100 },
    { minIncome: 4, maxIncome: 15000, taxRate: 15, fixedTax: 15000 * 15 / 100 },
    { minIncome: 5, maxIncome: 140000, taxRate: 20, fixedTax: 140000 * 20 / 100 },
    { minIncome: 6, maxIncome: 200000, taxRate: 22.5, fixedTax: 200000 * 22.5 / 100 },     
    { minIncome: 7, maxIncome: income12 - 400000, taxRate: 25, fixedTax: (income12 - 400000) * 25 / 100 }    
  ];
setTimeout(function() {   
  showPopup( name1, 'success');
}, 1500);  
} else if (netIncome2 <= 700000) {
  taxBrackets2 = [
    { minIncome: 1, maxIncome: 0, taxRate: 0, fixedTax: 0 },
    { minIncome: 2, maxIncome: 30000, taxRate: 2.5, fixedTax: 30000 * 2.5 / 100 },
    { minIncome: 3, maxIncome: 15000, taxRate: 10, fixedTax: 15000 * 10 / 100 },
    { minIncome: 4, maxIncome: 15000, taxRate: 15, fixedTax: 15000 * 15 / 100 },
    { minIncome: 5, maxIncome: 140000, taxRate: 20, fixedTax: 140000 * 20 / 100 },
    { minIncome: 6, maxIncome: 200000, taxRate: 22.5, fixedTax: 200000 * 22.5 / 100 },     
    { minIncome: 7, maxIncome: income12 - 400000, taxRate: 25, fixedTax: (income12 - 400000) * 25 / 100 }    
  ];
setTimeout(function() {  
   let caption = "صافي الدخل الذي تعدي 600 ألف جنية ولم يتجاوز 700 ألف جنية لا يتمتع بالشريحة المعفاة";
    showPopup( name1 + caption, 'warning');
}, 1500);  
} else if (netIncome2 <= 800000) {
  taxBrackets2 = [
    { minIncome: 1, maxIncome: 0, taxRate: 0, fixedTax: 0 },
    { minIncome: 2, maxIncome: 0, taxRate: 2.5, fixedTax: 0 },
    { minIncome: 3, maxIncome: 45000, taxRate: 10, fixedTax: 45000 * 10 / 100 },
    { minIncome: 4, maxIncome: 15000, taxRate: 15, fixedTax: 15000 * 15 / 100 },
    { minIncome: 5, maxIncome: 140000, taxRate: 20, fixedTax: 140000 * 20 / 100 },
    { minIncome: 6, maxIncome: 200000, taxRate: 22.5, fixedTax: 200000 * 22.5 / 100 },     
    { minIncome: 7, maxIncome: income12 - 400000, taxRate: 25, fixedTax: (income12 - 400000) * 25 / 100 }    
  ];
setTimeout(function() {   
   let caption = "صافي الدخل الذي تعدي 700 ألف جنية ولم يتجاوز 800 ألف جنية لا يتمتع بالشريحة المعفاة + الشريحة الثانية";
    showPopup( name1 + caption, 'warning')  
}, 1500);  
} else if (netIncome2 <= 900000) {
  taxBrackets2 = [
    { minIncome: 1, maxIncome: 0, taxRate: 0, fixedTax: 0 },
    { minIncome: 2, maxIncome: 0, taxRate: 2.5, fixedTax: 0 },
    { minIncome: 3, maxIncome: 0, taxRate: 10, fixedTax: 0 },
    { minIncome: 4, maxIncome: 60000, taxRate: 15, fixedTax: 60000 * 15 / 100 },
    { minIncome: 5, maxIncome: 140000, taxRate: 20, fixedTax: 140000 * 20 / 100 },
    { minIncome: 6, maxIncome: 200000, taxRate: 22.5, fixedTax: 200000 * 22.5 / 100 },     
    { minIncome: 7, maxIncome: income12 - 400000, taxRate: 25, fixedTax: (income12 - 400000) * 25 / 100 }    
  ]; 
setTimeout(function() {  
   let caption = "صافي الدخل الذي تعدي 800 ألف جنية ولم يتجاوز 900 ألف جنية لا يتمتع بالشريحة المعفاة + الشريحة الثانية + الشريحة الثالثة";
    showPopup( name1 + caption, 'warning')    
}, 1500);
} else if (netIncome2 <= 1000000) {
  taxBrackets2 = [
    { minIncome: 1, maxIncome: 0, taxRate: 0, fixedTax: 0 },
    { minIncome: 2, maxIncome: 0, taxRate: 2.5, fixedTax: 0 },
    { minIncome: 3, maxIncome: 0, taxRate: 10, fixedTax: 0 },
    { minIncome: 4, maxIncome: 0, taxRate: 15, fixedTax: 0 },
    { minIncome: 5, maxIncome: 200000, taxRate: 20, fixedTax: 200000 * 20 / 100 },
    { minIncome: 6, maxIncome: 200000, taxRate: 22.5, fixedTax: 200000 * 22.5 / 100 },     
    { minIncome: 7, maxIncome: income12 - 400000, taxRate: 25, fixedTax: (income12 - 400000) * 25 / 100 }    
  ];
setTimeout(function() {  
   let caption = "صافي الدخل الذي تعدي 900 ألف جنية ولم يتجاوز مليون جنية لا يتمتع بالشريحة المعفاة + الشريحة الثانية + الشريحة الثالثة + الشريحة الرابعة";
    showPopup( name1 + caption, 'warning')   
}, 1500);  
} else {
  taxBrackets2 = [
    { minIncome: 1, maxIncome: 0, taxRate: 0, fixedTax: 0 },
    { minIncome: 2, maxIncome: 0, taxRate: 2.5, fixedTax: 0 },
    { minIncome: 3, maxIncome: 0, taxRate: 10, fixedTax: 0 },
    { minIncome: 4, maxIncome: 0, taxRate: 15, fixedTax: 0 },
    { minIncome: 5, maxIncome: 0, taxRate: 20, fixedTax: 0 },
    { minIncome: 6, maxIncome: 400000, taxRate: 22.5, fixedTax: 400000 * 22.5 / 100 },     
    { minIncome: 7, maxIncome: income12 - 400000, taxRate: 25, fixedTax: (income12 - 400000) * 25 / 100 }    
  ]; 
setTimeout(function() {  
   let caption = "صافي الدخل الذي تجاوز مليون جنية لا يتمتع بالشريحة المعفاة + الشريحة الثانية + الشريحة الثالثة + الشريحة الرابعة + الشريحة الخامسة";
    showPopup( name1 + caption, 'warning')
}, 1500);  
}
  
  setTimeout(function() {  
   let caption = "تم حساب الضريبة بنجاح ! " + " " + "السنة الضريبية : " + ( textbox10.value ) + " " + " الضريبة المستحقة : " + ( tax ) + " جنية " + "" + " الضريبة الشهرية : " + ( tax0 ) + " جنية ";
    showPopup( caption, 'info'); 
    }, 2250);
  
console.log(taxBrackets2);
// Function to populate tax table
function populateTaxTable2() {
    const table2 = document.getElementById("taxTable2");
  
    // Clear the table data (excluding header row)
    while (table2.rows.length > 1) {
        table2.deleteRow(1);
    }

    // Populate the table with new data
    taxBrackets2.forEach(bracket2 => {
        const row = table2.insertRow(-1);
        const minIncomeCell = row.insertCell(0);
        const maxIncomeCell = row.insertCell(1);
        const taxRateCell = row.insertCell(2);
        const taxDueCell = row.insertCell(3);
        const remainingIncomeCell = row.insertCell(4); // Added cell for remaining income
        
        minIncomeCell.textContent = bracket2.minIncome.toLocaleString(); // Display minimum income
        maxIncomeCell.textContent = bracket2.maxIncome === Infinity ? "Infinity" : bracket2.maxIncome.toLocaleString(); // Display maximum income
        taxRateCell.textContent = bracket2.taxRate + "%"; // Display tax rate
        taxDueCell.textContent = bracket2.fixedTax.toLocaleString(); // Display fixed tax amount
        const remainingIncome = bracket2.maxIncome === Infinity ? 0 : bracket2.maxIncome - bracket2.fixedTax; // Calculate remaining income
        remainingIncomeCell.textContent = remainingIncome.toLocaleString(); // Display remaining income
    });
}


// Call the function to populate the tax table
populateTaxTable2();  
  
  
  
} else  if ( textbox1.value >=0 && textbox10.value <=2022 ) {

    messageDiv.style.display = "block";  
    messageDiv1.style.display = "none"; 
    messageDiv2.style.display = "block"; 
    messageDiv3.style.display = "none"; 
    messageDiv4.style.display = "none"; 
    messageDiv5.style.display = "none"; 
    messageDiv6.style.display = "none";
    messageDiv7.style.display = "none"; 
    messageDiv8.style.display = "none";   
  
  
    let income0 = income - 9000; //الإعفاء الشخصي السنوي للممول
    messageDiv.textContent = "الإعفاء الشخصي السنوي للممول  : 9000 جنية" + " " +" سنة : "+" "+ selectedYear + " " + "الصافي قبل خصم الشريحة المعفاة :" + " " + income0 + " " + "جنية"; 
  
    if (income0 <= 15000) {
    tax = income0 * 0;
    } else if (income0 <= 30000) {
    tax = (income0 * 2.5 / 100) - 375;
    } else if (income0 <= 45000) {
    tax = (income0 * 10 / 100) - 2625;
    } else if (income0 <= 60000) {
    tax = (income0 * 15 / 100) - 4875;
    } else if (income0 <= 200000) {
    tax = (income0 * 20 / 100) - 7875;
    } else if (income0 <= 400000) {
    tax = (income0 * 22.5 / 100) - 12875;
    } else if (income0 <= 600000) {
    tax = (income0 * 25 / 100) - 22875;
    } else if (income0 <= 700000) {
    tax = (income0 * 25 / 100) - 22500;
    } else if (income0 <= 800000) {
    tax = (income0 * 25 / 100) - 20250;
    } else if (income0 <= 900000) {
    tax = (income0 * 25 / 100) - 18000;
    } else if (income0 <= 1000000) {
    tax = (income0 * 25 / 100) - 15000;
    } else {
    tax = (income0 * 25 / 100) - 10000;
    } 

   tax = Number(tax.toFixed(0)); 
  
   // تحديث قيمة tax0 بعد حساب الضريبة وتحويل النتيجة إلى عدد صحيح
   tax0 = ( tax / 12 ).toFixed(0);

  // عرض القيمة الجديدة في textbox6
  textbox6.value = tax0  
    
    messageDiv2.textContent = "الضريبة السنوية : من 01/01 حتي 31/12" + " " + ""+" هي : " + tax + " " + "جنية";        
  
  
// Define tax brackets
let netIncome = income0; // هذا مبلغ الدخل الصافي الذي ترغب في حساب الضريبة عليه
let name1 = " 📢 " + "سنة : " + selectedYear + " | " + "وفقا للمادة الثامنة المعدلة بالقانون رقم ( 26 ) لسنة 2020" + " 👌 ";  

let taxBrackets;

if (netIncome <= 15000) {
  taxBrackets = [
    { minIncome: 1, maxIncome: income0, taxRate: 0, fixedTax: 0 }
  ];
} else if (netIncome <= 30000) {
  taxBrackets = [
    { minIncome: 1, maxIncome: 15000, taxRate: 0, fixedTax: 0 },
    { minIncome: 2, maxIncome: income0 - 15000, taxRate: 2.5, fixedTax: (income0 - 15000) * 2.5 / 100 }
  ];
} else if (netIncome <= 45000) {
  taxBrackets = [
    { minIncome: 1, maxIncome: 15000, taxRate: 0, fixedTax: 0 },
    { minIncome: 2, maxIncome: 15000, taxRate: 2.5, fixedTax: 15000 * 2.5 / 100 },
    { minIncome: 3, maxIncome: income0 - 30000, taxRate: 10, fixedTax: (income0 - 30000) * 10 / 100 }
  ];
} else if (netIncome <= 60000) {
  taxBrackets = [
    { minIncome: 1, maxIncome: 15000, taxRate: 0, fixedTax: 0 },
    { minIncome: 2, maxIncome: 15000, taxRate: 2.5, fixedTax: 15000 * 2.5 / 100 },
    { minIncome: 3, maxIncome: 15000, taxRate: 10, fixedTax: 15000 * 10 / 100 },
    { minIncome: 4, maxIncome: income0 - 45000, taxRate: 15, fixedTax: (income0 - 45000) * 15 / 100 }    
  ];
} else if (netIncome <= 200000) {
  taxBrackets = [
    { minIncome: 1, maxIncome: 15000, taxRate: 0, fixedTax: 0 },
    { minIncome: 2, maxIncome: 15000, taxRate: 2.5, fixedTax: 15000 * 2.5 / 100 },
    { minIncome: 3, maxIncome: 15000, taxRate: 10, fixedTax: 15000 * 10 / 100 },
    { minIncome: 4, maxIncome: 15000, taxRate: 15, fixedTax: 15000 * 15 / 100 },    
    { minIncome: 5, maxIncome: income0 - 60000, taxRate: 20, fixedTax: (income0 - 60000) * 20 / 100 }    
  ];
} else if (netIncome <= 400000) {
  taxBrackets = [
    { minIncome: 1, maxIncome: 15000, taxRate: 0, fixedTax: 0 },
    { minIncome: 2, maxIncome: 15000, taxRate: 2.5, fixedTax: 15000 * 2.5 / 100 },
    { minIncome: 3, maxIncome: 15000, taxRate: 10, fixedTax: 15000 * 10 / 100 },
    { minIncome: 4, maxIncome: 15000, taxRate: 15, fixedTax: 15000 * 15 / 100 },
    { minIncome: 5, maxIncome: 140000, taxRate: 20, fixedTax: 140000 * 20 / 100 }, 
    { minIncome: 6, maxIncome: income0 - 200000, taxRate: 22.5, fixedTax: (income0 - 200000) * 22.5 / 100 }    
  ];
} else if (netIncome <= 600000) {
  taxBrackets = [
    { minIncome: 1, maxIncome: 15000, taxRate: 0, fixedTax: 0 },
    { minIncome: 2, maxIncome: 15000, taxRate: 2.5, fixedTax: 15000 * 2.5 / 100 },
    { minIncome: 3, maxIncome: 15000, taxRate: 10, fixedTax: 15000 * 10 / 100 },
    { minIncome: 4, maxIncome: 15000, taxRate: 15, fixedTax: 15000 * 15 / 100 },
    { minIncome: 5, maxIncome: 140000, taxRate: 20, fixedTax: 140000 * 20 / 100 },
    { minIncome: 6, maxIncome: 200000, taxRate: 22.5, fixedTax: 200000 * 22.5 / 100 },     
    { minIncome: 7, maxIncome: income0 - 400000, taxRate: 25, fixedTax: (income0 - 400000) * 25 / 100 }    
  ];
} else if (netIncome <= 700000) {
  taxBrackets = [
    { minIncome: 1, maxIncome: 0, taxRate: 0, fixedTax: 0 },
    { minIncome: 2, maxIncome: 30000, taxRate: 2.5, fixedTax: 30000 * 2.5 / 100 },
    { minIncome: 3, maxIncome: 15000, taxRate: 10, fixedTax: 15000 * 10 / 100 },
    { minIncome: 4, maxIncome: 15000, taxRate: 15, fixedTax: 15000 * 15 / 100 },
    { minIncome: 5, maxIncome: 140000, taxRate: 20, fixedTax: 140000 * 20 / 100 },
    { minIncome: 6, maxIncome: 200000, taxRate: 22.5, fixedTax: 200000 * 22.5 / 100 },     
    { minIncome: 7, maxIncome: income0 - 400000, taxRate: 25, fixedTax: (income0 - 400000) * 25 / 100 }    
  ];
   let caption = "صافي الدخل الذي تعدي 600 ألف جنية ولم يتجاوز 700 ألف جنية لا يتمتع بالشريحة المعفاة";
    showPopup( name1 + caption, 'warning')
  
} else if (netIncome <= 800000) {
  taxBrackets = [
    { minIncome: 1, maxIncome: 0, taxRate: 0, fixedTax: 0 },
    { minIncome: 2, maxIncome: 0, taxRate: 2.5, fixedTax: 0 },
    { minIncome: 3, maxIncome: 45000, taxRate: 10, fixedTax: 45000 * 10 / 100 },
    { minIncome: 4, maxIncome: 15000, taxRate: 15, fixedTax: 15000 * 15 / 100 },
    { minIncome: 5, maxIncome: 140000, taxRate: 20, fixedTax: 140000 * 20 / 100 },
    { minIncome: 6, maxIncome: 200000, taxRate: 22.5, fixedTax: 200000 * 22.5 / 100 },     
    { minIncome: 7, maxIncome: income0 - 400000, taxRate: 25, fixedTax: (income0 - 400000) * 25 / 100 }    
  ];
   let caption = "صافي الدخل الذي تعدي 700 ألف جنية ولم يتجاوز 800 ألف جنية لا يتمتع بالشريحة المعفاة + الشريحة الثانية";
    showPopup( name1 + caption, 'warning')  
  
} else if (netIncome <= 900000) {
  taxBrackets = [
    { minIncome: 1, maxIncome: 0, taxRate: 0, fixedTax: 0 },
    { minIncome: 2, maxIncome: 0, taxRate: 2.5, fixedTax: 0 },
    { minIncome: 3, maxIncome: 0, taxRate: 10, fixedTax: 0 },
    { minIncome: 4, maxIncome: 60000, taxRate: 15, fixedTax: 60000 * 15 / 100 },
    { minIncome: 5, maxIncome: 140000, taxRate: 20, fixedTax: 140000 * 20 / 100 },
    { minIncome: 6, maxIncome: 200000, taxRate: 22.5, fixedTax: 200000 * 22.5 / 100 },     
    { minIncome: 7, maxIncome: income0 - 400000, taxRate: 25, fixedTax: (income0 - 400000) * 25 / 100 }    
  ]; 
   let caption = "صافي الدخل الذي تعدي 800 ألف جنية ولم يتجاوز 900 ألف جنية لا يتمتع بالشريحة المعفاة + الشريحة الثانية + الشريحة الثالثة";
    showPopup( name1 + caption, 'warning')    

} else if (netIncome <= 1000000) {
  taxBrackets = [
    { minIncome: 1, maxIncome: 0, taxRate: 0, fixedTax: 0 },
    { minIncome: 2, maxIncome: 0, taxRate: 2.5, fixedTax: 0 },
    { minIncome: 3, maxIncome: 0, taxRate: 10, fixedTax: 0 },
    { minIncome: 4, maxIncome: 0, taxRate: 15, fixedTax: 0 },
    { minIncome: 5, maxIncome: 200000, taxRate: 20, fixedTax: 200000 * 20 / 100 },
    { minIncome: 6, maxIncome: 200000, taxRate: 22.5, fixedTax: 200000 * 22.5 / 100 },     
    { minIncome: 7, maxIncome: income0 - 400000, taxRate: 25, fixedTax: (income0 - 400000) * 25 / 100 }    
  ]; 
   let caption = "صافي الدخل الذي تعدي 900 ألف جنية ولم يتجاوز مليون جنية لا يتمتع بالشريحة المعفاة + الشريحة الثانية + الشريحة الثالثة + الشريحة الرابعة";
    showPopup( name1 + caption, 'warning')   
  
} else {
  taxBrackets = [
    { minIncome: 1, maxIncome: 0, taxRate: 0, fixedTax: 0 },
    { minIncome: 2, maxIncome: 0, taxRate: 2.5, fixedTax: 0 },
    { minIncome: 3, maxIncome: 0, taxRate: 10, fixedTax: 0 },
    { minIncome: 4, maxIncome: 0, taxRate: 15, fixedTax: 0 },
    { minIncome: 5, maxIncome: 0, taxRate: 20, fixedTax: 0 },
    { minIncome: 6, maxIncome: 400000, taxRate: 22.5, fixedTax: 400000 * 22.5 / 100 },     
    { minIncome: 7, maxIncome: income0 - 400000, taxRate: 25, fixedTax: (income0 - 400000) * 25 / 100 }    
  ]; 
   let caption = "صافي الدخل الذي تجاوز مليون جنية لا يتمتع بالشريحة المعفاة + الشريحة الثانية + الشريحة الثالثة + الشريحة الرابعة + الشريحة الخامسة";
    showPopup( name1 + caption, 'warning')   
}

   setTimeout(function() {  
   let caption = "تم حساب الضريبة بنجاح ! " + " صافي الوعاء الخاضع للضريبة : " + ( textbox1.value ) + " جنية " + " " + "السنة الضريبية : " + ( textbox10.value ) + " " + " الضريبة المستحقة : " + ( tax ) + " جنية " + "" + " الضريبة الشهرية : " + ( tax0 ) + " جنية ";
    showPopup( caption, 'info'); 
    }, 1500);    
  
console.log(taxBrackets);
// Function to populate tax table
function populateTaxTable() {
    const table = document.getElementById("taxTable");

    const table1 = document.getElementById("taxTable1");  
  
    // Clear the table data (excluding header row)
    while (table.rows.length > 1) {
        table.deleteRow(1);
    }
    while (table1.rows.length > 1) {
        table1.deleteRow(1);
    }

    // Populate the table with new data
    taxBrackets.forEach(bracket => {
        const row = table.insertRow(-1);
        const minIncomeCell = row.insertCell(0);
        const maxIncomeCell = row.insertCell(1);
        const taxRateCell = row.insertCell(2);
        const taxDueCell = row.insertCell(3);
        const remainingIncomeCell = row.insertCell(4); // Added cell for remaining income
        
        minIncomeCell.textContent = bracket.minIncome.toLocaleString(); // Display minimum income
        maxIncomeCell.textContent = bracket.maxIncome === Infinity ? "Infinity" : bracket.maxIncome.toLocaleString(); // Display maximum income
        taxRateCell.textContent = bracket.taxRate + "%"; // Display tax rate
        taxDueCell.textContent = bracket.fixedTax.toLocaleString(); // Display fixed tax amount
        const remainingIncome = bracket.maxIncome === Infinity ? 0 : bracket.maxIncome - bracket.fixedTax; // Calculate remaining income
        remainingIncomeCell.textContent = remainingIncome.toLocaleString(); // Display remaining income
    });
}


// Call the function to populate the tax table
populateTaxTable();  
  
  
} else  if ( net1.value >=0 && net2.value >=0 && net3.value >=0 && textbox10.value === "2023" ) {

    messageDiv.style.display = "block";   
    messageDiv1.style.display = "block"; 
    messageDiv2.style.display = "block"; 
    messageDiv3.style.display = "block";  
    messageDiv4.style.display = "block"; 
    messageDiv5.style.display = "block"; 
    messageDiv6.style.display = "block";
    messageDiv7.style.display = "block"; 
    messageDiv8.style.display = "block";  
  
// الفترة الأولي  
    let income6 = income5 - ( 9000 * 6 / 12 ).toFixed(0); // (الفترة الأولي) الإعفاء الشخصي السنوي للممول
    let income7 = (income6 / 6 * 12).toFixed(0); //رد الوعاء الي سنة كاملة 
  
  messageDiv.textContent = "الإعفاء الشخصي السنوي للممول  : 9000 جنية الفترة الأولي |" + " " +" سنة : "+" "+ selectedYear + " " + "يخص الفترة من 01/01 حتي 30/06" + " " + "مبلغ :" + " " + ( 9000 * 6 / 12 ).toFixed(0) + " " + "جنية";
  
  messageDiv1.textContent = "وعاء الفترة بعد خصم الإعفاء السنوي :" + " " + income6 + " " + " يرد الوعاء إلي سنة : " + income7 + " " + "جنية الصافي قبل خصم الشريحة المعفاة";
     
  
let tax1 = 0;  
    if (income7 <= 15000) {
    tax1 = income7 * 0;
    } else if (income7 <= 30000) {
    tax1 = ((income7 * 2.5 / 100) - 375 ) * 6 / 12;
    } else if (income7 <= 45000) {
    tax1 = ((income7 * 10 / 100) - 2625 ) * 6 / 12;
    } else if (income7 <= 60000) {
    tax1 = ((income7 * 15 / 100) - 4875 ) * 6 / 12;
    } else if (income7 <= 200000) {
    tax1 = ((income7 * 20 / 100) - 7875 ) * 6 / 12;
    } else if (income7 <= 400000) {
    tax1 = ((income7 * 22.5 / 100) - 12875 ) * 6 / 12;
    } else if (income7 <= 600000) {
    tax1 = ((income7 * 25 / 100) - 22875 ) * 6 / 12;
    } else if (income7 <= 700000) {
    tax1 = ((income7 * 25 / 100) - 22500 ) * 6 / 12;
    } else if (income7 <= 800000) {
    tax1 = ((income7 * 25 / 100) - 20250 ) * 6 / 12;
    } else if (income7 <= 900000) {
    tax1 = ((income7 * 25 / 100) - 18000 ) * 6 / 12;
    } else if (income7 <= 1000000) {
    tax1 = ((income7 * 25 / 100) - 15000 ) * 6 / 12;
    } else {
    tax1 = ((income7 * 25 / 100) - 10000 ) * 6 / 12;
    }

    messageDiv2.textContent = "ضريبة الفترة الأولي : من 01/01 حتي 30/06/2023" + " " + ""+" هي : " + (tax1).toFixed(0) + " " + "جنية";      
  

// Define tax brackets
let netIncome = income7; // هذا مبلغ الدخل الصافي الذي ترغب في حساب الضريبة عليه
 
let name1 = " 📢 " + "سنة : " + selectedYear + " " + "الفترة الأولي : من 01/01 حتي 30/06/2023" + " | " + "وفقا للمادة الثامنة المعدلة بالقانون رقم ( 26 ) لسنة 2020" + " 👌 ";  

let taxBrackets;

if (netIncome <= 15000) {
  taxBrackets = [
    { minIncome: 1, maxIncome: income7, taxRate: 0, fixedTax: 0 }
  ];
  showPopup( name1, 'success');
} else if (netIncome <= 30000) {
  taxBrackets = [
    { minIncome: 1, maxIncome: 15000, taxRate: 0, fixedTax: 0 },
    { minIncome: 2, maxIncome: income7 - 15000, taxRate: 2.5, fixedTax: (income7 - 15000) * 2.5 / 100 }
  ];
  showPopup( name1, 'success');
} else if (netIncome <= 45000) {
  taxBrackets = [
    { minIncome: 1, maxIncome: 15000, taxRate: 0, fixedTax: 0 },
    { minIncome: 2, maxIncome: 15000, taxRate: 2.5, fixedTax: 15000 * 2.5 / 100 },
    { minIncome: 3, maxIncome: income7 - 30000, taxRate: 10, fixedTax: (income7 - 30000) * 10 / 100 }
  ];
  showPopup( name1, 'success');
} else if (netIncome <= 60000) {
  taxBrackets = [
    { minIncome: 1, maxIncome: 15000, taxRate: 0, fixedTax: 0 },
    { minIncome: 2, maxIncome: 15000, taxRate: 2.5, fixedTax: 15000 * 2.5 / 100 },
    { minIncome: 3, maxIncome: 15000, taxRate: 10, fixedTax: 15000 * 10 / 100 },
    { minIncome: 4, maxIncome: income7 - 45000, taxRate: 15, fixedTax: (income7 - 45000) * 15 / 100 }    
  ];
  showPopup( name1, 'success');
} else if (netIncome <= 200000) {
  taxBrackets = [
    { minIncome: 1, maxIncome: 15000, taxRate: 0, fixedTax: 0 },
    { minIncome: 2, maxIncome: 15000, taxRate: 2.5, fixedTax: 15000 * 2.5 / 100 },
    { minIncome: 3, maxIncome: 15000, taxRate: 10, fixedTax: 15000 * 10 / 100 },
    { minIncome: 4, maxIncome: 15000, taxRate: 15, fixedTax: 15000 * 15 / 100 },    
    { minIncome: 5, maxIncome: income7 - 60000, taxRate: 20, fixedTax: (income7 - 60000) * 20 / 100 }    
  ];
  showPopup( name1, 'success');
} else if (netIncome <= 400000) {
  taxBrackets = [
    { minIncome: 1, maxIncome: 15000, taxRate: 0, fixedTax: 0 },
    { minIncome: 2, maxIncome: 15000, taxRate: 2.5, fixedTax: 15000 * 2.5 / 100 },
    { minIncome: 3, maxIncome: 15000, taxRate: 10, fixedTax: 15000 * 10 / 100 },
    { minIncome: 4, maxIncome: 15000, taxRate: 15, fixedTax: 15000 * 15 / 100 },
    { minIncome: 5, maxIncome: 140000, taxRate: 20, fixedTax: 140000 * 20 / 100 }, 
    { minIncome: 6, maxIncome: income7 - 200000, taxRate: 22.5, fixedTax: (income7 - 200000) * 22.5 / 100 }    
  ];
  showPopup( name1, 'success');
} else if (netIncome <= 600000) {
  taxBrackets = [
    { minIncome: 1, maxIncome: 15000, taxRate: 0, fixedTax: 0 },
    { minIncome: 2, maxIncome: 15000, taxRate: 2.5, fixedTax: 15000 * 2.5 / 100 },
    { minIncome: 3, maxIncome: 15000, taxRate: 10, fixedTax: 15000 * 10 / 100 },
    { minIncome: 4, maxIncome: 15000, taxRate: 15, fixedTax: 15000 * 15 / 100 },
    { minIncome: 5, maxIncome: 140000, taxRate: 20, fixedTax: 140000 * 20 / 100 },
    { minIncome: 6, maxIncome: 200000, taxRate: 22.5, fixedTax: 200000 * 22.5 / 100 },     
    { minIncome: 7, maxIncome: income7 - 400000, taxRate: 25, fixedTax: (income7 - 400000) * 25 / 100 }    
  ];
  showPopup( name1, 'success');
} else if (netIncome <= 700000) {
  taxBrackets = [
    { minIncome: 1, maxIncome: 0, taxRate: 0, fixedTax: 0 },
    { minIncome: 2, maxIncome: 30000, taxRate: 2.5, fixedTax: 30000 * 2.5 / 100 },
    { minIncome: 3, maxIncome: 15000, taxRate: 10, fixedTax: 15000 * 10 / 100 },
    { minIncome: 4, maxIncome: 15000, taxRate: 15, fixedTax: 15000 * 15 / 100 },
    { minIncome: 5, maxIncome: 140000, taxRate: 20, fixedTax: 140000 * 20 / 100 },
    { minIncome: 6, maxIncome: 200000, taxRate: 22.5, fixedTax: 200000 * 22.5 / 100 },     
    { minIncome: 7, maxIncome: income7 - 400000, taxRate: 25, fixedTax: (income7 - 400000) * 25 / 100 }    
  ];
   let caption = "صافي الدخل الذي تعدي 600 ألف جنية ولم يتجاوز 700 ألف جنية لا يتمتع بالشريحة المعفاة";
    showPopup( name1 + caption, 'warning')
  
} else if (netIncome <= 800000) {
  taxBrackets = [
    { minIncome: 1, maxIncome: 0, taxRate: 0, fixedTax: 0 },
    { minIncome: 2, maxIncome: 0, taxRate: 2.5, fixedTax: 0 },
    { minIncome: 3, maxIncome: 45000, taxRate: 10, fixedTax: 45000 * 10 / 100 },
    { minIncome: 4, maxIncome: 15000, taxRate: 15, fixedTax: 15000 * 15 / 100 },
    { minIncome: 5, maxIncome: 140000, taxRate: 20, fixedTax: 140000 * 20 / 100 },
    { minIncome: 6, maxIncome: 200000, taxRate: 22.5, fixedTax: 200000 * 22.5 / 100 },     
    { minIncome: 7, maxIncome: income7 - 400000, taxRate: 25, fixedTax: (income7 - 400000) * 25 / 100 }    
  ];
   let caption = "صافي الدخل الذي تعدي 700 ألف جنية ولم يتجاوز 800 ألف جنية لا يتمتع بالشريحة المعفاة + الشريحة الثانية";
    showPopup( name1 + caption, 'warning')  
  
} else if (netIncome <= 900000) {
  taxBrackets = [
    { minIncome: 1, maxIncome: 0, taxRate: 0, fixedTax: 0 },
    { minIncome: 2, maxIncome: 0, taxRate: 2.5, fixedTax: 0 },
    { minIncome: 3, maxIncome: 0, taxRate: 10, fixedTax: 0 },
    { minIncome: 4, maxIncome: 60000, taxRate: 15, fixedTax: 60000 * 15 / 100 },
    { minIncome: 5, maxIncome: 140000, taxRate: 20, fixedTax: 140000 * 20 / 100 },
    { minIncome: 6, maxIncome: 200000, taxRate: 22.5, fixedTax: 200000 * 22.5 / 100 },     
    { minIncome: 7, maxIncome: income7 - 400000, taxRate: 25, fixedTax: (income7 - 400000) * 25 / 100 }    
  ]; 
   let caption = "صافي الدخل الذي تعدي 800 ألف جنية ولم يتجاوز 900 ألف جنية لا يتمتع بالشريحة المعفاة + الشريحة الثانية + الشريحة الثالثة";
    showPopup( name1 + caption, 'warning')    

} else if (netIncome <= 1000000) {
  taxBrackets = [
    { minIncome: 1, maxIncome: 0, taxRate: 0, fixedTax: 0 },
    { minIncome: 2, maxIncome: 0, taxRate: 2.5, fixedTax: 0 },
    { minIncome: 3, maxIncome: 0, taxRate: 10, fixedTax: 0 },
    { minIncome: 4, maxIncome: 0, taxRate: 15, fixedTax: 0 },
    { minIncome: 5, maxIncome: 200000, taxRate: 20, fixedTax: 200000 * 20 / 100 },
    { minIncome: 6, maxIncome: 200000, taxRate: 22.5, fixedTax: 200000 * 22.5 / 100 },     
    { minIncome: 7, maxIncome: income7 - 400000, taxRate: 25, fixedTax: (income7 - 400000) * 25 / 100 }    
  ]; 
   let caption = "صافي الدخل الذي تعدي 900 ألف جنية ولم يتجاوز مليون جنية لا يتمتع بالشريحة المعفاة + الشريحة الثانية + الشريحة الثالثة + الشريحة الرابعة";
    showPopup( name1 + caption, 'warning')   
  
} else {
  taxBrackets = [
    { minIncome: 1, maxIncome: 0, taxRate: 0, fixedTax: 0 },
    { minIncome: 2, maxIncome: 0, taxRate: 2.5, fixedTax: 0 },
    { minIncome: 3, maxIncome: 0, taxRate: 10, fixedTax: 0 },
    { minIncome: 4, maxIncome: 0, taxRate: 15, fixedTax: 0 },
    { minIncome: 5, maxIncome: 0, taxRate: 20, fixedTax: 0 },
    { minIncome: 6, maxIncome: 400000, taxRate: 22.5, fixedTax: 400000 * 22.5 / 100 },     
    { minIncome: 7, maxIncome: income7 - 400000, taxRate: 25, fixedTax: (income7 - 400000) * 25 / 100 }    
  ]; 
   let caption = "صافي الدخل الذي تجاوز مليون جنية لا يتمتع بالشريحة المعفاة + الشريحة الثانية + الشريحة الثالثة + الشريحة الرابعة + الشريحة الخامسة";
    showPopup( name1 + caption, 'warning')   
}
console.log(taxBrackets);
// Function to populate tax table
function populateTaxTable() {
  
// إظهار الجداول   
      document.getElementById("taxTable2").style.display = "table";
      document.getElementById("taxTable3").style.display = "table";

 
  
  const table = document.getElementById("taxTable");

  // Clear the table data (excluding header row)
  while (table.rows.length > 1) {
    table.deleteRow(1);
  }

  // Populate the table with new data
  taxBrackets.forEach(bracket => {
    const row = table.insertRow(-1);
    const minIncomeCell = row.insertCell(0);
    const maxIncomeCell = row.insertCell(1);
    const taxRateCell = row.insertCell(2);
    const taxDueCell = row.insertCell(3);
    const remainingIncomeCell = row.insertCell(4); // Added cell for remaining income

    minIncomeCell.textContent = bracket.minIncome.toLocaleString(); // Display minimum income
    maxIncomeCell.textContent = bracket.maxIncome === Infinity ? "Infinity" : bracket.maxIncome.toLocaleString(); // Display maximum income
    taxRateCell.textContent = bracket.taxRate + "%"; // Display tax rate
    taxDueCell.textContent = bracket.fixedTax.toLocaleString(); // Display fixed tax amount
    const remainingIncome = bracket.maxIncome === Infinity ? 0 : bracket.maxIncome - bracket.fixedTax; // Calculate remaining income
    remainingIncomeCell.textContent = remainingIncome.toLocaleString(); // Display remaining income
  });
}

// Call the function to populate the tax table
populateTaxTable(); 
  
  
//جدول الفترة الثانية  
let income11 = income10 - (15000 * 4 / 12).toFixed(0); //الاعفاء الشخصي السنوي (الفترة الثانية)
let income12 = (income11 / 4 * 12).toFixed(0); //رد الوعاء الي سنة كاملة 

messageDiv3.textContent = "الإعفاء الشخصي السنوي للممول  : 15000 جنية الفترة الثانية |" + " " + " سنة : " + " " + selectedYear + " " + "يخص الفترة من 01/07 حتي 31/10" + " " + "مبلغ :" + " " + (15000 * 4 / 12).toFixed(0) + " " + "جنية";

messageDiv4.textContent = "وعاء الفترة بعد خصم الإعفاء السنوي :" + " " + income11 + " " + " يرد الوعاء إلي سنة : " + income12 + " " + "جنية الصافي قبل خصم الشريحة المعفاة";
    let tax2 =0;
    if (income12 <= 21000) {
    tax2 = income12 * 0;
    } else if (income12 <= 30000) {
    tax2 = ((income12 * 2.5 / 100) - 525 ) * 4 / 12;
    } else if (income12 <= 45000) {
    tax2 = ((income12 * 10 / 100) - 2775 ) * 4 / 12;
    } else if (income12 <= 60000) {
    tax2 = ((income12 * 15 / 100) - 5025 ) * 4 / 12;
    } else if (income12 <= 200000) {
    tax2 = ((income12 * 20 / 100) - 8025 ) * 4 / 12;
    } else if (income12 <= 400000) {
    tax2 = ((income12 * 22.5 / 100) - 13026 ) * 4 / 12;
    } else if (income12 <= 600000) {
    tax2 = ((income12 * 25 / 100) - 23025 ) * 4 / 12;
    } else if (income12 <= 700000) {
    tax2 = ((income12 * 25 / 100) - 22500 ) * 4 / 12;
    } else if (income12 <= 800000) {
    tax2 = ((income12 * 25 / 100) - 20250 ) * 4 / 12;
    } else if (income12 <= 900000) {
    tax2 = ((income12 * 25 / 100) - 18000 ) * 4 / 12;
    } else if (income12 <= 1200000) {
    tax2 = ((income12 * 25 / 100) - 15000 ) * 4 / 12;
    } else if (income12 > 1200000) {
    tax2 = ((income12 * 27.5 / 100) - 30000 ) * 4 / 12;
    } else {
    tax2 = 0;
    }
 

messageDiv5.textContent = "ضريبة الفترة الثانية : من 01/07 حتي 31/10/2023" + " " + "" + " هي : " + (tax2).toFixed(0) + " " + "جنية";


// Define tax brackets
let netIncome2 = income12; // هذا مبلغ الدخل الصافي الذي ترغب في حساب الضريبة عليه
let name2 = " 📢 " + "سنة : " + selectedYear + " " + "الفترة الثانية : من 01/07 حتي 31/10/2023" + " | " + "وفقا للمادة الثامنة المعدلة بالقانون رقم ( 30 ) لسنة 2023" + " 👌 ";  

let taxBrackets2;

if (netIncome2 <= 21000) {
  taxBrackets2 = [
    { minIncome: 1, maxIncome: income12, taxRate: 0, fixedTax: 0 }
  ];
setTimeout(function() {   
showPopup( name2, 'success');
      }, 1500); 
} else if (netIncome2 <= 30000) {
  taxBrackets2 = [
    { minIncome: 1, maxIncome: 21000, taxRate: 0, fixedTax: 0 },
    { minIncome: 2, maxIncome: income12 - 21000, taxRate: 2.5, fixedTax: (income12 - 21000) * 2.5 / 100 }
  ];
setTimeout(function() {   
showPopup( name2, 'success');
      }, 1500);  
} else if (netIncome2 <= 45000) {
  taxBrackets2 = [
    { minIncome: 1, maxIncome: 21000, taxRate: 0, fixedTax: 0 },
    { minIncome: 2, maxIncome: 9000, taxRate: 2.5, fixedTax: 9000 * 2.5 / 100 },
    { minIncome: 3, maxIncome: income12 - 30000, taxRate: 10, fixedTax: (income12 - 30000) * 10 / 100 }
  ];
setTimeout(function() {   
showPopup( name2, 'success');
      }, 1500);  
} else if (netIncome2 <= 60000) {
  taxBrackets2 = [
    { minIncome: 1, maxIncome: 21000, taxRate: 0, fixedTax: 0 },
    { minIncome: 2, maxIncome: 9000, taxRate: 2.5, fixedTax: 9000 * 2.5 / 100 },
    { minIncome: 3, maxIncome: 15000, taxRate: 10, fixedTax: 15000 * 10 / 100 },
    { minIncome: 4, maxIncome: income12 - 45000, taxRate: 15, fixedTax: (income12 - 45000) * 15 / 100 }    
  ];
setTimeout(function() {   
showPopup( name2, 'success');
      }, 1500);  
} else if (netIncome2 <= 200000) {
  taxBrackets2 = [
    { minIncome: 1, maxIncome: 21000, taxRate: 0, fixedTax: 0 },
    { minIncome: 2, maxIncome: 9000, taxRate: 2.5, fixedTax: 9000 * 2.5 / 100 },
    { minIncome: 3, maxIncome: 15000, taxRate: 10, fixedTax: 15000 * 10 / 100 },
    { minIncome: 4, maxIncome: 15000, taxRate: 15, fixedTax: 15000 * 15 / 100 },    
    { minIncome: 5, maxIncome: income12 - 60000, taxRate: 20, fixedTax: (income12 - 60000) * 20 / 100 }    
  ];
setTimeout(function() {   
showPopup( name2, 'success');
      }, 1500);  
} else if (netIncome2 <= 400000) {
  taxBrackets2 = [
    { minIncome: 1, maxIncome: 21000, taxRate: 0, fixedTax: 0 },
    { minIncome: 2, maxIncome: 9000, taxRate: 2.5, fixedTax: 9000 * 2.5 / 100 },
    { minIncome: 3, maxIncome: 15000, taxRate: 10, fixedTax: 15000 * 10 / 100 },
    { minIncome: 4, maxIncome: 15000, taxRate: 15, fixedTax: 15000 * 15 / 100 },
    { minIncome: 5, maxIncome: 140000, taxRate: 20, fixedTax: 140000 * 20 / 100 }, 
    { minIncome: 6, maxIncome: income12 - 200000, taxRate: 22.5, fixedTax: (income12 - 200000) * 22.5 / 100 }    
  ];
setTimeout(function() {   
showPopup( name2, 'success');
      }, 1500);  
} else if (netIncome2 <= 600000) {
  taxBrackets2 = [
    { minIncome: 1, maxIncome: 21000, taxRate: 0, fixedTax: 0 },
    { minIncome: 2, maxIncome: 9000, taxRate: 2.5, fixedTax: 9000 * 2.5 / 100 },
    { minIncome: 3, maxIncome: 15000, taxRate: 10, fixedTax: 15000 * 10 / 100 },
    { minIncome: 4, maxIncome: 15000, taxRate: 15, fixedTax: 15000 * 15 / 100 },
    { minIncome: 5, maxIncome: 140000, taxRate: 20, fixedTax: 140000 * 20 / 100 },
    { minIncome: 6, maxIncome: 200000, taxRate: 22.5, fixedTax: 200000 * 22.5 / 100 },     
    { minIncome: 7, maxIncome: income12 - 400000, taxRate: 25, fixedTax: (income12 - 400000) * 25 / 100 }    
  ];
setTimeout(function() {   
showPopup( name2, 'success');
      }, 1500);  
} else if (netIncome2 <= 700000) {
  taxBrackets2 = [
    { minIncome: 1, maxIncome: 0, taxRate: 0, fixedTax: 0 },
    { minIncome: 2, maxIncome: 30000, taxRate: 2.5, fixedTax: 30000 * 2.5 / 100 },
    { minIncome: 3, maxIncome: 15000, taxRate: 10, fixedTax: 15000 * 10 / 100 },
    { minIncome: 4, maxIncome: 15000, taxRate: 15, fixedTax: 15000 * 15 / 100 },
    { minIncome: 5, maxIncome: 140000, taxRate: 20, fixedTax: 140000 * 20 / 100 },
    { minIncome: 6, maxIncome: 200000, taxRate: 22.5, fixedTax: 200000 * 22.5 / 100 },     
    { minIncome: 7, maxIncome: income12 - 400000, taxRate: 25, fixedTax: (income12 - 400000) * 25 / 100 }    
  ];
  setTimeout(function() {
   let caption = "صافي الدخل الذي تعدي 600 ألف جنية ولم يتجاوز 700 ألف جنية لا يتمتع بالشريحة المعفاة";
    showPopup( name2 + caption, 'warning')
      }, 1500);  
} else if (netIncome2 <= 800000) {
  taxBrackets2 = [
    { minIncome: 1, maxIncome: 0, taxRate: 0, fixedTax: 0 },
    { minIncome: 2, maxIncome: 0, taxRate: 2.5, fixedTax: 0 },
    { minIncome: 3, maxIncome: 45000, taxRate: 10, fixedTax: 45000 * 10 / 100 },
    { minIncome: 4, maxIncome: 15000, taxRate: 15, fixedTax: 15000 * 15 / 100 },
    { minIncome: 5, maxIncome: 140000, taxRate: 20, fixedTax: 140000 * 20 / 100 },
    { minIncome: 6, maxIncome: 200000, taxRate: 22.5, fixedTax: 200000 * 22.5 / 100 },     
    { minIncome: 7, maxIncome: income12 - 400000, taxRate: 25, fixedTax: (income12 - 400000) * 25 / 100 }    
  ];
    setTimeout(function() {
   let caption = "صافي الدخل الذي تعدي 700 ألف جنية ولم يتجاوز 800 ألف جنية لا يتمتع بالشريحة المعفاة + الشريحة الثانية";
    showPopup( name2 + caption, 'warning')
      }, 1500);  
} else if (netIncome2 <= 900000) {
  taxBrackets2 = [
    { minIncome: 1, maxIncome: 0, taxRate: 0, fixedTax: 0 },
    { minIncome: 2, maxIncome: 0, taxRate: 2.5, fixedTax: 0 },
    { minIncome: 3, maxIncome: 0, taxRate: 10, fixedTax: 0 },
    { minIncome: 4, maxIncome: 60000, taxRate: 15, fixedTax: 60000 * 15 / 100 },
    { minIncome: 5, maxIncome: 140000, taxRate: 20, fixedTax: 140000 * 20 / 100 },
    { minIncome: 6, maxIncome: 200000, taxRate: 22.5, fixedTax: 200000 * 22.5 / 100 },     
    { minIncome: 7, maxIncome: income12 - 400000, taxRate: 25, fixedTax: (income12 - 400000) * 25 / 100 }    
  ]; 
    setTimeout(function() {  
   let caption = "صافي الدخل الذي تعدي 800 ألف جنية ولم يتجاوز 900 ألف جنية لا يتمتع بالشريحة المعفاة + الشريحة الثانية + الشريحة الثالثة";
    showPopup( name2 + caption, 'warning')
      }, 1500);
} else if (netIncome2 <= 1200000) {
  taxBrackets2 = [
    { minIncome: 1, maxIncome: 0, taxRate: 0, fixedTax: 0 },
    { minIncome: 2, maxIncome: 0, taxRate: 2.5, fixedTax: 0 },
    { minIncome: 3, maxIncome: 0, taxRate: 10, fixedTax: 0 },
    { minIncome: 4, maxIncome: 0, taxRate: 15, fixedTax: 0 },
    { minIncome: 5, maxIncome: 200000, taxRate: 20, fixedTax: 200000 * 20 / 100 },
    { minIncome: 6, maxIncome: 200000, taxRate: 22.5, fixedTax: 200000 * 22.5 / 100 },     
    { minIncome: 7, maxIncome: income12 - 400000, taxRate: 25, fixedTax: (income12 - 400000) * 25 / 100 }    
  ]; 
    setTimeout(function() {  
   let caption = "صافي الدخل الذي تعدي 900 ألف جنية ولم يتجاوز مليون جنية لا يتمتع بالشريحة المعفاة + الشريحة الثانية + الشريحة الثالثة + الشريحة الرابعة";
    showPopup( name2 + caption, 'warning')
      }, 1500);  
} else {
  taxBrackets2 = [
    { minIncome: 1, maxIncome: 0, taxRate: 0, fixedTax: 0 },
    { minIncome: 2, maxIncome: 0, taxRate: 2.5, fixedTax: 0 },
    { minIncome: 3, maxIncome: 0, taxRate: 10, fixedTax: 0 },
    { minIncome: 4, maxIncome: 0, taxRate: 15, fixedTax: 0 },
    { minIncome: 5, maxIncome: 0, taxRate: 20, fixedTax: 0 },
    { minIncome: 6, maxIncome: 0, taxRate: 20, fixedTax: 0 },    
    { minIncome: 7, maxIncome: 1200000, taxRate: 25, fixedTax: 1200000 * 25 / 100 },     
    { minIncome: 8, maxIncome: income12 - 1200000, taxRate: 27.5, fixedTax: (income12 - 1200000) * 27.5 / 100 }    
  ]; 
   setTimeout(function() {   
   let caption = "صافي الدخل الذي تجاوز مليون جنية لا يتمتع بالشريحة المعفاة + الشريحة الثانية + الشريحة الثالثة + الشريحة الرابعة + الشريحة الخامسة + الشريحة السادسة";
    showPopup( name2 + caption, 'warning')
           }, 1500);
}

console.log(taxBrackets2);
// Function to populate tax table 2
function populateTaxTable2() {
  const table2 = document.getElementById("taxTable2");

  // Clear the table data (excluding header row)
  while (table2.rows.length > 1) {
    table2.deleteRow(1);
  }

  // Populate the table with new data
  taxBrackets2.forEach(bracket2 => {
    const row = table2.insertRow(-1);
    const minIncomeCell = row.insertCell(0);
    const maxIncomeCell = row.insertCell(1);
    const taxRateCell = row.insertCell(2);
    const taxDueCell = row.insertCell(3);
    const remainingIncomeCell = row.insertCell(4); // Added cell for remaining income

    minIncomeCell.textContent = bracket2.minIncome.toLocaleString(); // Display minimum income
    maxIncomeCell.textContent = bracket2.maxIncome === Infinity ? "Infinity" : bracket2.maxIncome.toLocaleString(); // Display maximum income
    taxRateCell.textContent = bracket2.taxRate + "%"; // Display tax rate
    taxDueCell.textContent = bracket2.fixedTax.toLocaleString(); // Display fixed tax amount
    const remainingIncome = bracket2.maxIncome === Infinity ? 0 : bracket2.maxIncome - bracket2.fixedTax; // Calculate remaining income
    remainingIncomeCell.textContent = remainingIncome.toLocaleString(); // Display remaining income
  });
}

// Call the function to populate the tax table 2
populateTaxTable2(); 
  


//جدول الفترة الثالثة  
let income16 = income15 - (15000 * 2 / 12).toFixed(0); //الاعفاء الشخصي السنوي (الفترة الثالثة)
let income17 = (income16 / 2 * 12 ).toFixed(0); //رد الوعاء الي سنة كاملة 

  messageDiv6.textContent = "الإعفاء الشخصي السنوي للممول  : 15000 جنية الفترة الثالثة |" + " " + " سنة : " + " " + selectedYear + " " + "يخص الفترة من 01/11 حتي 31/12" + " " + "مبلغ :" + " " + (15000 * 2 / 12).toFixed(0) + " " + "جنية";

messageDiv7.textContent = "وعاء الفترة بعد خصم الإعفاء السنوي :" + " " + income16 + " " + " يرد الوعاء إلي سنة : " + income17 + " " + "جنية الصافي قبل خصم الشريحة المعفاة";

    let tax3 =0;  
    if (income17 <= 30000) {
    tax3 = income17 * 0;
    } else if (income17 <= 45000) {
    tax3 = ((income17 * 10 / 100) - 3000 ) * 2 / 12;
    } else if (income17 <= 60000) {
    tax3 = ((income17 * 15 / 100) - 5250 ) * 2 / 12;
    } else if (income17 <= 200000) {
    tax3 = ((income17 * 20 / 100) - 8250 ) * 2 / 12;
    } else if (income17 <= 400000) {
    tax3 = ((income17 * 22.5 / 100) - 13250 ) * 2 / 12;
    } else if (income17 <= 600000) {
    tax3 = ((income17 * 25 / 100) - 23250 ) * 2 / 12;
    } else if (income17 <= 700000) {
    tax3 = ((income17 * 25 / 100) - 20250 ) * 2 / 12;
    } else if (income17 <= 800000) {
    tax3 = ((income17 * 25 / 100) - 18000 ) * 2 / 12;
    } else if (income17 <= 900000) {
    tax3 = ((income17 * 25 / 100) - 15000 ) * 2 / 12;
    } else if (income17 <= 1200000) {
    tax3 = ((income17 * 25 / 100) - 10000 ) * 2 / 12;
    } else if (income17 > 1200000) {
    tax3 = ((income17 * 27.5 / 100) - 30000 ) * 2 / 12;
    } else {
    tax3 = 0;
    }

messageDiv8.textContent = "ضريبة الفترة الثالثة : من 01/11 حتي 31/12/2023" + " " + "" + " هي : " + (tax3).toFixed(0) + " " + "جنية";

  
// إجمالي ضريبة الفترات الثلاثة  
tax = (tax1 + tax2 + tax3).toFixed(0);

   // تحديث قيمة tax0 بعد حساب الضريبة وتحويل النتيجة إلى عدد صحيح
   tax0 = ( tax / 12 ).toFixed(0);

  // عرض القيمة الجديدة في textbox6
  textbox6.value = tax0    
  
// Define tax brackets
let netIncome3 = income17; // هذا مبلغ الدخل الصافي الذي ترغب في حساب الضريبة عليه
let name3 = " 📢 " + "سنة : " + selectedYear + " " + "الفترة الثالثة : من 01/11 حتي 31/12/2023" + " | " + "وفقا للمادة الثامنة المعدلة بالقانون رقم ( 175 ) لسنة 2023" + " 👌 ";  

let taxBrackets3;

if (netIncome3 <= 30000) {
  taxBrackets3 = [
    { minIncome: 1, maxIncome: income17, taxRate: 0, fixedTax: 0 }
  ];
setTimeout(function() {   
showPopup( name3, 'success');
      }, 3000);   
} else if (netIncome3 <= 45000) {
  taxBrackets3 = [
    { minIncome: 1, maxIncome: 30000, taxRate: 0, fixedTax: 0 },
    { minIncome: 2, maxIncome: income17 - 30000, taxRate: 10, fixedTax: (income17 - 30000) * 10 / 100 }
  ];
setTimeout(function() {   
showPopup( name3, 'success');
      }, 3000);  
} else if (netIncome3 <= 60000) {
  taxBrackets3 = [
    { minIncome: 1, maxIncome: 30000, taxRate: 0, fixedTax: 0 },
    { minIncome: 2, maxIncome: 15000, taxRate: 10, fixedTax: 15000 * 10 / 100 },
    { minIncome: 3, maxIncome: income17 - 45000, taxRate: 15, fixedTax: (income17 - 45000) * 15 / 100 }
  ];
setTimeout(function() {   
showPopup( name3, 'success');
      }, 3000);  
} else if (netIncome3 <= 200000) {
  taxBrackets3 = [
    { minIncome: 1, maxIncome: 30000, taxRate: 0, fixedTax: 0 },
    { minIncome: 2, maxIncome: 15000, taxRate: 10, fixedTax: 15000 * 10 / 100 },
    { minIncome: 3, maxIncome: 15000, taxRate: 15, fixedTax: 15000 * 15 / 100 },
    { minIncome: 4, maxIncome: income17 - 60000, taxRate: 20, fixedTax: (income17 - 60000) * 20 / 100 }    
  ];
setTimeout(function() {   
showPopup( name3, 'success');
      }, 3000);  
} else if (netIncome3 <= 400000) {
  taxBrackets3 = [
    { minIncome: 1, maxIncome: 30000, taxRate: 0, fixedTax: 0 },
    { minIncome: 2, maxIncome: 15000, taxRate: 10, fixedTax: 15000 * 10 / 100 },
    { minIncome: 3, maxIncome: 15000, taxRate: 15, fixedTax: 15000 * 15 / 100 },
    { minIncome: 4, maxIncome: 140000, taxRate: 20, fixedTax: 140000 * 20 / 100 },    
    { minIncome: 5, maxIncome: income17 - 200000, taxRate: 22.5, fixedTax: (income17 - 200000) * 22.5 / 100 }    
  ];
setTimeout(function() {   
showPopup( name3, 'success');
      }, 3000);  
} else if (netIncome3 <= 600000) {
  taxBrackets3 = [
    { minIncome: 1, maxIncome: 30000, taxRate: 0, fixedTax: 0 },
    { minIncome: 2, maxIncome: 15000, taxRate: 10, fixedTax: 15000 * 10 / 100 },
    { minIncome: 3, maxIncome: 15000, taxRate: 15, fixedTax: 15000 * 15 / 100 },
    { minIncome: 4, maxIncome: 140000, taxRate: 20, fixedTax: 140000 * 20 / 100 },
    { minIncome: 5, maxIncome: 200000, taxRate: 22.5, fixedTax: 200000 * 22.5 / 100 }, 
    { minIncome: 6, maxIncome: income17 - 400000, taxRate: 25, fixedTax: (income17 - 400000) * 25 / 100 }    
  ];
setTimeout(function() {   
showPopup( name3, 'success');
      }, 3000);  
} else if (netIncome3 <= 700000) {
  taxBrackets3 = [
    { minIncome: 1, maxIncome: 0, taxRate: 0, fixedTax: 0 },
    { minIncome: 2, maxIncome: 45000, taxRate: 10, fixedTax: 45000 * 10 / 100 },
    { minIncome: 3, maxIncome: 15000, taxRate: 15, fixedTax: 15000 * 15 / 100 },
    { minIncome: 4, maxIncome: 140000, taxRate: 20, fixedTax: 140000 * 20 / 100 },
    { minIncome: 5, maxIncome: 200000, taxRate: 22.5, fixedTax: 200000 * 22.5 / 100 },     
    { minIncome: 6, maxIncome: income17 - 400000, taxRate: 25, fixedTax: (income17 - 400000) * 25 / 100 }    
  ];
  setTimeout(function() {
   let caption = "صافي الدخل الذي تعدي 600 ألف جنية ولم يتجاوز 700 ألف جنية لا يتمتع بالشريحة المعفاة";
    showPopup( name3 + caption, 'warning')
      }, 3000);  
} else if (netIncome3 <= 800000) {
  taxBrackets3 = [
    { minIncome: 1, maxIncome: 0, taxRate: 0, fixedTax: 0 },
    { minIncome: 2, maxIncome: 0, taxRate: 10, fixedTax: 0 },
    { minIncome: 3, maxIncome: 60000, taxRate: 15, fixedTax: 60000 * 15 / 100 },
    { minIncome: 4, maxIncome: 140000, taxRate: 20, fixedTax: 140000 * 20 / 100 },
    { minIncome: 5, maxIncome: 200000, taxRate: 22.5, fixedTax: 200000 * 22.5 / 100 },     
    { minIncome: 6, maxIncome: income17 - 400000, taxRate: 25, fixedTax: (income17 - 400000) * 25 / 100 }    
  ];
  setTimeout(function() {
   let caption = "صافي الدخل الذي تعدي 700 ألف جنية ولم يتجاوز 800 ألف جنية لا يتمتع بالشريحة المعفاة + الشريحة الثانية";
    showPopup( name3 + caption, 'warning')
      }, 3000);  
} else if (netIncome3 <= 900000) {
  taxBrackets3 = [
    { minIncome: 1, maxIncome: 0, taxRate: 0, fixedTax: 0 },
    { minIncome: 2, maxIncome: 0, taxRate: 10, fixedTax: 0 },
    { minIncome: 3, maxIncome: 0, taxRate: 15, fixedTax: 0 },
    { minIncome: 4, maxIncome: 200000, taxRate: 20, fixedTax: 200000 * 20 / 100 },
    { minIncome: 5, maxIncome: 200000, taxRate: 22.5, fixedTax: 200000 * 22.5 / 100 },     
    { minIncome: 6, maxIncome: income17 - 400000, taxRate: 25, fixedTax: (income17 - 400000) * 25 / 100 }      
  ];
  setTimeout(function() {
   let caption = "صافي الدخل الذي تعدي 800 ألف جنية ولم يتجاوز 900 ألف جنية لا يتمتع بالشريحة المعفاة + الشريحة الثانية + الشريحة الثالثة";
    showPopup( name3 + caption, 'warning')
      }, 3000);
} else if (netIncome3 <= 1200000) {
  taxBrackets3 = [
    { minIncome: 1, maxIncome: 0, taxRate: 0, fixedTax: 0 },
    { minIncome: 2, maxIncome: 0, taxRate: 10, fixedTax: 0 },
    { minIncome: 3, maxIncome: 0, taxRate: 15, fixedTax: 0 },
    { minIncome: 4, maxIncome: 0, taxRate: 20, fixedTax: 0 },
    { minIncome: 5, maxIncome: 400000, taxRate: 22.5, fixedTax: 400000 * 22.5 / 100 },     
    { minIncome: 6, maxIncome: income17 - 400000, taxRate: 25, fixedTax: (income17 - 400000) * 25 / 100 }    
  ];
  setTimeout(function() {
   let caption = "صافي الدخل الذي تعدي 900 ألف جنية ولم يتجاوز مليون جنية لا يتمتع بالشريحة المعفاة + الشريحة الثانية + الشريحة الثالثة + الشريحة الرابعة";
    showPopup( name3 + caption, 'warning')
      }, 3000);  
} else {
  taxBrackets3 = [
    { minIncome: 1, maxIncome: 0, taxRate: 0, fixedTax: 0 },
    { minIncome: 2, maxIncome: 0, taxRate: 2.5, fixedTax: 0 },
    { minIncome: 3, maxIncome: 0, taxRate: 10, fixedTax: 0 },
    { minIncome: 4, maxIncome: 0, taxRate: 15, fixedTax: 0 },
    { minIncome: 5, maxIncome: 0, taxRate: 20, fixedTax: 0 },
    { minIncome: 6, maxIncome: 0, taxRate: 20, fixedTax: 0 },    
    { minIncome: 7, maxIncome: 1200000, taxRate: 25, fixedTax: 1200000 * 25 / 100 },     
    { minIncome: 8, maxIncome: income17 - 1200000, taxRate: 27.5, fixedTax: (income17 - 1200000) * 27.5 / 100 }    
  ];
  setTimeout(function() {
   let caption = "صافي الدخل الذي تجاوز مليون جنية لا يتمتع بالشريحة المعفاة + الشريحة الثانية + الشريحة الثالثة + الشريحة الرابعة + الشريحة الخامسة + الشريحة السادسة";
    showPopup( name3 + caption, 'warning')
      }, 3000);  
}
  
   setTimeout(function() {  
   let caption = "تم حساب الضريبة بنجاح ! " + " " + "السنة الضريبية : " + ( textbox10.value ) + " " + " الضريبة المستحقة : " + ( tax ) + " جنية " + "" + " الضريبة الشهرية : " + ( tax0 ) + " جنية ";
    showPopup( caption, 'info'); 
    }, 3750);
          
console.log(taxBrackets3);
// Function to populate tax table 3
function populateTaxTable3() {
  const table3 = document.getElementById("taxTable3");

  // Clear the table data (excluding header row)
  while (table3.rows.length > 1) {
    table3.deleteRow(1);
  }

  // Populate the table with new data
  taxBrackets3.forEach(bracket3 => {
    const row = table3.insertRow(-1);
    const minIncomeCell = row.insertCell(0);
    const maxIncomeCell = row.insertCell(1);
    const taxRateCell = row.insertCell(2);
    const taxDueCell = row.insertCell(3);
    const remainingIncomeCell = row.insertCell(4); // Added cell for remaining income

    minIncomeCell.textContent = bracket3.minIncome.toLocaleString(); // Display minimum income
    maxIncomeCell.textContent = bracket3.maxIncome === Infinity ? "Infinity" : bracket3.maxIncome.toLocaleString(); // Display maximum income
    taxRateCell.textContent = bracket3.taxRate + "%"; // Display tax rate
    taxDueCell.textContent = bracket3.fixedTax.toLocaleString(); // Display fixed tax amount
    const remainingIncome = bracket3.maxIncome === Infinity ? 0 : bracket3.maxIncome - bracket3.fixedTax; // Calculate remaining income
    remainingIncomeCell.textContent = remainingIncome.toLocaleString(); // Display remaining income
  });
}

// Call the function to populate the tax table 3
populateTaxTable3();    
  
              
} else  if ( textbox1.value >=0 && textbox10.value <=2024 ) {

    messageDiv.style.display = "block";   
    messageDiv1.style.display = "block"; 
    messageDiv2.style.display = "block"; 
    messageDiv3.style.display = "block";  
    messageDiv4.style.display = "block"; 
    messageDiv5.style.display = "block"; 
    messageDiv6.style.display = "none";
    messageDiv7.style.display = "none"; 
    messageDiv8.style.display = "none";   
  
//جدول الفترة الأولي 
let income6 = income5 - (15000 * 2 / 12).toFixed(0); //الاعفاء الشخصي السنوي (الفترة الأولي )
let income7 = (income6 / 2 * 12 ).toFixed(0); //رد الوعاء الي سنة كاملة 

  messageDiv.textContent = "الإعفاء الشخصي السنوي للممول  : 15000 جنية الفترة الأولي |" + " " + " سنة : " + " " + selectedYear + " " + "يخص الفترة من 01/01 حتي 29/02" + " " + "مبلغ :" + " " + (15000 * 2 / 12).toFixed(0) + " " + "جنية";

messageDiv1.textContent = "وعاء الفترة بعد خصم الإعفاء السنوي :" + " " + income6 + " " + " يرد الوعاء إلي سنة : " + income7 + " " + "جنية الصافي قبل خصم الشريحة المعفاة";

    let tax1 =0;  
    if (income7 <= 30000) {
    tax1 = income7 * 0;
    } else if (income7 <= 45000) {
    tax1 = ((income7 * 10 / 100) - 3000 ) * 2 / 12;
    } else if (income7 <= 60000) {
    tax1 = ((income7 * 15 / 100) - 5250 ) * 2 / 12;
    } else if (income7 <= 200000) {
    tax1 = ((income7 * 20 / 100) - 8250 ) * 2 / 12;
    } else if (income7 <= 400000) {
    tax1 = ((income7 * 22.5 / 100) - 13250 ) * 2 / 12;
    } else if (income7 <= 600000) {
    tax1 = ((income7 * 25 / 100) - 23250 ) * 2 / 12;
    } else if (income7 <= 700000) {
    tax1 = ((income7 * 25 / 100) - 20250 ) * 2 / 12;
    } else if (income7 <= 800000) {
    tax1 = ((income7 * 25 / 100) - 18000 ) * 2 / 12;
    } else if (income7 <= 900000) {
    tax1 = ((income7 * 25 / 100) - 15000 ) * 2 / 12;
    } else if (income7 <= 1200000) {
    tax1 = ((income7 * 25 / 100) - 10000 ) * 2 / 12;
    } else if (income7 > 1200000) {
    tax1 = ((income7 * 27.5 / 100) - 30000 ) * 2 / 12;
    } else {
    tax1 = 0;
    }

messageDiv2.textContent = "ضريبة الفترة الأولي : من 01/01 حتي 29/02/2024" + " " + "" + " هي : " + (tax1).toFixed(0) + " " + "جنية";

 
// Define tax brackets
let netIncome = income7; // هذا مبلغ الدخل الصافي الذي ترغب في حساب الضريبة عليه
let name1 = " 📢 " + "سنة : " + selectedYear + " " + "الفترة الأولي : من 01/01 حتي 29/02/2024" + " | " + "وفقا للمادة الثامنة المعدلة بالقانون رقم ( 175 ) لسنة 2023" + " 👌 ";  
 
let taxBrackets;

if (netIncome <= 30000) {
  taxBrackets = [
    { minIncome: 1, maxIncome: income7, taxRate: 0, fixedTax: 0 }
  ];
  showPopup(name1, 'success');
} else if (netIncome <= 45000) {
  taxBrackets = [
    { minIncome: 1, maxIncome: 30000, taxRate: 0, fixedTax: 0 },
    { minIncome: 2, maxIncome: income7 - 30000, taxRate: 10, fixedTax: (income7 - 30000) * 10 / 100 }
  ];
showPopup(name1, 'success');
} else if (netIncome <= 60000) {
  taxBrackets = [
    { minIncome: 1, maxIncome: 30000, taxRate: 0, fixedTax: 0 },
    { minIncome: 2, maxIncome: 15000, taxRate: 10, fixedTax: 15000 * 10 / 100 },
    { minIncome: 3, maxIncome: income7 - 45000, taxRate: 15, fixedTax: (income7 - 45000) * 15 / 100 }
  ];
showPopup(name1, 'success');  
} else if (netIncome <= 200000) {
  taxBrackets = [
    { minIncome: 1, maxIncome: 30000, taxRate: 0, fixedTax: 0 },
    { minIncome: 2, maxIncome: 15000, taxRate: 10, fixedTax: 15000 * 10 / 100 },
    { minIncome: 3, maxIncome: 15000, taxRate: 15, fixedTax: 15000 * 15 / 100 },
    { minIncome: 4, maxIncome: income7 - 60000, taxRate: 20, fixedTax: (income7 - 60000) * 20 / 100 }    
  ];
showPopup(name1, 'success');  
} else if (netIncome <= 400000) {
  taxBrackets = [
    { minIncome: 1, maxIncome: 30000, taxRate: 0, fixedTax: 0 },
    { minIncome: 2, maxIncome: 15000, taxRate: 10, fixedTax: 15000 * 10 / 100 },
    { minIncome: 3, maxIncome: 15000, taxRate: 15, fixedTax: 15000 * 15 / 100 },
    { minIncome: 4, maxIncome: 140000, taxRate: 20, fixedTax: 140000 * 20 / 100 },    
    { minIncome: 5, maxIncome: income7 - 200000, taxRate: 22.5, fixedTax: (income7 - 200000) * 22.5 / 100 }    
  ];
showPopup(name1, 'success');  
} else if (netIncome <= 600000) {
  taxBrackets = [
    { minIncome: 1, maxIncome: 30000, taxRate: 0, fixedTax: 0 },
    { minIncome: 2, maxIncome: 15000, taxRate: 10, fixedTax: 15000 * 10 / 100 },
    { minIncome: 3, maxIncome: 15000, taxRate: 15, fixedTax: 15000 * 15 / 100 },
    { minIncome: 4, maxIncome: 140000, taxRate: 20, fixedTax: 140000 * 20 / 100 },
    { minIncome: 5, maxIncome: 200000, taxRate: 22.5, fixedTax: 200000 * 22.5 / 100 }, 
    { minIncome: 6, maxIncome: income7 - 400000, taxRate: 25, fixedTax: (income7 - 400000) * 25 / 100 }    
  ];
showPopup(name1, 'success');  
} else if (netIncome <= 700000) {
  taxBrackets = [
    { minIncome: 1, maxIncome: 0, taxRate: 0, fixedTax: 0 },
    { minIncome: 2, maxIncome: 45000, taxRate: 10, fixedTax: 45000 * 10 / 100 },
    { minIncome: 3, maxIncome: 15000, taxRate: 15, fixedTax: 15000 * 15 / 100 },
    { minIncome: 4, maxIncome: 140000, taxRate: 20, fixedTax: 140000 * 20 / 100 },
    { minIncome: 5, maxIncome: 200000, taxRate: 22.5, fixedTax: 200000 * 22.5 / 100 },     
    { minIncome: 6, maxIncome: income7 - 400000, taxRate: 25, fixedTax: (income7 - 400000) * 25 / 100 }    
  ];
   let caption = "صافي الدخل الذي تعدي 600 ألف جنية ولم يتجاوز 700 ألف جنية لا يتمتع بالشريحة المعفاة";
    showPopup( name1 + caption, 'warning');
  
} else if (netIncome <= 800000) {
  taxBrackets = [
    { minIncome: 1, maxIncome: 0, taxRate: 0, fixedTax: 0 },
    { minIncome: 2, maxIncome: 0, taxRate: 10, fixedTax: 0 },
    { minIncome: 3, maxIncome: 60000, taxRate: 15, fixedTax: 60000 * 15 / 100 },
    { minIncome: 4, maxIncome: 140000, taxRate: 20, fixedTax: 140000 * 20 / 100 },
    { minIncome: 5, maxIncome: 200000, taxRate: 22.5, fixedTax: 200000 * 22.5 / 100 },     
    { minIncome: 6, maxIncome: income7 - 400000, taxRate: 25, fixedTax: (income7 - 400000) * 25 / 100 }    
  ];
   let caption = "صافي الدخل الذي تعدي 700 ألف جنية ولم يتجاوز 800 ألف جنية لا يتمتع بالشريحة المعفاة + الشريحة الثانية";
    showPopup( name1 + caption, 'warning');
  
} else if (netIncome <= 900000) {
  taxBrackets = [
    { minIncome: 1, maxIncome: 0, taxRate: 0, fixedTax: 0 },
    { minIncome: 2, maxIncome: 0, taxRate: 10, fixedTax: 0 },
    { minIncome: 3, maxIncome: 0, taxRate: 15, fixedTax: 0 },
    { minIncome: 4, maxIncome: 200000, taxRate: 20, fixedTax: 200000 * 20 / 100 },
    { minIncome: 5, maxIncome: 200000, taxRate: 22.5, fixedTax: 200000 * 22.5 / 100 },     
    { minIncome: 6, maxIncome: income7 - 400000, taxRate: 25, fixedTax: (income7 - 400000) * 25 / 100 }      
  ]; 
   let caption = "صافي الدخل الذي تعدي 800 ألف جنية ولم يتجاوز 900 ألف جنية لا يتمتع بالشريحة المعفاة + الشريحة الثانية + الشريحة الثالثة";
    showPopup( name1 + caption, 'warning');

} else if (netIncome <= 1200000) {
  taxBrackets = [
    { minIncome: 1, maxIncome: 0, taxRate: 0, fixedTax: 0 },
    { minIncome: 2, maxIncome: 0, taxRate: 10, fixedTax: 0 },
    { minIncome: 3, maxIncome: 0, taxRate: 15, fixedTax: 0 },
    { minIncome: 4, maxIncome: 0, taxRate: 20, fixedTax: 0 },
    { minIncome: 5, maxIncome: 400000, taxRate: 22.5, fixedTax: 400000 * 22.5 / 100 },     
    { minIncome: 6, maxIncome: income7 - 400000, taxRate: 25, fixedTax: (income7 - 400000) * 25 / 100 }    
  ]; 
   let caption = "صافي الدخل الذي تعدي 900 ألف جنية ولم يتجاوز مليون جنية لا يتمتع بالشريحة المعفاة + الشريحة الثانية + الشريحة الثالثة + الشريحة الرابعة";
    showPopup( name1 + caption, 'warning');
  
} else {
  taxBrackets = [
    { minIncome: 1, maxIncome: 0, taxRate: 0, fixedTax: 0 },
    { minIncome: 2, maxIncome: 0, taxRate: 2.5, fixedTax: 0 },
    { minIncome: 3, maxIncome: 0, taxRate: 10, fixedTax: 0 },
    { minIncome: 4, maxIncome: 0, taxRate: 15, fixedTax: 0 },
    { minIncome: 5, maxIncome: 0, taxRate: 20, fixedTax: 0 },
    { minIncome: 6, maxIncome: 0, taxRate: 20, fixedTax: 0 },    
    { minIncome: 7, maxIncome: 1200000, taxRate: 25, fixedTax: 1200000 * 25 / 100 },     
    { minIncome: 8, maxIncome: income7 - 1200000, taxRate: 27.5, fixedTax: (income7 - 1200000) * 27.5 / 100 }    
  ]; 
   let caption = "صافي الدخل الذي تجاوز مليون جنية لا يتمتع بالشريحة المعفاة + الشريحة الثانية + الشريحة الثالثة + الشريحة الرابعة + الشريحة الخامسة + الشريحة السادسة";
    showPopup( name1 + caption, 'warning');
}
  
 
console.log(taxBrackets);
// Function to populate tax table
function populateTaxTable() {
  
// إظهار الجداول   
      document.getElementById("taxTable2").style.display = "table";
  
  
    const table = document.getElementById("taxTable");

    const table1 = document.getElementById("taxTable1");  
  
    // Clear the table data (excluding header row)
    while (table.rows.length > 1) {
        table.deleteRow(1);
    }
    while (table1.rows.length > 1) {
        table1.deleteRow(1);
    }

    // Populate the table with new data
    taxBrackets.forEach(bracket => {
        const row = table.insertRow(-1);
        const minIncomeCell = row.insertCell(0);
        const maxIncomeCell = row.insertCell(1);
        const taxRateCell = row.insertCell(2);
        const taxDueCell = row.insertCell(3);
        const remainingIncomeCell = row.insertCell(4); // Added cell for remaining income
        
        minIncomeCell.textContent = bracket.minIncome.toLocaleString(); // Display minimum income
        maxIncomeCell.textContent = bracket.maxIncome === Infinity ? "Infinity" : bracket.maxIncome.toLocaleString(); // Display maximum income
        taxRateCell.textContent = bracket.taxRate + "%"; // Display tax rate
        taxDueCell.textContent = bracket.fixedTax.toLocaleString(); // Display fixed tax amount
        const remainingIncome = bracket.maxIncome === Infinity ? 0 : bracket.maxIncome - bracket.fixedTax; // Calculate remaining income
        remainingIncomeCell.textContent = remainingIncome.toLocaleString(); // Display remaining income
    });
}


// Call the function to populate the tax table
populateTaxTable();           
  
  
  
//جدول الفترة الثانية  
let income11 = income10 - (20000 * 10 / 12).toFixed(0); //الاعفاء الشخصي السنوي (الفترة الثانية)
let income12 = (income11 / 10 * 12).toFixed(0); //رد الوعاء الي سنة كاملة 

messageDiv3.textContent = "الإعفاء الشخصي السنوي للممول  : 20000 جنية الفترة الثانية |" + " " + " سنة : " + " " + selectedYear + " " + "يخص الفترة من 01/03 حتي 31/12" + " " + "مبلغ :" + " " + (20000 * 10 / 12).toFixed(0) + " " + "جنية";

messageDiv4.textContent = "وعاء الفترة بعد خصم الإعفاء السنوي :" + " " + income11 + " " + " يرد الوعاء إلي سنة : " + income12 + " " + "جنية الصافي قبل خصم الشريحة المعفاة";
    let tax2 =0;
    if (income12 <= 40000) {
    tax2 = income12 * 0;
    } else if (income12 <= 55000) {
    tax2 = ((income12 * 10 / 100) - 4000 ) * 10 / 12;
    } else if (income12 <= 70000) {
    tax2 = ((income12 * 15 / 100) - 6750 ) * 10 / 12;
    } else if (income12 <= 200000) {
    tax2 = ((income12 * 20 / 100) - 10250 ) * 10 / 12;
    } else if (income12 <= 400000) { 
    tax2 = ((income12 * 22.5 / 100) - 15250 ) * 10 / 12;
    } else if (income12 <= 600000) {
    tax2 = ((income12 * 25 / 100) - 25250 ) * 10 / 12;
    } else if (income12 <= 700000) {
    tax2 = ((income12 * 25 / 100) - 21250 ) * 10 / 12;
    } else if (income12 <= 800000) {
    tax2 = ((income12 * 25 / 100) - 18500 ) * 10 / 12;
    } else if (income12 <= 900000) {
    tax2 = ((income12 * 25 / 100) - 15000 ) * 10 / 12;
    } else if (income12 <= 1200000) {
    tax2 = ((income12 * 25 / 100) - 10000 ) * 10 / 12;
    } else if (income12 > 1200000) {
    tax2 = ((income12 * 27.5 / 100) - 30000 ) * 10 / 12;
    } else {
    tax2 = 0;
    } 
 

messageDiv5.textContent = "ضريبة الفترة الثانية : من 01/03 حتي 31/12/2024" + " " + "" + " هي : " + (tax2).toFixed(0) + " " + "جنية";

// إجمالي ضريبة الفترات  
tax = (tax1 + tax2).toFixed(0);  

  
   // تحديث قيمة tax0 بعد حساب الضريبة وتحويل النتيجة إلى عدد صحيح
   tax0 = ( tax / 12 ).toFixed(0);

  // عرض القيمة الجديدة في textbox6
  textbox6.value = tax0  
  
  
// Define tax brackets
let netIncome2 = income12; // هذا مبلغ الدخل الصافي الذي ترغب في حساب الضريبة عليه
let name2 = " 📢 " + "سنة : " + selectedYear + " " + "الفترة الثانية : من 01/03 حتي 31/12/2024" + " | " + "وفقا للمادة الثامنة المعدلة بالقانون رقم ( 7 ) لسنة 2024" + " 👌 ";  

let taxBrackets2;

if (netIncome2 <= 40000) {
  taxBrackets2 = [
    { minIncome: 1, maxIncome: income12, taxRate: 0, fixedTax: 0 }
  ];
   setTimeout(function() {  
    showPopup(name2, 'success'); 
    }, 1500);  
} else if (netIncome2 <= 55000) {
  taxBrackets2 = [
    { minIncome: 1, maxIncome: 40000, taxRate: 0, fixedTax: 0 },
    { minIncome: 2, maxIncome: income12 - 40000, taxRate: 10, fixedTax: (income12 - 40000) * 10 / 100 }
  ]; 
   setTimeout(function() {  
    showPopup(name2, 'success'); 
    }, 1500);  
} else if (netIncome2 <= 70000) {
  taxBrackets2 = [
    { minIncome: 1, maxIncome: 40000, taxRate: 0, fixedTax: 0 },
    { minIncome: 2, maxIncome: 15000, taxRate: 10, fixedTax: 15000 * 10 / 100 },
    { minIncome: 3, maxIncome: income12 - 55000, taxRate: 15, fixedTax: (income12 - 55000) * 15 / 100 }
  ];
   setTimeout(function() {  
    showPopup(name2, 'success'); 
    }, 1500);  
} else if (netIncome2 <= 200000) {
  taxBrackets2 = [
    { minIncome: 1, maxIncome: 40000, taxRate: 0, fixedTax: 0 },
    { minIncome: 2, maxIncome: 15000, taxRate: 10, fixedTax: 15000 * 10 / 100 },
    { minIncome: 3, maxIncome: 15000, taxRate: 15, fixedTax: 15000 * 15 / 100 },
    { minIncome: 4, maxIncome: income12 - 70000, taxRate: 20, fixedTax: (income12 - 70000) * 20 / 100 }    
  ];
   setTimeout(function() {  
    showPopup(name2, 'success'); 
    }, 1500);  
} else if (netIncome2 <= 400000) {
  taxBrackets2 = [
    { minIncome: 1, maxIncome: 40000, taxRate: 0, fixedTax: 0 },
    { minIncome: 2, maxIncome: 15000, taxRate: 10, fixedTax: 15000 * 10 / 100 },
    { minIncome: 3, maxIncome: 15000, taxRate: 15, fixedTax: 15000 * 15 / 100 },
    { minIncome: 4, maxIncome: 130000, taxRate: 20, fixedTax: 130000 * 20 / 100 },    
    { minIncome: 5, maxIncome: income12 - 200000, taxRate: 22.5, fixedTax: (income12 - 200000) * 22.5 / 100 }    
  ];
   setTimeout(function() {  
    showPopup(name2, 'success'); 
    }, 1500);  
} else if (netIncome2 <= 600000) {
  taxBrackets2 = [
    { minIncome: 1, maxIncome: 40000, taxRate: 0, fixedTax: 0 },
    { minIncome: 2, maxIncome: 15000, taxRate: 10, fixedTax: 15000 * 10 / 100 },
    { minIncome: 3, maxIncome: 15000, taxRate: 15, fixedTax: 15000 * 15 / 100 },
    { minIncome: 4, maxIncome: 130000, taxRate: 20, fixedTax: 130000 * 20 / 100 },
    { minIncome: 5, maxIncome: 200000, taxRate: 22.5, fixedTax: 200000 * 22.5 / 100 }, 
    { minIncome: 6, maxIncome: income12 - 400000, taxRate: 25, fixedTax: (income12 - 400000) * 25 / 100 }    
  ];
   setTimeout(function() {  
    showPopup(name2, 'success'); 
    }, 1500);  
} else if (netIncome2 <= 700000) {
  taxBrackets2 = [
    { minIncome: 1, maxIncome: 0, taxRate: 0, fixedTax: 0 },
    { minIncome: 2, maxIncome: 55000, taxRate: 10, fixedTax: 55000 * 10 / 100 },
    { minIncome: 3, maxIncome: 15000, taxRate: 15, fixedTax: 15000 * 15 / 100 },
    { minIncome: 4, maxIncome: 130000, taxRate: 20, fixedTax: 130000 * 20 / 100 },
    { minIncome: 5, maxIncome: 200000, taxRate: 22.5, fixedTax: 200000 * 22.5 / 100 },     
    { minIncome: 6, maxIncome: income12 - 400000, taxRate: 25, fixedTax: (income12 - 400000) * 25 / 100 }    
  ];
  setTimeout(function() {
   let caption = "صافي الدخل الذي تعدي 600 ألف جنية ولم يتجاوز 700 ألف جنية لا يتمتع بالشريحة المعفاة";
    showPopup( name2 + caption, 'warning');
    }, 1500);
  
} else if (netIncome2 <= 800000) {
  taxBrackets2 = [
    { minIncome: 1, maxIncome: 0, taxRate: 0, fixedTax: 0 },
    { minIncome: 2, maxIncome: 0, taxRate: 10, fixedTax: 0 },
    { minIncome: 3, maxIncome: 70000, taxRate: 15, fixedTax: 70000 * 15 / 100 },
    { minIncome: 4, maxIncome: 130000, taxRate: 20, fixedTax: 130000 * 20 / 100 },
    { minIncome: 5, maxIncome: 200000, taxRate: 22.5, fixedTax: 200000 * 22.5 / 100 },     
    { minIncome: 6, maxIncome: income12 - 400000, taxRate: 25, fixedTax: (income12 - 400000) * 25 / 100 }    
  ];
    setTimeout(function() {
   let caption = "صافي الدخل الذي تعدي 700 ألف جنية ولم يتجاوز 800 ألف جنية لا يتمتع بالشريحة المعفاة + الشريحة الثانية";
    showPopup( name2 + caption, 'warning');
      }, 1500);
  
} else if (netIncome2 <= 900000) {
  taxBrackets2 = [
    { minIncome: 1, maxIncome: 0, taxRate: 0, fixedTax: 0 },
    { minIncome: 2, maxIncome: 0, taxRate: 10, fixedTax: 0 },
    { minIncome: 3, maxIncome: 0, taxRate: 15, fixedTax: 0 },
    { minIncome: 4, maxIncome: 200000, taxRate: 20, fixedTax: 200000 * 20 / 100 },
    { minIncome: 5, maxIncome: 200000, taxRate: 22.5, fixedTax: 200000 * 22.5 / 100 },     
    { minIncome: 6, maxIncome: income12 - 400000, taxRate: 25, fixedTax: (income12 - 400000) * 25 / 100 }      
  ]; 
    setTimeout(function() {  
   let caption = "صافي الدخل الذي تعدي 800 ألف جنية ولم يتجاوز 900 ألف جنية لا يتمتع بالشريحة المعفاة + الشريحة الثانية + الشريحة الثالثة";
    showPopup( name2 + caption, 'warning');
      }, 1500);

} else if (netIncome2 <= 1200000) {
  taxBrackets2 = [
    { minIncome: 1, maxIncome: 0, taxRate: 0, fixedTax: 0 },
    { minIncome: 2, maxIncome: 0, taxRate: 10, fixedTax: 0 },
    { minIncome: 3, maxIncome: 0, taxRate: 15, fixedTax: 0 },
    { minIncome: 4, maxIncome: 0, taxRate: 20, fixedTax: 0 },
    { minIncome: 5, maxIncome: 400000, taxRate: 22.5, fixedTax: 400000 * 22.5 / 100 },     
    { minIncome: 6, maxIncome: income12 - 400000, taxRate: 25, fixedTax: (income12 - 400000) * 25 / 100 }    
  ]; 
    setTimeout(function() {  
   let caption = "صافي الدخل الذي تعدي 900 ألف جنية ولم يتجاوز مليون جنية لا يتمتع بالشريحة المعفاة + الشريحة الثانية + الشريحة الثالثة + الشريحة الرابعة";
    showPopup( name2 + caption, 'warning');
      }, 1500);
  
} else {
  taxBrackets2 = [
    { minIncome: 1, maxIncome: 0, taxRate: 0, fixedTax: 0 },
    { minIncome: 2, maxIncome: 0, taxRate: 2.5, fixedTax: 0 },
    { minIncome: 3, maxIncome: 0, taxRate: 10, fixedTax: 0 },
    { minIncome: 4, maxIncome: 0, taxRate: 15, fixedTax: 0 },
    { minIncome: 5, maxIncome: 0, taxRate: 20, fixedTax: 0 },
    { minIncome: 6, maxIncome: 0, taxRate: 20, fixedTax: 0 },    
    { minIncome: 7, maxIncome: 1200000, taxRate: 25, fixedTax: 1200000 * 25 / 100 },     
    { minIncome: 8, maxIncome: income12 - 1200000, taxRate: 27.5, fixedTax: (income12 - 1200000) * 27.5 / 100 }    
  ]; 
    setTimeout(function() {  
   let caption = "صافي الدخل الذي تجاوز مليون جنية لا يتمتع بالشريحة المعفاة + الشريحة الثانية + الشريحة الثالثة + الشريحة الرابعة + الشريحة الخامسة + الشريحة السادسة";
    showPopup( name2 + caption, 'warning');
      }, 1500);
}

   setTimeout(function() {  
   let caption = "تم حساب الضريبة بنجاح ! " + " " + "السنة الضريبية : " + ( textbox10.value ) + " " + " الضريبة المستحقة : " + ( tax ) + " جنية " + "" + " الضريبة الشهرية : " + ( tax0 ) + " جنية ";
    showPopup(caption, 'info'); 
    }, 2250);
  
console.log(taxBrackets2);
// Function to populate tax table 2
function populateTaxTable2() {
  const table2 = document.getElementById("taxTable2");

  // Clear the table data (excluding header row)
  while (table2.rows.length > 1) {
    table2.deleteRow(1);
  }

  // Populate the table with new data
  taxBrackets2.forEach(bracket2 => {
    const row = table2.insertRow(-1);
    const minIncomeCell = row.insertCell(0);
    const maxIncomeCell = row.insertCell(1);
    const taxRateCell = row.insertCell(2);
    const taxDueCell = row.insertCell(3);
    const remainingIncomeCell = row.insertCell(4); // Added cell for remaining income

    minIncomeCell.textContent = bracket2.minIncome.toLocaleString(); // Display minimum income
    maxIncomeCell.textContent = bracket2.maxIncome === Infinity ? "Infinity" : bracket2.maxIncome.toLocaleString(); // Display maximum income
    taxRateCell.textContent = bracket2.taxRate + "%"; // Display tax rate
    taxDueCell.textContent = bracket2.fixedTax.toLocaleString(); // Display fixed tax amount
    const remainingIncome = bracket2.maxIncome === Infinity ? 0 : bracket2.maxIncome - bracket2.fixedTax; // Calculate remaining income
    remainingIncomeCell.textContent = remainingIncome.toLocaleString(); // Display remaining income
  });
}

// Call the function to populate the tax table 2
populateTaxTable2(); 
  

} else  if ( textbox1.value >=0 && textbox10.value === "2025" ) {

    messageDiv.style.display = "block";  
    messageDiv1.style.display = "none"; 
    messageDiv2.style.display = "block"; 
    messageDiv3.style.display = "none"; 
    messageDiv4.style.display = "none"; 
    messageDiv5.style.display = "none"; 
    messageDiv6.style.display = "none";
    messageDiv7.style.display = "none"; 
    messageDiv8.style.display = "none";   

    let income0 = income - 20000; //الإعفاء الشخصي السنوي للممول
    messageDiv.textContent = "الإعفاء الشخصي السنوي للممول  : 20000 جنية" + " " +" سنة : "+" "+ selectedYear + " " + "الصافي قبل خصم الشريحة المعفاة :" + " " + income0 + " " + "جنية";
  
    if (income0 <= 40000) {
    tax = income0 * 0;
    } else if (income0 <= 55000) {
    tax = ((income0 * 10 / 100) - 4000 );
    } else if (income0 <= 70000) {
    tax = ((income0 * 15 / 100) - 6750 );
    } else if (income0 <= 200000) {
    tax = ((income0 * 20 / 100) - 10250 );
    } else if (income0 <= 400000) { 
    tax = ((income0 * 22.5 / 100) - 15250 );
    } else if (income0 <= 600000) {
    tax = ((income0 * 25 / 100) - 25250 );
    } else if (income0 <= 700000) {
    tax = ((income0 * 25 / 100) - 21250 );
    } else if (income0 <= 800000) {
    tax = ((income0 * 25 / 100) - 18500 );
    } else if (income0 <= 900000) {
    tax = ((income0 * 25 / 100) - 15000 );
    } else if (income0 <= 1200000) {
    tax = ((income0 * 25 / 100) - 10000 );
    } else if (income0 > 1200000) {
    tax = ((income0 * 27.5 / 100) - 30000 );
    } else {
    tax = 0;
    } 
 
    tax = Number(tax.toFixed(0));
  
    messageDiv2.textContent = "الضريبة السنوية : من 01/01 حتي 31/12" + " " + ""+" هي : " + tax.toFixed(0) + " " + "جنية";        

  
   // تحديث قيمة tax0 بعد حساب الضريبة وتحويل النتيجة إلى عدد صحيح
   tax0 = ( tax / 12 ).toFixed(0);

  // عرض القيمة الجديدة في textbox6
  textbox6.value = ( tax / 12 ).toFixed(0);
  
  
// Define tax brackets
let netIncome = income0; // هذا مبلغ الدخل الصافي الذي ترغب في حساب الضريبة عليه
let name1 = " 📢 " + "سنة : " + selectedYear + " | " + "وفقا للمادة الثامنة المعدلة بالقانون رقم ( 7 ) لسنة 2024" + " 👌 ";  
  
  
let taxBrackets;
  
if (netIncome <= 40000) {
  taxBrackets = [
    { minIncome: 1, maxIncome: income0, taxRate: 0, fixedTax: 0 }
  ];
  
  showPopup( name1, 'success');
  
} else if (netIncome <= 55000) {
  taxBrackets = [
    { minIncome: 1, maxIncome: 40000, taxRate: 0, fixedTax: 0 },
    { minIncome: 2, maxIncome: income0 - 40000, taxRate: 10, fixedTax: (income0 - 40000) * 10 / 100 }
  ];
  
  showPopup( name1, 'success');
  
} else if (netIncome <= 70000) {
  taxBrackets = [
    { minIncome: 1, maxIncome: 40000, taxRate: 0, fixedTax: 0 },
    { minIncome: 2, maxIncome: 15000, taxRate: 10, fixedTax: 15000 * 10 / 100 },
    { minIncome: 3, maxIncome: income0 - 55000, taxRate: 15, fixedTax: (income0 - 55000) * 15 / 100 }
  ];
  
  showPopup( name1, 'success');
  
} else if (netIncome <= 200000) {
  taxBrackets = [
    { minIncome: 1, maxIncome: 40000, taxRate: 0, fixedTax: 0 },
    { minIncome: 2, maxIncome: 15000, taxRate: 10, fixedTax: 15000 * 10 / 100 },
    { minIncome: 3, maxIncome: 15000, taxRate: 15, fixedTax: 15000 * 15 / 100 },
    { minIncome: 4, maxIncome: income0 - 70000, taxRate: 20, fixedTax: (income0 - 70000) * 20 / 100 }    
  ];
  
  showPopup( name1, 'success');
  
} else if (netIncome <= 400000) {
  taxBrackets = [
    { minIncome: 1, maxIncome: 40000, taxRate: 0, fixedTax: 0 },
    { minIncome: 2, maxIncome: 15000, taxRate: 10, fixedTax: 15000 * 10 / 100 },
    { minIncome: 3, maxIncome: 15000, taxRate: 15, fixedTax: 15000 * 15 / 100 },
    { minIncome: 4, maxIncome: 130000, taxRate: 20, fixedTax: 130000 * 20 / 100 },    
    { minIncome: 5, maxIncome: income0 - 200000, taxRate: 22.5, fixedTax: (income0 - 200000) * 22.5 / 100 }    
  ];
  
  showPopup( name1, 'success');
  
} else if (netIncome <= 600000) {
  taxBrackets = [
    { minIncome: 1, maxIncome: 40000, taxRate: 0, fixedTax: 0 },
    { minIncome: 2, maxIncome: 15000, taxRate: 10, fixedTax: 15000 * 10 / 100 },
    { minIncome: 3, maxIncome: 15000, taxRate: 15, fixedTax: 15000 * 15 / 100 },
    { minIncome: 4, maxIncome: 130000, taxRate: 20, fixedTax: 130000 * 20 / 100 },
    { minIncome: 5, maxIncome: 200000, taxRate: 22.5, fixedTax: 200000 * 22.5 / 100 }, 
    { minIncome: 6, maxIncome: income0 - 400000, taxRate: 25, fixedTax: (income0 - 400000) * 25 / 100 }    
  ];
  
  showPopup( name1, 'success');
  
} else if (netIncome <= 700000) {
  taxBrackets = [
    { minIncome: 1, maxIncome: 0, taxRate: 0, fixedTax: 0 },
    { minIncome: 2, maxIncome: 55000, taxRate: 10, fixedTax: 55000 * 10 / 100 },
    { minIncome: 3, maxIncome: 15000, taxRate: 15, fixedTax: 15000 * 15 / 100 },
    { minIncome: 4, maxIncome: 130000, taxRate: 20, fixedTax: 130000 * 20 / 100 },
    { minIncome: 5, maxIncome: 200000, taxRate: 22.5, fixedTax: 200000 * 22.5 / 100 },     
    { minIncome: 6, maxIncome: income0 - 400000, taxRate: 25, fixedTax: (income0 - 400000) * 25 / 100 }    
  ];
   let caption = "صافي الدخل الذي تعدي 600 ألف جنية ولم يتجاوز 700 ألف جنية لا يتمتع بالشريحة المعفاة";
    showPopup( name1 + caption, 'warning');
  
} else if (netIncome <= 800000) {
  taxBrackets = [
    { minIncome: 1, maxIncome: 0, taxRate: 0, fixedTax: 0 },
    { minIncome: 2, maxIncome: 0, taxRate: 10, fixedTax: 0 },
    { minIncome: 3, maxIncome: 70000, taxRate: 15, fixedTax: 70000 * 15 / 100 },
    { minIncome: 4, maxIncome: 130000, taxRate: 20, fixedTax: 130000 * 20 / 100 },
    { minIncome: 5, maxIncome: 200000, taxRate: 22.5, fixedTax: 200000 * 22.5 / 100 },     
    { minIncome: 6, maxIncome: income0 - 400000, taxRate: 25, fixedTax: (income0 - 400000) * 25 / 100 }    
  ];
   let caption = "صافي الدخل الذي تعدي 700 ألف جنية ولم يتجاوز 800 ألف جنية لا يتمتع بالشريحة المعفاة + الشريحة الثانية";
    showPopup( name1 + caption, 'warning');
  
} else if (netIncome <= 900000) {
  taxBrackets = [
    { minIncome: 1, maxIncome: 0, taxRate: 0, fixedTax: 0 },
    { minIncome: 2, maxIncome: 0, taxRate: 10, fixedTax: 0 },
    { minIncome: 3, maxIncome: 0, taxRate: 15, fixedTax: 0 },
    { minIncome: 4, maxIncome: 200000, taxRate: 20, fixedTax: 200000 * 20 / 100 },
    { minIncome: 5, maxIncome: 200000, taxRate: 22.5, fixedTax: 200000 * 22.5 / 100 },     
    { minIncome: 6, maxIncome: income0 - 400000, taxRate: 25, fixedTax: (income0 - 400000) * 25 / 100 }      
  ]; 
   let caption = "صافي الدخل الذي تعدي 800 ألف جنية ولم يتجاوز 900 ألف جنية لا يتمتع بالشريحة المعفاة + الشريحة الثانية + الشريحة الثالثة";
    showPopup( name1 + caption, 'warning');

} else if (netIncome <= 1200000) {
  taxBrackets = [
    { minIncome: 1, maxIncome: 0, taxRate: 0, fixedTax: 0 },
    { minIncome: 2, maxIncome: 0, taxRate: 10, fixedTax: 0 },
    { minIncome: 3, maxIncome: 0, taxRate: 15, fixedTax: 0 },
    { minIncome: 4, maxIncome: 0, taxRate: 20, fixedTax: 0 },
    { minIncome: 5, maxIncome: 400000, taxRate: 22.5, fixedTax: 400000 * 22.5 / 100 },     
    { minIncome: 6, maxIncome: income0 - 400000, taxRate: 25, fixedTax: (income0 - 400000) * 25 / 100 }    
  ]; 
   let caption = "صافي الدخل الذي تعدي 900 ألف جنية ولم يتجاوز مليون جنية لا يتمتع بالشريحة المعفاة + الشريحة الثانية + الشريحة الثالثة + الشريحة الرابعة";
    showPopup( name1 + caption, 'warning');
  
} else {
  taxBrackets = [
    { minIncome: 1, maxIncome: 0, taxRate: 0, fixedTax: 0 },
    { minIncome: 2, maxIncome: 0, taxRate: 2.5, fixedTax: 0 },
    { minIncome: 3, maxIncome: 0, taxRate: 10, fixedTax: 0 },
    { minIncome: 4, maxIncome: 0, taxRate: 15, fixedTax: 0 },
    { minIncome: 5, maxIncome: 0, taxRate: 20, fixedTax: 0 },
    { minIncome: 6, maxIncome: 0, taxRate: 20, fixedTax: 0 },    
    { minIncome: 7, maxIncome: 1200000, taxRate: 25, fixedTax: 1200000 * 25 / 100 },     
    { minIncome: 8, maxIncome: income0 - 1200000, taxRate: 27.5, fixedTax: (income0 - 1200000) * 27.5 / 100 }    
  ]; 
   let caption = "صافي الدخل الذي تجاوز مليون جنية لا يتمتع بالشريحة المعفاة + الشريحة الثانية + الشريحة الثالثة + الشريحة الرابعة + الشريحة الخامسة + الشريحة السادسة";
    showPopup( name1 + caption, 'warning');
}

  
   setTimeout(function() {  
   let caption = "تم حساب الضريبة بنجاح ! " + " صافي الوعاء الخاضع للضريبة : " + ( textbox1.value ) + " جنية " + " " + "السنة الضريبية : " + ( textbox10.value ) + " " + " الضريبة المستحقة : " + ( tax ) + " جنية " + "" + " الضريبة الشهرية : " + ( tax0 ) + " جنية ";
    showPopup( caption, 'info'); 
    }, 1500);   
  
console.log(taxBrackets);
// Function to populate tax table
function populateTaxTable() {
    const table = document.getElementById("taxTable");

    const table1 = document.getElementById("taxTable1");  
  
    // Clear the table data (excluding header row)
    while (table.rows.length > 1) {
        table.deleteRow(1);
    }
    while (table1.rows.length > 1) {
        table1.deleteRow(1);
    }

    // Populate the table with new data
    taxBrackets.forEach(bracket => {
        const row = table.insertRow(-1);
        const minIncomeCell = row.insertCell(0);
        const maxIncomeCell = row.insertCell(1);
        const taxRateCell = row.insertCell(2);
        const taxDueCell = row.insertCell(3);
        const remainingIncomeCell = row.insertCell(4); // Added cell for remaining income
        
        minIncomeCell.textContent = bracket.minIncome.toLocaleString(); // Display minimum income
        maxIncomeCell.textContent = bracket.maxIncome === Infinity ? "Infinity" : bracket.maxIncome.toLocaleString(); // Display maximum income
        taxRateCell.textContent = bracket.taxRate + "%"; // Display tax rate
        taxDueCell.textContent = bracket.fixedTax.toLocaleString(); // Display fixed tax amount
        const remainingIncome = bracket.maxIncome === Infinity ? 0 : bracket.maxIncome - bracket.fixedTax; // Calculate remaining income
        remainingIncomeCell.textContent = remainingIncome.toLocaleString(); // Display remaining income
    });
} 
  



// Call the function to populate the tax table
populateTaxTable();  
  
  
    } else {
    alert("");
    textbox1.value = "";
    return;
    }

    textbox4.value = tax;

    textbox5.value = caption;
    }

      
    </script>

        


          
          
    <script>
            
  function resetButton() {
    
  // إخفاء جميع الجداول المعرفة بـ #taxTable1 إلى #taxTable4
  document.querySelectorAll("#taxTable2, #taxTable3, #taxTable4").forEach(table => {
    table.style.display = "none";
  });     
    
  const textbox1 = document.getElementById("textbox1");
  const textbox4 = document.getElementById("textbox4");
  const textbox6 = document.getElementById("textbox6");    
  const net1 = document.getElementById("net1");
  const net2 = document.getElementById("net2");
  const net3 = document.getElementById("net3");
      
  const textbox10 = document.getElementById("textbox10");
    
  var textbox105 = document.getElementById("textbox105");
  textbox105.style.display = "block";   
  textbox1.style.display = "block";
    
  textbox1.value = "";
  textbox4.value = "";
  textbox6.value = "";     
  net1.value = ""; 
  net2.value = "";      
  net3.value = ""; 
  net1.style.display = "none";   
  net2.style.display = "none"; 
  net3.style.display = "none"; 
    
    var messageDiv = document.getElementById("yearMessage");          
    var messageDiv1 = document.getElementById("yearMessage1");
    var messageDiv2 = document.getElementById("yearMessage2");
    var messageDiv3 = document.getElementById("yearMessage3");
    var messageDiv4 = document.getElementById("yearMessage4");
    var messageDiv5 = document.getElementById("yearMessage5");
    var messageDiv6 = document.getElementById("yearMessage6");
    var messageDiv7 = document.getElementById("yearMessage7");
    var messageDiv8 = document.getElementById("yearMessage8");    
    
    messageDiv.style.display = "none";   
    messageDiv1.style.display = "none"; 
    messageDiv2.style.display = "none"; 
    messageDiv3.style.display = "none";
    messageDiv4.style.display = "none"; 
    messageDiv5.style.display = "none"; 
    messageDiv6.style.display = "none";
    messageDiv7.style.display = "none"; 
    messageDiv8.style.display = "none";  
    
    
  var textbox102 = document.getElementById("textbox102");
  var textbox103 = document.getElementById("textbox103");
  var textbox104 = document.getElementById("textbox104");
    
  textbox102.style.display = "none";    
  textbox103.style.display = "none"; 
  textbox104.style.display = "none"; 
        
  textbox1.focus();
// Function to populate tax table
    const table = document.getElementById("taxTable");
    const table1 = document.getElementById("taxTable1");  
    const table2 = document.getElementById("taxTable2");
    const table3 = document.getElementById("taxTable3");      
    const table4 = document.getElementById("taxTable4");
    const table5 = document.getElementById("taxTable5"); 
      
    // Clear the table data (excluding header row)
    while (table.rows.length > 1) {
        table.deleteRow(1);
    }
    while (table1.rows.length > 1) {
        table1.deleteRow(1);
    } 
            
    while (table2.rows.length > 1) {
        table2.deleteRow(1);
    }
    while (table3.rows.length > 1) {
        table3.deleteRow(1);
    }
    while (table4.rows.length > 1) {
        table4.deleteRow(1);
    }            
}
      
     
        document.getElementById("button5").addEventListener("click", function() {     
                          
        });        
            
        </script> 

    <script>

// تبديل الوضع الليلي
function toggleNightMode() {
    const body = document.body;
    body.classList.toggle('dark-mode');
    const nightModeToggle = document.querySelector('.night-mode-toggle');
    const isNightMode = body.classList.contains('dark-mode');
    nightModeToggle.innerHTML = isNightMode ? '☀' : '🌙';
}
// تحميل تفضيل العرض المحفوظ والوضع الليلي
document.addEventListener('DOMContentLoaded', function() {
    const darkModePreference = localStorage.getItem('darkModePreference'); // إضافة تفضيل الوضع الليلي
    // تطبيق الوضع الليلي إذا كان مفعلاً
    if (darkModePreference === 'true') {
        toggleNightMode();
    }
});

// تبديل الوضع الليلي
function toggleNightMode() {
    const body = document.body;
    body.classList.toggle('dark-mode');
    const nightModeToggle = document.querySelector('.night-mode-toggle');
    const isNightMode = body.classList.contains('dark-mode');
    nightModeToggle.innerHTML = isNightMode ? '☀' : '🌙';
    // حفظ تفضيل الوضع الليلي
    localStorage.setItem('darkModePreference', isNightMode ? 'true' : 'false');
}     


       // إظهار النص العائم عند تحميل الصفحة
        window.onload = function() {
            showFloatingText(); // استدعاء الدالة لأول مرة عند تحميل الصفحة

            // تكرار إظهار النص العائم كل 30 ثانية
            setInterval(function() {
                showFloatingText();
            }, 30000);
        };

        // دالة لإظهار النص العائم
        function showFloatingText() {
            var floatingText = document.getElementById("floatingText");
            floatingText.style.display = "block";

            // إخفاء النص العائم بعد 5 ثواني
            setTimeout(function() {
                floatingText.style.display = "none";
            }, 5000);
        }

      
      // إعادة توجيه المستخدم عند الضغط على الأيقونة العائمة
        document.getElementById("youtubeIcon").onclick = function() {
            window.location.href = "https://play.google.com/store/apps/details?id=com.mrizk.taxlawapp";
        };
      
      
  </script>            
                  
       <script>  
 // لتغيير اتجاه الصفحة من اليسار إلى اليمين  (RTL)
document.dir = 'rtl';
       </script>  


<script>
function clickIE4() {
    if (2 == event.button) {
        return false;
    }
}

function clickNS4(e) {
    if ((document.layers || (document.getElementById && !document.all)) && (2 == e.which || 3 == e.which)) {
        return false;
    }
}

document.oncontextmenu = function () {
    return false;
};

document.onkeydown = function (e) {
    if (
        123 == e.keyCode ||
        (e.ctrlKey && 73 == e.keyCode) ||
        (e.ctrlKey && 67 == e.keyCode) ||
        (e.ctrlKey && 74 == e.keyCode) ||
        (e.ctrlKey && 80 == e.keyCode) ||
        (e.ctrlKey && 85 == e.keyCode) ||
        (e.ctrlKey && 83 == e.keyCode)
    ) {
        return false;
    }
};
</script>       